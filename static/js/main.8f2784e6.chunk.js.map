{"version":3,"sources":["images/classicVsValley.png","components/faq.js","images/Palette128_Unobtainable_Trans.png","components/header.js","locale/de/flag.svg","locale/ua/flag.svg","locale/en/flag.svg","locale/eo/flag.svg","locale/es/flag.svg","locale/et/flag.svg","locale/et/flag_pop.svg","locale/fr/flag.svg","locale/it/flag.svg","locale/lt/flag.svg","locale/pt/flag.svg","locale/ru/flag.svg","locale/zh-Hans/flag.svg","locale/zh-Hant/flag.svg","locale/locale.js","components/languages.js","cookieManager.js","components/tooltip.js","components/mapart/blockSelectionAddCustom/blockSelectionAddCustom.js","images/null.png","images/textures.png","components/mapart/blockImage.js","components/mapart/blockSelection.js","components/mapart/workers/nbt.jsworker","components/mapart/greenButtons.js","components/mapart/workers/mapCanvas.jsworker","components/mapart/mapPreview.js","images/gridOverlay.png","components/mapart/autoCompleteInputBlockToAdd/autoCompleteInputBlockToAdd.js","components/mapart/bufferedNumberInput/bufferedNumberInput.js","components/mapart/mapSettings.js","components/mapart/materials.js","components/mapart/nbtReader.js","components/mapart/viewOnlineCommon/waila.js","components/mapart/viewOnline2D/viewOnline2D.js","components/mapart/viewOnline3D/pointerLockControls.js","components/mapart/viewOnline3D/viewOnline3D.js","components/mapart/mapartController.js","images/upload.png","components/root.js","index.js"],"names":["FAQ","props","className","to","undefined","includes","match","params","countryCode","href","target","rel","style","textAlign","alt","src","IMG_ClassicVsValley","Header","state","contactInfoClassname","onContactInfoClick","event","getLocaleString","preventDefault","window","confirm","alert","setState","this","onClick","Component","Locale","en","strings","Strings_en","flag","Flag_en","ua","Strings_ua","Flag_ua","et","Strings_et","Flag_et","flag_special","Flag_et_pop","lt","Strings_lt","Flag_lt","ru","Strings_ru","Flag_ru","de","Strings_de","Flag_de","fr","Strings_fr","Flag_fr","it","Strings_it","Flag_it","pt","Strings_pt","Flag_pt","es","Strings_es","Flag_es","Strings_zh_Hans","Flag_zh_Hans","Flag_zh_Hant","eo","Strings_eo","Flag_eo","Languages","Object","keys","map","language","Fragment","CookieManager","forEach","name","getCookie","setCookie","cname","cvalue","d","Date","setTime","getTime","expires","toUTCString","document","cookie","ca","split","i","length","c","charAt","substring","indexOf","defaultValue","cookieValue","Tooltip","hovering","handleMouseOver","handleMouseOut","tooltipStyle","textStyleOverrides","display","onMouseOver","onMouseOut","children","tooltipText","BlockSelectionAddCustom","block_name","block_nbtTags","block_colourSetId","block_needsSupport","block_flammable","block_versions","E_KeyOrValue","key","value","examplesGroups","title","blocks","blockName","nbtTags","facing","half","versions","variant","type","onSettingChange_block_name","e","onSettingChange_block_nbtTags","tagIndex","keyOrValue","block_nbtTags_new","every","t","pop","push","onSettingChange_block_colourSetId","onSettingChange_block_needsSupport","currentState","onSettingChange_block_flammable","onSettingChange_block_versions","versionToToggle","block_versions_new","coloursJSON","SupportedVersions","supportedVersion_key","prevProps","lastSelectedCustomBlock","loadBlockIntoForm","colourSetId","blockId","blockToLoad","blockToLoad_nbtTags","versionToLoad_nbtData","values","validVersions","find","version","entries","NBTArgs","nbtTag_key","nbtTag_value","blockToLoad_versions","MCVersion","NBTName","supportBlockMandatory","flammable","onAddCustomBlock","onDeleteCustomBlock","examples","open","examplesGroup","block","outline","padding","marginBlockStart","marginBlockEnd","disabled","tagKey","tagValue","supportedVersion_value","checked","setting_customBlock_name","onChange","setting_customBlock_nbtTags","setting_customBlock_colourSetId","backgroundColor","tonesRGB","normal","join","color","colourSet","colourName","setting_customBlock_needsSupport","setting_customBlock_flammable","setting_customBlock_versions","block_version","block_version_checked","customBlock_submit","colSpan","width","customBlock_delete","BlockImage","props_others","isNone","isUnknown","IMG_Null","displayName","backgroundImage","IMG_Textures","backgroundPositionX","backgroundPositionY","presetIndex","BlockSelection","getColourSetBox","background","optionValue_staircasing","MapModes","SCHEMATIC_NBT","staircaseModes","OFF","uniqueId","MAPDAT","cssRGB","CLASSIC","VALLEY","ON","dark","light","ON_UNOBTAINABLE","unobtainable","FULL_DARK","FULL_LIGHT","FULL_UNOBTAINABLE","Error","RGBArray","onChangeColourSetBlock","optionValue_version","selectedBlocks","presets","selectedPresetName","onPresetChange","onDeletePreset","onSavePreset","onSharePreset","onGetPDNPaletteClicked","handleAddCustomBlock","handleDeleteCustomBlock","presetsManagement","id","preset","localeKey","blockSelection","filter","some","cursor","position","paddingLeft","zIndex","whiteSpace","margin","GreenButtons","buttonWidth_viewOnline","buttonWidth_NBT_Joined","buttonWidth_NBT_Split","buttonWidth_Mapdat_Split","mapPreviewWorker_onFinishCallback","nbtWorker","Worker","NBTWorker","getNBT_base","workerHeader","optionValue_mapSize_x","optionValue_mapSize_y","optionValue_whereSupportBlocks","optionValue_supportBlock","optionValue_mapdatFilenameUseId","optionValue_mapdatFilenameIdStart","uploadedImage_baseFilename","currentMaterialsData","mapPreviewWorker_inProgress","downloadBlobFile","onGetViewOnlineNBT","currentSelectedBlocks","elt","terminate","resetButtonWidths","numberOfSplitsCalculated","zipFile","JSZip","t0","performance","now","onmessage","data","head","body","t1","console","log","toString","NBT_Array","whichMap_x","whichMap_y","NBT_Array_gzipped","gzip","file","generateAsync","then","content","downloadBlob","Blob","Mapdat_Bytes","Mapdat_Bytes_gzipped","postMessage","WhereSupportBlocksModes","pixelsData","maps","onViewOnlineClicked","onGetNBTClicked","onGetNBTSplitClicked","onGetMapdatSplitClicked","onGetMapdatSplitZipClicked","optionValue_modeNBTOrMapdat","optionValue_cropImage","optionValue_cropImage_zoom","optionValue_cropImage_percent_x","optionValue_cropImage_percent_y","optionValue_transparency","optionValue_transparencyTolerance","optionValue_betterColour","optionValue_dithering","optionValue_preprocessingEnabled","preProcessingValue_brightness","preProcessingValue_contrast","preProcessingValue_saturation","preProcessingValue_backgroundColourSelect","preProcessingValue_backgroundColour","uploadedImage","componentDidUpdate_shouldNBTWorkerTerminate","buttons_mapModeConditional","Math","floor","button_donate","textDecoration","MapPreview","mapPreviewSizeScale","workerProgress","mapCanvasWorker","MapCanvasWorker","increasePreviewScale","decreasePreviewScale","canvasRef_source","createRef","canvasRef_display","fileInputRef","newProps","prevState","newState","propChanges","shouldCanvasUpdate_source","updateCanvas_source","shouldCanvasUpdate_display","updateCanvas_display","colourHex","rgbGroups_input","exec","colourRGB_input","parseInt","smallestDistance","colourRGB_return","coloursRGB_colourSet","colourRGB_colourSet","colourDistance","pow","padStart","ctx_source","current","getContext","imageSmoothingEnabled","imageSmoothingQuality","clearRect","canvas","height","backgroundColour","BackgroundColourModes","test","SMOOTH","selectedBlockId","closestSmoothColourTo","rect","fillStyle","fill","CropModes","drawImage","CENTER","MANUAL","samplingWidth","samplingHeight","samplingOffset_x","samplingOffset_y","img_width","img_height","onGetMapMaterials","onMapPreviewWorker_begin","canvasImageData","getImageData","putImageData","pixels","chunks","DitherMethods","optionValue_showGridOverlay","onFileDialogEvent","ref","backgroundSize","click","visibility","AutoCompleteInputBlockToAdd","suggestionSelected","getRelevantSuggestions","suggestions_prefix","suggestions_includes","blockNBTData","slice","startsWith","concat","handleTextChange","newValue","replace","toLowerCase","setValue","onSuggestionClicked","suggestion","onFocus","relevantSuggestions","BufferedNumberInput","buffer","onInputChange","validators","onValidInput","newValue_buffer","newValue_int","validator","min","max","step","MapSettings","onOptionChange_version","onOptionChange_mapSize_x","onOptionChange_mapSize_y","onOptionChange_modeNBTOrMapdat","onOptionChange_cropImage","onOptionChange_cropImage_zoom","onOptionChange_cropImage_percent_x","onOptionChange_cropImage_percent_y","onOptionChange_showGridOverlay","onOptionChange_staircasing","onOptionChange_WhereSupportBlocks","setOption_SupportBlock","onOptionChange_transparency","onOptionChange_transparencyTolerance","onOptionChange_mapdatFilenameUseId","onOptionChange_mapdatFilenameIdStart","onOptionChange_BetterColour","onOptionChange_dithering","onOptionChange_PreProcessingEnabled","onOptionChange_PreProcessingBrightness","onOptionChange_PreProcessingContrast","onOptionChange_PreProcessingSaturation","onOptionChange_PreProcessingBackgroundColourSelect","onOptionChange_PreProcessingBackgroundColour","optionValue_extras_moreStaircasingOptions","onOptionChange_extras_moreStaircasingOptions","setting_mode","mapMode","setting_version","supportedVersion","setting_mapSize","isNaN","setting_crop","cropMode","setting_crop_zoom","setting_crop_percent_x","setting_crop_percent_y","settings_mapModeConditional","settingGroup_cropping","setting_grid","setting_staircasing","staircaseMode","extra","whereSupportBlocksMode","setting_transparency","setting_transparencyTolerance","settingGroup_transparency","setting_mapdatFilenameUseId","setting_mapdatFilenameIdStart","settingGroup_mapdatFilename","setting_betterColour","setting_dithering","ditherMethodKey","setting_preprocessing","setting_preprocessing_brightness","setting_preprocessing_contrast","setting_preprocessing_saturation","setting_preprocessing_background","backgroundColourMode","setting_preprocessing_backgroundColour","settingGroup_preprocessing","setting_extras_moreStaircasingOptions","settingGroup_extras","Materials","onlyMaxPerSplit","chunksToDisplay","rowInput","columnInput","allMaterials","onOnlyMaxPerSplitChange","onDisplayAllChange","onResetList","onAddChunkToList","chunkCoords","row","column","updatedChunksToDisplay","chunkExists","onRowChanged","onColumnChanged","displayChunkMaterials","materialsTotal","getNewMaterialsList","addChunk","displayAllMaterials","curRow","curCol","rowOfChunks","formatMaterialCount","count","numberOfStacks","remainder","numberOfShulkers","toFixed","newChunkCoords","existingChunkCoords","destination","col","rowNum","colNum","chunk","addSupportBlockCount","addMaterialsCount","supportBlockCount","materials","materialCount","materialsList","sort","first","second","newMaterialsList","materialsToDisplay","nonZeroMaterialsItems","getSortedNonZeroMaterials","supportBlockIds","colourSetIdAndBlockIdFromNBTName","class","TagTypes","NBTReader","ArrayBuffer","DataView","Uint8Array","dataView","arrayView","offset","bytes","codepoints","byte","String","fromCharCode","apply","dataType","size","readByType","read","arrayLength","returnArray","string_bytes_length","string_bytes","decodeUTF8","list_objectType","list_length","returnObject","tagType","array_length","Waila","selectedBlock","x","y","z","verticalAlign","ViewOnline2D","viewOnline_NBT_decompressed","zoomFactor","canvasOffset_x","canvasOffset_y","focusChunk","paletteIdToColourSetIdAndBlockId","mouse","down","movedSinceDown","handleScroll_document","handleScroll_canvas","zoomMultiplier","offsetX","offsetY","delta","wheelDelta","detail","bind","handleMouseDown","clientX","clientY","addEventListener","handleMouseMove","passive","handleMouseUp","canvasRef_viewOnline","canvas_width","clientWidth","canvas_height","clientHeight","block_x","block_z","block_coords","pos","block_paletteId","selectedBlock_colourSetId","selectedBlock_blockId","chunkRow","ceil","chunkCol","removeEventListener","mouseMoved_x","mouseMoved_y","abs","onFocusChunkChange","viewOnline_NBT","nbtReader","loadBuffer","getData","NBT_palette","palette","paletteItem_index","paletteItem","paletteItemFound","Name","Properties","argKey","argValue","img_textures","Image","onload","canvasRef_viewOnline_ctx","textBaseline","font","fillRect","processedNoobline","int_colourSetId","int_blockId","int_colourSetId_toDraw","int_blockId_toDraw","strokeStyle","strokeText","fillText","whichChunk_x","whichChunk_y","getNBTDecompressed","drawNBT","onChooseViewOnline3D","component_controls","flexDirection","component_waila","component_size","size_x","size_y","size_z","marginRight","right","component_topBar","left","top","_euler","Euler","_vector","Vector3","_vector_up","_changeEvent","_lockEvent","_unlockEvent","_PI_2","PI","PointerLockControls","camera","domElement","warn","isLocked","minPolarAngle","maxPolarAngle","scope","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","error","connect","disconnect","dispose","getObject","getDirection","direction","v","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","up","addScaledVector","moveRight","moveUp","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","BlockWorld","options","faces","uvRow","dir","vertices","uv","chunkSize","chunks_mesh","renderRequested","animationFrameRequestID","moveX","moveY","startAnimationLoop","renderer","render","scene","requestAnimationFrame","stopAnimationLoop","cancelAnimationFrame","handleKeyDown","controls","fov","updateProjectionMatrix","handleKeyUp","handlePointerDown","canvasRef","recordMovement","selectBlockIfNoMovement","selectBlock","handleTouchStart","handleWindowResize","setSize","aspect","tileSize","tileTextureWidth","tileTextureHeight","camera_x","camera_y","camera_z","onSelectBlockCallback","THREE","add","set","texture","load","magFilter","minFilter","material","side","alphaTest","transparent","blockX","euclideanModulo","chunkX","chunkY","chunkZ","getChunkKey","chunkKey","getChunkForBlock","blockOffset","computeBlockOffset","addChunkForBlock","start","end","setFromMatrixPosition","matrixWorld","unproject","intersection","intersectRay","dx","dy","dz","lenSq","len","sqrt","ix","iy","iz","stepX","stepY","stepZ","txDelta","tyDelta","tzDelta","xDist","yDist","zDist","txMax","Infinity","tyMax","tzMax","steppedIndex","getBlock","verticesComponents","normalsComponents","uvs","indices","startX","startY","startZ","blockY","blockZ","neighbor","numberOfVertices","mesh","geometry","generateGeometryDataForChunk","setAttribute","Float32Array","setIndex","computeBoundingSphere","updatedChunkKeys","ox","oy","oz","updateChunkGeometry","ViewOnline3D","handleEscapeKeyDown","handleViewOnline3DEscape","schematic_size_x","schematic_size_y","schematic_size_z","world","setBlock","addEventListeners","removeEventListeners","bottom","MapartController","ALL_OPTIMIZED","FloydSteinberg","viewOnline_3D","eventListener_dragover","stopPropagation","eventListener_drop","files","dataTransfer","imgUrl","URL","createObjectURL","loadUploadedImageFromURL","eventListener_paste","clipboardData","handleChangeColourSetBlock","handleChangeColourSetBlocks","setsAndBlocks","blockIdAndBlock","mode","mcVersion","supportedVersionFound","cropValue","staircasingValue","ditheringValue","text","handleGetPDNPaletteClicked","paletteText","selectedBlocksToURL","numberOfColoursExported","toneKeysToExport","toneKeys","colours","toneKeyToExport","Number","toUpperCase","handlePresetChange","presetName","selectedPreset","handleDeletePreset","presets_new","JSON","stringify","handleSavePreset","presetToSave_name","prompt","otherPresets","newPreset","presetQueryString","handleSharePreset","URLToPreset","encodedPreset","onCorruptedPreset","location","fetch","req","json","derp","images","representations","full","presetRegex","encodedColourSetId","encodedBlockId","decodedColourSetId","decodedPresetIndex","Q","R","S","T","U","V","W","X","Y","Z","decodedBlock","decodedBlockId","handleSetMapMaterials","block_name_trimmed","trim","blockToAdd","addedFirstVersion","nbtTag_key_trimmed","nbtTag_value_trimmed","customBlocks_new","parse","customBlock","getMergedColoursJSON","init","cookiesPresets_loaded","touchCookie","DefaultPresets","cookiesPresets_updated","cookiesPreset_loaded","cookiesPreset_updated","defaultPreset","cookie_customBlocks","cookieMCVersion","URLParams","searchParams","has","decodedPresetBlocks","get","customBlocks","coloursJSON_custom","imageURL","baseFilename","img","filename","downloadURL","downloadElt","createElement","download","appendChild","revokeObjectURL","removeChild","Root","displayingCorruptedPresetWarning","displayingEdgeWarning","stringName","languageCodeOverride","stringSegments","stringLast","folder","onEdgeWarningButtonClick","onCorruptedPresetWarningButtonClick","showCorruptedPresetWarning","ReactDOM","StrictMode","basename","path","component","getElementById"],"mappings":"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","file":"static/js/main.8f2784e6.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/classicVsValley.fb0924c8.png\";","import { Link } from \"react-router-dom\";\r\n\r\nimport \"./faq.css\";\r\nimport IMG_Palette from \"../images/Palette128_Unobtainable_Trans.png\";\r\nimport IMG_ClassicVsValley from \"../images/classicVsValley.png\";\r\n\r\nfunction FAQ(props) {\r\n  return (\r\n    <div className=\"FAQ\">\r\n      <Link to={`/${![undefined, \"en\"].includes(props.match.params.countryCode) ? props.match.params.countryCode : \"\"}`}>\r\n        <h3>Close</h3>\r\n      </Link>\r\n\r\n      <h1>FAQ</h1>\r\n\r\n      <h2>How do I get started?</h2>\r\n      <a href=\"https://youtu.be/bJ-wX68WNHM\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        Video tutorial\r\n      </a>\r\n\r\n      <h2>General</h2>\r\n      <b>Why does the output change with the same image and settings?</b>\r\n      <p>\r\n        The JPEG decoding and scaling algorithms vary between browsers and get changed all the time. If you wish to be 100% sure your image stays the same,\r\n        right click on the <em>Map preview</em> and choose <em>Save image as...</em>. Next time you can upload the image you saved.\r\n      </p>\r\n\r\n      <h2>Schematic (.nbt)</h2>\r\n      <b>What do I do with the NBT file?</b>\r\n      <p>Use it like a .schematic file.</p>\r\n\r\n      <b>How can I use the NBT file?</b>\r\n      <p>\r\n        You can use it with programs like{\" \"}\r\n        <a href=\"https://cubical.xyz/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          cubical.xyz\r\n        </a>\r\n        ,{\" \"}\r\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          MCEdit\r\n        </a>{\" \"}\r\n        and mods like{\" \"}\r\n        <a href=\"https://minecraft.curseforge.com/projects/schematica\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          Schematica\r\n        </a>{\" \"}\r\n        /{\" \"}\r\n        <a href=\"https://minecraft.curseforge.com/projects/litematica\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          Litematica\r\n        </a>\r\n        . You can also import them into your game directly with a structure block - although it might require a redstone power source (\r\n        <a href=\"https://github.com/rebane2001/mapartcraft/issues/100\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          #100\r\n        </a>\r\n        ). It might be a better idea to use a datafile instead - it's easier and gives more colors.\r\n      </p>\r\n\r\n      <b>...but I need a .schematic file!</b>\r\n      <p>\r\n        Import it into{\" \"}\r\n        <a href=\"https://cubical.xyz/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          cubical.xyz\r\n        </a>{\" \"}\r\n        or{\" \"}\r\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          MCEdit\r\n        </a>{\" \"}\r\n        and export as .schematic. <em>Note that if you're using MCEdit or Cubical, you must export the map as 1.12.2.</em> You do not need a .schematic file for\r\n        use with Baritone; use Schematica and the \"#schematica\" command.\r\n      </p>\r\n\r\n      <b>But MCEdit doesn't work!</b>\r\n      <p>\r\n        Make sure you're using{\" \"}\r\n        <a href=\"https://www.mcedit-unified.net/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          MCEdit Unified\r\n        </a>{\" \"}\r\n        and importing the NBT as a schematic, NOT loading it as a world. Alternatively, use Cubical.\r\n      </p>\r\n\r\n      <b>Why is there a row of extra blocks?</b>\r\n      <p>\r\n        The shade a block shows up as on the map is decided by the block North of it; if the Northern block is higher then a darker tone shows, else if the\r\n        Northern block is lower then a lighter tone shows, else a normal tone shows. Thus an extra row of blocks (colloquially known as a noobline) exists at\r\n        the top of a map to shade the top row properly.\r\n      </p>\r\n\r\n      <b>How do I align the map?</b>\r\n      <p>\r\n        When you have found a suitable place to build your map (eg above an ocean) make sure to open the map first and find the bottom left corner for aligning\r\n        your schematic. Maps in Minecraft align to a fixed 128x128 grid. North is always the up-direction on maps and you shouldn't need to rotate the schematic.\r\n      </p>\r\n\r\n      <h2>Datafile (.dat)</h2>\r\n      <b>What is a map.dat file?</b>\r\n      <p>\r\n        '.dat' is the native format Minecraft stores map data in, meaning you can use it to import maps into your worlds without needing to build a physical\r\n        structure. It also enables you to use a fourth extra shade of color not accessible in survival.\r\n      </p>\r\n\r\n      <b>What do I do with the map.dat file?</b>\r\n      <p>\r\n        You can use the map.dat file in singleplayer or a server you own. Create a new map in-game, go to your world's save file, then the data folder and from\r\n        there you can replace map_xxx.dat files. MapartCraft downloads a .zip file containing all of the 1x1 map.dat files.\r\n      </p>\r\n\r\n      <h2>Settings</h2>\r\n      <b>Map size?</b>\r\n      <p>\r\n        This will define how many maps you will create for your picture. When creating bigger maps, it's recommended to split it into multiple schematics (lest\r\n        large staircased maps stretch above the world height limit). This can be done with the \"DOWNLOAD AS 1X1 SPLIT\" button which downloads all the 1x1 NBTs in a .zip file.\r\n      </p>\r\n\r\n      <b>My image is stretched!</b>\r\n      <p>Change your map size, enable the crop option, or edit your image with an image editor.</p>\r\n\r\n      <b>'Staircasing'?</b>\r\n      <p>\r\n        This will make your map 3D. Doing so will give you 3 times the colors, often producing a much richer mapart, but it will also make the map a lot harder\r\n        to build, as it is not flat. 3D 'Classic' and 'Valley' modes produce the exact same resulting map image, however they are built differently; 'Valley' mode allows the map to be built without any downwards staircases, which may be easier in survival. Observe the difference:\r\n      </p>\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <img alt=\"classicVsValley.png\" src={IMG_ClassicVsValley} style={{\"maxWidth\": \"75%\"}}></img>\r\n      </div>\r\n      <p>\r\n        More staircasing modes can be enabled from the <em>Extras</em> settings tab.\r\n      </p>\r\n\r\n      <b>Better color?</b>\r\n      <p>\r\n        This setting will give you more natural colors. Disabling this will make the website faster and give you slightly worse colors. It is recommended to\r\n        keep this enabled.\r\n      </p>\r\n\r\n      <b>Dithering?</b>\r\n      <p>\r\n        This will add grain to your image to make it look a lot smoother. Floyd-Steinberg dithering is the most accurate, but the Ordered/Bayer dithering will\r\n        usually have less artifacts and gives the image an unique style. It is usually recommended to disable dithering for flat-colored artwork.\r\n      </p>\r\n\r\n      <b>Add blocks under/Block to add?</b>\r\n      <p>\r\n        Here you can pick the block that will be put under either important blocks (eg carpets, sand, pressure plates) or all blocks. This block will also be\r\n        used for the noobline, which cannot be disabled.\r\n      </p>\r\n\r\n      <b>Presets?</b>\r\n      <p>\r\n        You can use presets to save and load block configurations. Pick your blocks and click \"Save\" to save them as a preset, pick a preset to load it and\r\n        click \"Delete\" to delete the loaded preset. It is also possible to share a link for your preset with others.\r\n      </p>\r\n\r\n      <h2>Custom Blocks</h2>\r\n      <p>Custom blocks can be added from the bottom of the blocks selection pane. Different versions of a block can be added for the same block name, eg for 1.12.2 and 1.13.2+. Some examples are provided in the 'examples' section. NBT tags / block states can be found on the <a href=\"https://minecraft.fandom.com/wiki/Block_states\" target=\"_blank\" rel=\"noopener noreferrer\">Minecraft Wiki</a>. To edit an existing custom block, select it, edit the tags / versions etc, and then click the 'add' button to overwrite. Note that presets URLs do not support custom blocks.</p>\r\n\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <img alt=\"Palette\" src={IMG_Palette} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FAQ;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAFWElEQVR42u2dS28bVRxHx5mJ37Fjx3ZsN3YebhunNEuEkHgsilCFWPJYIJD4Aiz4EvkCSF2yJEhsWNOyBUWAKOpL6kOkavNo0jaYxEnctGFVL88ggbrpOdvf+PpOc3yr+5977ySWlpaOA2Dr4lcUB9v3P8b8xgLGwbnut5iv/N3D/M3r72G+fP8y5gsL3MHr/PXBiTtjfP+pmM8Hl+Iu4PgG5xd7fAMjgbzUKIACiAKIAogCiALIy0a0uLiIF9z7I4N5rnca8wcx89hul9v/83Ef8zMPW5iP9e7wPPoEd/Bemvtf2yxhvsq3F5SDmAtqMXWA1Zg/cL/vCCAKIAogCiAKIAogCiDDaWK328ULkhWeCCc25jC/WecOnDzJ7Ve2IsxP325int/IY16vcwfzCe5/JVvFPJ3jz48HMYWGCsf1mI9HUeQIIAogCiAKIAogCiAKIMNpYqfTwQuOyryw/SDXxrzA0+RgZobbL6d4HjtXnsQ8l+OJeLXKHcw94f6XMw3MUzF1gEIQs3GgzHE1ZR1A/C9AFEAUQBRAFEAUQP41iS8+/RDPB1j77UdsYBDyvoCHuXHM58dWML+yz+vm21u8P3/l4SbmC51ZzNcPnvI0vf8M841BzG9scJfzEs/jO7vc/s/bO44AogCiAKIAogCiAKIA8pzo1PQUG3IriflhNMGFhiI/b58tcftre1wHmDoscB1h9zHm9Ql+4N7f4wUBtZDrAHsHMb+xcIPzwijGjeMQ89RO6AggCiAKIAogCiAKIAogwzrA7BSva++P8Tx9f5TPydsv8UF3rSq3P57iDfDNHd7/n0lx+9VSEfPtiOsAE8+OMN8aiWL+BNy/IObfvzbgef5oOOIIIAogCiAKIAogCiAKIMM6QKvB++u38vw8uj/K8+idIq8XaE5w+8WQ6wC1mP3/6SS3P1Hk9QT5YIB5acB1gFwQUwd4yv0L8lwHqPS5/WTkegBRAFEAUQBRAFEAUQAZkjj3WQvPB3i79To2sP6I5/ntCxcw//WDJcyj6DLmy5vLmH80+Tnmh6s/Yb49wve3tvY+5mfaX2P+xrufcJng8BvMv9s7j/n+75OOAKIAogCiAKIAogCiADKcZtems3jB2fkW5tkN3lfQjenA5tQi5qOjj7iBY45b7RmeJ+9e5QZCfnFfr8f9b1R538Li2VcwP9rn9QoXe3xOY7TedgQQBRAFEAUQBRAFEAWQ4TSxMsXn8M2f4nn+09T0f6oDXGvyFcnkLW5gj+Nmk+sYexs8T++P8PkH2Sz3f7LM7Xe785g/2eXPFx/z+w6Or5xyBBAFEAUQBRAFEAUQBZBhHaDc4P33czO8rrz3jN830InpQK3GV6RS/P3BNseT9Sbmfxf5fIFHIb/3MJPh/ldKvN6i05njOkCP+zdW4Of9T8odRwBRAFEAUQBRAFEAUQB5TiL4so0r69/5gc/L37+yjvlCndcTPEjzPP3uNq8HuPnqa5hPZPgcveIv1zC/fZ7X3Z+5yvsW3ury/V8+4t/gpeXvE44AogCiAKIAogCiAKIA8j8RBfP8vHpyhc/L3435gtk07zuIcrzuvrfD5+lHtTrm2XxMHSC9yu3HrIcocxkkOD3NdY71wYgjgCiAKIAogCiAKIAogLy4OsAc1wEqBXYk5q13QTvN+w4GWX7v4HrE3xBWqlwHKPDnC0m+/3CK2x8fP8R87gTXEa4OQkcAUQBRAFEAUQBRAFEAeXF1gDbP08t5PpA/EbNqvZlKYf5Xhs/DH4v4eX5U5vf6pceTmOdTvF4hbHD7hUIP83aD6wjlA+sAogCiAKIAogCiAKIA8sL4B0z245ksDQ2eAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport \"./header.css\";\r\n\r\nclass Header extends Component {\r\n  state = { contactInfoClassname: \"contactInfoBlurred\" };\r\n\r\n  // Reveal contact info\r\n  onContactInfoClick = (event) => {\r\n    const { getLocaleString } = this.props;\r\n    event.preventDefault();\r\n    if (window.confirm(getLocaleString(\"FAQ/HAVE-YOU-READ\"))) {\r\n      alert(getLocaleString(\"FAQ/HELP-IN-ENGLISH\"));\r\n      this.setState({ contactInfoClassname: \"contactInfo\" });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { contactInfoClassname } = this.state;\r\n    const { getLocaleString } = this.props;\r\n    return (\r\n      <div className=\"header\">\r\n        <h3>\r\n          <Link to={`/${![undefined, \"en\"].includes(this.props.countryCode) ? this.props.countryCode + \"/\" : \"\"}faq`}>\r\n            <span className=\"FAQTextButton\">{getLocaleString(\"FAQ/FAQ\")}</span>\r\n          </Link>\r\n          <span> | </span>\r\n          <a href=\"https://youtu.be/j-4RXPkJKU8\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            {getLocaleString(\"FAQ/VIDEO-TUTORIAL\")}\r\n          </a>\r\n          <span> | </span>\r\n          <a href=\"https://github.com/rebane2001/mapartcraft\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            GitHub\r\n          </a>\r\n          <span> | </span>\r\n          <a href=\"https://discord.gg/r7Tuerq\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            2b2t Mapart Discord\r\n          </a>\r\n          <span> | </span>\r\n          <a href=\"https://area51.selfadjointoperator.com/mapartcraft/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            Beta\r\n          </a>\r\n        </h3>\r\n        <p>\r\n          {getLocaleString(\"DESCRIPTION/1\")}\r\n          <a href=\"https://www.reddit.com/r/2b2t/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            2b2t\r\n          </a>\r\n          {getLocaleString(\"DESCRIPTION/2\")}\r\n          <br></br>\r\n          {getLocaleString(\"DESCRIPTION/3\")}\r\n          <a href=\"https://redd.it/2yck3f\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            {getLocaleString(\"DESCRIPTION/4\")}\r\n          </a>\r\n          {getLocaleString(\"DESCRIPTION/5\")}\r\n          <br></br>\r\n          {getLocaleString(\"DESCRIPTION/6\")}\r\n          <span className={contactInfoClassname} onClick={this.onContactInfoClick}>\r\n            (rebane2001#3716)\r\n          </span>\r\n          {getLocaleString(\"DESCRIPTION/7\")}\r\n          <span className={contactInfoClassname} onClick={this.onContactInfoClick}>\r\n            (\r\n            <a href=\"https://www.reddit.com/message/compose/?to=rebane2001\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              /u/rebane2001\r\n            </a>\r\n            )\r\n          </span>\r\n          {getLocaleString(\"DESCRIPTION/8\")}\r\n          <a href=\"https://github.com/rebane2001/mapartcraft/issues\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            GitHub\r\n          </a>\r\n          {\".\"}\r\n          <br></br>\r\n          <em>\r\n            {getLocaleString(\"DESCRIPTION/9\")}\r\n            <a href=\"/mapartcraft/classic\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              {getLocaleString(\"DESCRIPTION/10\")}\r\n            </a>\r\n            {\".\"}\r\n          </em>\r\n          <br></br>\r\n          <b>\r\n            {getLocaleString(\"FAQ/PLEASE-READ-1\")}\r\n            <Link to={`/${![undefined, \"en\"].includes(this.props.countryCode) ? this.props.countryCode + \"/\" : \"\"}faq`}>\r\n              <span className=\"FAQTextButton\">{getLocaleString(\"FAQ/FAQ\")}</span>\r\n            </Link>\r\n            {getLocaleString(\"FAQ/PLEASE-READ-2\")}\r\n          </b>\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Header;\r\n","export default __webpack_public_path__ + \"static/media/flag.f5d7d6f6.svg\";","export default __webpack_public_path__ + \"static/media/flag.8d48322a.svg\";","export default __webpack_public_path__ + \"static/media/flag.bca4c3c0.svg\";","export default __webpack_public_path__ + \"static/media/flag.10f89117.svg\";","export default __webpack_public_path__ + \"static/media/flag.9f898403.svg\";","export default __webpack_public_path__ + \"static/media/flag.8b3048c6.svg\";","export default __webpack_public_path__ + \"static/media/flag_pop.4947b0a4.svg\";","export default __webpack_public_path__ + \"static/media/flag.80919dec.svg\";","export default __webpack_public_path__ + \"static/media/flag.f5d8ab3c.svg\";","export default __webpack_public_path__ + \"static/media/flag.bb851604.svg\";","export default __webpack_public_path__ + \"static/media/flag.8a31a3ac.svg\";","export default __webpack_public_path__ + \"static/media/flag.85b7f971.svg\";","export default __webpack_public_path__ + \"static/media/flag.6f6e5709.svg\";","export default __webpack_public_path__ + \"static/media/flag.096c0012.svg\";","import Flag_de from \"./de/flag.svg\";\r\nimport Strings_de from \"./de/strings.json\";\r\n\r\nimport Flag_ua from \"./ua/flag.svg\";\r\nimport Strings_ua from \"./ua/strings.json\";\r\n\r\nimport Flag_en from \"./en/flag.svg\";\r\nimport Strings_en from \"./en/strings.json\";\r\n\r\nimport Flag_eo from \"./eo/flag.svg\";\r\nimport Strings_eo from \"./eo/strings.json\";\r\n\r\nimport Flag_es from \"./es/flag.svg\";\r\nimport Strings_es from \"./es/strings.json\";\r\n\r\nimport Flag_et from \"./et/flag.svg\";\r\nimport Flag_et_pop from \"./et/flag_pop.svg\";\r\nimport Strings_et from \"./et/strings.json\";\r\n\r\nimport Flag_fr from \"./fr/flag.svg\";\r\nimport Strings_fr from \"./fr/strings.json\";\r\n\r\nimport Flag_it from \"./it/flag.svg\";\r\nimport Strings_it from \"./it/strings.json\";\r\n\r\nimport Flag_lt from \"./lt/flag.svg\";\r\nimport Strings_lt from \"./lt/strings.json\";\r\n\r\nimport Flag_pt from \"./pt/flag.svg\";\r\nimport Strings_pt from \"./pt/strings.json\";\r\n\r\nimport Flag_ru from \"./ru/flag.svg\";\r\nimport Strings_ru from \"./ru/strings.json\";\r\n\r\nimport Flag_zh_Hans from \"./zh-Hans/flag.svg\";\r\nimport Strings_zh_Hans from \"./zh-Hans/strings.json\";\r\n\r\nimport Flag_zh_Hant from \"./zh-Hant/flag.svg\";\r\nimport Strings_zh_Hant from \"./zh-Hant/strings.json\";\r\n\r\nconst Locale = {\r\n  en: { strings: Strings_en, flag: Flag_en },\r\n  ua: { strings: Strings_ua, flag: Flag_ua },\r\n  et: { strings: Strings_et, flag: Flag_et, flag_special: Flag_et_pop },\r\n  lt: { strings: Strings_lt, flag: Flag_lt },\r\n  ru: { strings: Strings_ru, flag: Flag_ru },\r\n  de: { strings: Strings_de, flag: Flag_de },\r\n  fr: { strings: Strings_fr, flag: Flag_fr },\r\n  it: { strings: Strings_it, flag: Flag_it },\r\n  pt: { strings: Strings_pt, flag: Flag_pt },\r\n  es: { strings: Strings_es, flag: Flag_es },\r\n  \"zh-Hans\": { strings: Strings_zh_Hans, flag: Flag_zh_Hans },\r\n  \"zh-Hant\": { strings: Strings_zh_Hant, flag: Flag_zh_Hant },\r\n  eo: { strings: Strings_eo, flag: Flag_eo },\r\n};\r\n\r\nexport default Locale;\r\n","import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport Locale from \"../locale/locale\";\r\n\r\nimport \"./languages.css\";\r\n\r\nclass Languages extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"languages\">\r\n        {Object.keys(Locale).map((language) => (\r\n          <div className=\"language\" key={language}>\r\n            {language === \"et\" ? (\r\n              <React.Fragment>\r\n                <Link to={`/${language}`}>\r\n                  <img src={Locale[language].flag} alt={language} className={`flag flag_${language}`} />\r\n                  <img key=\"et_pop\" src={Locale[language].flag_special} alt=\"et_pop\" className={\"flag flag_et_pop\"} />\r\n                </Link>\r\n              </React.Fragment>\r\n            ) : (\r\n              <Link to={`/${language === \"en\" ? \"\" : language}`}>\r\n                <img src={Locale[language].flag} alt={language} className={`flag flag_${language}`} />\r\n              </Link>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Languages;\r\n","class CookieManager {\r\n  static init() {\r\n    // Handle cookie migration\r\n    const cookieNames = [\"presets\", \"mcversion\", \"customBlocks\"];\r\n    cookieNames.forEach(name => {\r\n      if (this.getCookie(`mapartcraft_${name}`) === null && this.getCookie(name) !== null) {\r\n        this.setCookie(`mapartcraft_${name}`, this.getCookie(name));\r\n      }\r\n    });\r\n  }\r\n\r\n  //Thx\r\n  //https://www.w3schools.com/js/js_cookies.asp\r\n  static setCookie(cname, cvalue) {\r\n    let d = new Date();\r\n    d.setTime(d.getTime() + 9000 * 24 * 60 * 60 * 1000);\r\n    let expires = \"expires=\" + d.toUTCString();\r\n    document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\";\r\n  }\r\n\r\n  static getCookie(cname) {\r\n    let name = cname + \"=\";\r\n    let ca = document.cookie.split(\";\");\r\n    for (let i = 0; i < ca.length; i++) {\r\n      let c = ca[i];\r\n      while (c.charAt(0) === \" \") {\r\n        c = c.substring(1);\r\n      }\r\n      if (c.indexOf(name) === 0) {\r\n        return c.substring(name.length, c.length);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  static touchCookie(cname, defaultValue) {\r\n    const cookieValue = this.getCookie(cname);\r\n    if (cookieValue !== null) {\r\n      return cookieValue;\r\n    } else {\r\n      this.setCookie(cname, defaultValue);\r\n      return defaultValue;\r\n    }\r\n  }\r\n}\r\n\r\nexport default CookieManager;\r\n","import React, { Component } from \"react\";\r\n\r\nimport \"./tooltip.css\";\r\n\r\nclass Tooltip extends Component {\r\n  state = {\r\n    hovering: false,\r\n  };\r\n\r\n  handleMouseOver = () => {\r\n    this.setState({ hovering: true });\r\n  };\r\n\r\n  handleMouseOut = () => {\r\n    this.setState({ hovering: false });\r\n  };\r\n\r\n  render() {\r\n    const tooltipStyle = this.props.textStyleOverrides !== undefined\r\n      ? {\r\n          display: this.state.hovering ? \"unset\" : \"none\",\r\n          ...this.props.textStyleOverrides,\r\n        }\r\n      : { display: this.state.hovering ? \"unset\" : \"none\" };\r\n    return (\r\n      <div className=\"tooltipContainer\">\r\n        <div onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\r\n          {this.props.children}\r\n        </div>\r\n        <p className=\"tooltipText\" style={tooltipStyle}>\r\n          {this.props.tooltipText}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Tooltip;\r\n","import React, { Component } from \"react\";\r\n\r\nimport SupportedVersions from \"../json/supportedVersions.json\";\r\n\r\nimport \"./blockSelectionAddCustom.css\";\r\n\r\nclass BlockSelectionAddCustom extends Component {\r\n  state = {\r\n    block_name: \"\",\r\n    block_nbtTags: [[\"\", \"\"]],\r\n    block_colourSetId: null,\r\n    block_needsSupport: false,\r\n    block_flammable: false,\r\n    block_versions: {},\r\n  };\r\n\r\n  E_KeyOrValue = {\r\n    key: 0,\r\n    value: 1,\r\n  };\r\n\r\n  examplesGroups = [\r\n    {\r\n      title: \"Stairs\",\r\n      blocks: [\r\n        {\r\n          blockName: \"birch_stairs\",\r\n          nbtTags: {\r\n            facing: \"north|east|south|west\",\r\n            half: \"top|bottom\",\r\n          },\r\n          versions: [\"1_12_2\", \"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      title: \"Slabs\",\r\n      blocks: [\r\n        {\r\n          blockName: \"stone_slab\",\r\n          nbtTags: {\r\n            variant: \"cobblestone\",\r\n            half: \"top|bottom\",\r\n          },\r\n          versions: [\"1_12_2\"],\r\n        },\r\n        {\r\n          blockName: \"cobblestone_slab\",\r\n          nbtTags: {\r\n            type: \"top|bottom\",\r\n          },\r\n          versions: [\"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      title: \"'Alpha slabs'\",\r\n      blocks: [\r\n        {\r\n          blockName: \"stone_slab\",\r\n          nbtTags: {\r\n            variant: \"wood_old\",\r\n            half: \"top|bottom\",\r\n          },\r\n          versions: [\"1_12_2\"],\r\n        },\r\n        {\r\n          blockName: \"petrified_oak_slab\",\r\n          nbtTags: {\r\n            type: \"top|bottom\",\r\n          },\r\n          versions: [\"1_13_2\", \"1_14_4\", \"1_15_2\", \"1_16_5\", \"1_17_1\"],\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const { coloursJSON } = props;\r\n    this.state.block_colourSetId = Object.keys(coloursJSON)[0];\r\n    for (const supportedVersion_key of Object.keys(SupportedVersions)) {\r\n      this.state.block_versions[supportedVersion_key] = false;\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { lastSelectedCustomBlock } = this.props;\r\n    if (prevProps.lastSelectedCustomBlock !== lastSelectedCustomBlock) {\r\n      this.loadBlockIntoForm(lastSelectedCustomBlock.colourSetId, lastSelectedCustomBlock.blockId);\r\n    }\r\n  }\r\n\r\n  loadBlockIntoForm(colourSetId, blockId) {\r\n    const { coloursJSON } = this.props;\r\n    const blockToLoad = coloursJSON[colourSetId].blocks[blockId];\r\n    let blockToLoad_nbtTags = [];\r\n    const versionToLoad_nbtData = Object.values(blockToLoad.validVersions).find((version) => typeof version !== \"string\");\r\n    for (const [nbtTag_key, nbtTag_value] of Object.entries(versionToLoad_nbtData.NBTArgs)) {\r\n      blockToLoad_nbtTags.push([nbtTag_key, nbtTag_value]);\r\n    }\r\n    blockToLoad_nbtTags.push([\"\", \"\"]);\r\n    const blockToLoad_versions = {};\r\n    for (const [supportedVersion_key, supportedVersion_value] of Object.entries(SupportedVersions)) {\r\n      if (supportedVersion_value.MCVersion in blockToLoad.validVersions) {\r\n        blockToLoad_versions[supportedVersion_key] = true;\r\n      } else {\r\n        blockToLoad_versions[supportedVersion_key] = false;\r\n      }\r\n    }\r\n    this.setState({\r\n      block_name: versionToLoad_nbtData.NBTName,\r\n      block_nbtTags: blockToLoad_nbtTags,\r\n      block_colourSetId: colourSetId,\r\n      block_needsSupport: blockToLoad.supportBlockMandatory,\r\n      block_flammable: blockToLoad.flammable,\r\n      block_versions: blockToLoad_versions,\r\n    });\r\n  }\r\n\r\n  onSettingChange_block_name = (e) => {\r\n    this.setState({ block_name: e.target.value });\r\n  };\r\n\r\n  onSettingChange_block_nbtTags = (e, tagIndex, keyOrValue) => {\r\n    const { block_nbtTags } = this.state;\r\n    let block_nbtTags_new = [...block_nbtTags];\r\n    block_nbtTags_new[tagIndex][keyOrValue] = e.target.value;\r\n    if (\r\n      tagIndex === block_nbtTags_new.length - 2 &&\r\n      block_nbtTags_new[block_nbtTags_new.length - 2].every((t) => t === \"\") &&\r\n      block_nbtTags_new[block_nbtTags_new.length - 1].every((t) => t === \"\")\r\n    ) {\r\n      // remove last tags inputs if they are empty and we have just made the penultimate tag inputs empty\r\n      block_nbtTags_new.pop();\r\n    } else if (tagIndex === block_nbtTags_new.length - 1) {\r\n      // always keep a blank set of inputs at the end for further tags\r\n      block_nbtTags_new.push([\"\", \"\"]);\r\n    }\r\n    this.setState({ block_nbtTags: block_nbtTags_new });\r\n  };\r\n\r\n  onSettingChange_block_colourSetId = (e) => {\r\n    this.setState({ block_colourSetId: e.target.value });\r\n  };\r\n\r\n  onSettingChange_block_needsSupport = () => {\r\n    this.setState((currentState) => {\r\n      return {\r\n        block_needsSupport: !currentState.block_needsSupport,\r\n      };\r\n    });\r\n  };\r\n\r\n  onSettingChange_block_flammable = () => {\r\n    this.setState((currentState) => {\r\n      return {\r\n        block_flammable: !currentState.block_flammable,\r\n      };\r\n    });\r\n  };\r\n\r\n  onSettingChange_block_versions = (versionToToggle) => {\r\n    let block_versions_new = { ...this.state.block_versions };\r\n    block_versions_new[versionToToggle] = !block_versions_new[versionToToggle];\r\n    this.setState({ block_versions: block_versions_new });\r\n  };\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON, onAddCustomBlock, onDeleteCustomBlock } = this.props;\r\n    const { block_name, block_nbtTags, block_colourSetId, block_needsSupport, block_flammable, block_versions } = this.state;\r\n    const examples = (\r\n      <details open={false}>\r\n        <summary>{getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/EXAMPLES\")}</summary>\r\n        {this.examplesGroups.map((examplesGroup) => (\r\n          <div key={examplesGroup.title}>\r\n            <b>{examplesGroup.title}</b>\r\n            {examplesGroup.blocks.map((block) => (\r\n              <div\r\n                key={block.blockName}\r\n                style={{\r\n                  outline: \"0.1em solid white\",\r\n                  padding: \"0.2em\",\r\n                  marginBlockStart: \"0.2em\",\r\n                  marginBlockEnd: \"0.2em\",\r\n                }}\r\n              >\r\n                <table>\r\n                  <tbody>\r\n                    <tr>\r\n                      <th>\r\n                        <b>\r\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/BLOCK-NAME\")}\r\n                          {\":\"}\r\n                        </b>{\" \"}\r\n                      </th>\r\n                      <td style={{ textAlign: \"right\" }}>\r\n                        {\"minecraft:\"}\r\n                        <input type=\"text\" value={block.blockName} disabled={true} />\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <th>\r\n                        <b>\r\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NBT-TAGS\")}\r\n                          {\":\"}\r\n                        </b>{\" \"}\r\n                      </th>\r\n                      <td style={{ textAlign: \"right\" }}>\r\n                        {Object.entries(block.nbtTags).map(([tagKey, tagValue]) => (\r\n                          <div key={tagKey}>\r\n                            <input type=\"text\" value={tagKey} disabled={true} />\r\n                            {\":\"}\r\n                            <input type=\"text\" value={tagValue} disabled={true} />\r\n                            <br />\r\n                          </div>\r\n                        ))}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <th>\r\n                        <b>\r\n                          {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/VERSIONS\")}\r\n                          {\":\"}\r\n                        </b>{\" \"}\r\n                      </th>\r\n                      <td>\r\n                        {Object.entries(SupportedVersions).map(([supportedVersion_key, supportedVersion_value]) => (\r\n                          <React.Fragment key={supportedVersion_key}>\r\n                            <input type=\"checkbox\" checked={block.versions.includes(supportedVersion_key)} disabled={true} />\r\n                            {supportedVersion_value.MCVersion}{\" \"}\r\n                          </React.Fragment>\r\n                        ))}\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            ))}\r\n            <br />\r\n          </div>\r\n        ))}\r\n      </details>\r\n    );\r\n    const setting_customBlock_name = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/BLOCK-NAME\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td style={{ textAlign: \"right\" }}>\r\n          {\"minecraft:\"}\r\n          <input type=\"text\" value={block_name} onChange={this.onSettingChange_block_name} />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_nbtTags = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NBT-TAGS\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td style={{ textAlign: \"right\" }}>\r\n          {block_nbtTags.map(([tagKey, tagValue], tagIndex) => (\r\n            <div key={tagIndex}>\r\n              <input type=\"text\" value={tagKey} onChange={(e) => this.onSettingChange_block_nbtTags(e, tagIndex, this.E_KeyOrValue.key)} />\r\n              {\":\"}\r\n              <input type=\"text\" value={tagValue} onChange={(e) => this.onSettingChange_block_nbtTags(e, tagIndex, this.E_KeyOrValue.value)} />\r\n              <br />\r\n            </div>\r\n          ))}\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_colourSetId = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/COLOUR-SET\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <select\r\n            value={block_colourSetId}\r\n            onChange={this.onSettingChange_block_colourSetId}\r\n            style={{\r\n              backgroundColor: `rgb(${coloursJSON[block_colourSetId].tonesRGB.normal.join(\", \")})`,\r\n              color:\r\n                coloursJSON[block_colourSetId].tonesRGB.normal[0] * 0.299 +\r\n                  coloursJSON[block_colourSetId].tonesRGB.normal[1] * 0.587 +\r\n                  coloursJSON[block_colourSetId].tonesRGB.normal[2] * 0.114 >\r\n                186\r\n                  ? \"black\"\r\n                  : \"white\",\r\n            }}\r\n          >\r\n            {Object.entries(coloursJSON).map(([colourSetId, colourSet]) => (\r\n              <option\r\n                key={colourSetId}\r\n                value={colourSetId}\r\n                style={{\r\n                  backgroundColor: `rgb(${colourSet.tonesRGB.normal.join(\", \")})`,\r\n                  color:\r\n                    colourSet.tonesRGB.normal[0] * 0.299 + colourSet.tonesRGB.normal[1] * 0.587 + colourSet.tonesRGB.normal[2] * 0.114 > 186\r\n                      ? \"black\"\r\n                      : \"white\",\r\n                }}\r\n              >\r\n                {colourSet.colourName}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_needsSupport = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NEEDS-SUPPORT\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input type=\"checkbox\" checked={block_needsSupport} onChange={this.onSettingChange_block_needsSupport} />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_flammable = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/FLAMMABLE\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input type=\"checkbox\" checked={block_flammable} onChange={this.onSettingChange_block_flammable} />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_customBlock_versions = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/VERSIONS\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          {Object.entries(block_versions).map(([block_version, block_version_checked]) => (\r\n            <React.Fragment key={block_version}>\r\n              <input type=\"checkbox\" checked={block_version_checked} onChange={() => this.onSettingChange_block_versions(block_version)} />\r\n              {SupportedVersions[block_version].MCVersion}{\" \"}\r\n            </React.Fragment>\r\n          ))}\r\n        </td>\r\n      </tr>\r\n    );\r\n    const customBlock_submit = (\r\n      <tr>\r\n        <th colSpan=\"2\">\r\n          <button\r\n            style={{ width: \"100%\" }}\r\n            onClick={() => onAddCustomBlock(block_colourSetId, block_name, block_nbtTags, block_versions, block_needsSupport, block_flammable)}\r\n          >\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ADD\")}\r\n          </button>\r\n        </th>\r\n      </tr>\r\n    );\r\n    const customBlock_delete = (\r\n      <tr>\r\n        <th colSpan=\"2\">\r\n          <button style={{ width: \"100%\" }} onClick={() => onDeleteCustomBlock(block_colourSetId, block_name, block_versions)}>\r\n            {getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/DELETE\")}\r\n          </button>\r\n        </th>\r\n      </tr>\r\n    );\r\n    return (\r\n      <details className=\"blockSelectionAddCustom\" open={false}>\r\n        <summary>{getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/TITLE\")}</summary>\r\n        {examples}\r\n        <table>\r\n          <tbody>\r\n            {setting_customBlock_name}\r\n            {setting_customBlock_nbtTags}\r\n            {setting_customBlock_colourSetId}\r\n            {setting_customBlock_needsSupport}\r\n            {setting_customBlock_flammable}\r\n            {setting_customBlock_versions}\r\n            {customBlock_submit}\r\n            {customBlock_delete}\r\n          </tbody>\r\n        </table>\r\n      </details>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BlockSelectionAddCustom;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAySURBVFhH7c6hAQAwDMOwbP//nJH9UFCZmOq0zWT3fywAAAAAAAAAAAAAAAAAgO2A5AFAtAM9NfYR6AAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/textures.da11246d.png\";","import React, { Component } from \"react\";\r\n\r\nimport IMG_Null from \"../../images/null.png\";\r\nimport IMG_Textures from \"../../images/textures.png\";\r\n\r\nimport \"./blockImage.css\";\r\n\r\nclass BlockImage extends Component {\r\n  render() {\r\n    const { getLocaleString, coloursJSON, colourSetId, blockId, style, className, ...props_others } = this.props;\r\n    const isNone = blockId === \"-1\"; // if barrier / no block selected for colourSetId\r\n    const isUnknown = colourSetId === \"64\" && blockId === \"2\"; // if unknown / placeholder block\r\n    return (\r\n      <img\r\n        src={IMG_Null}\r\n        alt={\r\n          isNone\r\n            ? getLocaleString(\"NONE\")\r\n            : isUnknown\r\n            ? getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")\r\n            : coloursJSON[colourSetId].blocks[blockId].displayName\r\n        }\r\n        style={\r\n          isNone\r\n            ? {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: \"-100%\",\r\n                backgroundPositionY: \"-6400%\",\r\n                ...style,\r\n              }\r\n            : isUnknown\r\n            ? {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: \"-200%\",\r\n                backgroundPositionY: \"-6400%\",\r\n                ...style,\r\n              }\r\n            : coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\"\r\n            ? {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: \"-500%\",\r\n                backgroundPositionY: \"-6400%\",\r\n                backgroundColor: `rgb(${coloursJSON[colourSetId].tonesRGB.normal.join(\", \")})`,\r\n                ...style,\r\n              }\r\n            : {\r\n                backgroundImage: `url(${IMG_Textures})`,\r\n                backgroundPositionX: `-${blockId}00%`,\r\n                backgroundPositionY: `-${colourSetId}00%`,\r\n                ...style,\r\n              }\r\n        }\r\n        className={`blockImage ${className}`}\r\n        {...props_others}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default BlockImage;\r\n","import React, { Component } from \"react\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\nimport BlockSelectionAddCustom from \"./blockSelectionAddCustom/blockSelectionAddCustom\";\r\nimport BlockImage from \"./blockImage\";\r\n\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport SupportedVersions from \"./json/supportedVersions.json\";\r\n\r\nimport \"./blockSelection.css\";\r\n\r\nclass BlockSelection extends Component {\r\n  state = {\r\n    lastSelectedCustomBlock: null, // {colourSetId, blockId}\r\n  };\r\n\r\n  cssRGB(RGBArray) {\r\n    // RGB array to css compatible string\r\n    return `rgb(${RGBArray.join(\", \")})`;\r\n  }\r\n\r\n  getColourSetBox = (colourSet) => {\r\n    const { optionValue_staircasing } = this.props;\r\n    let background;\r\n    switch (optionValue_staircasing) {\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.OFF.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.normal);\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.ON.uniqueId: {\r\n        background = `linear-gradient(${this.cssRGB(colourSet.tonesRGB.dark)} 33%, ${this.cssRGB(colourSet.tonesRGB.normal)} 33%, ${this.cssRGB(\r\n          colourSet.tonesRGB.normal\r\n        )} 66%, ${this.cssRGB(colourSet.tonesRGB.light)} 66%)`;\r\n        break;\r\n      }\r\n      case MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId: {\r\n        background = `linear-gradient(${this.cssRGB(colourSet.tonesRGB.unobtainable)} 25%, ${this.cssRGB(colourSet.tonesRGB.dark)} 25%, ${this.cssRGB(\r\n          colourSet.tonesRGB.dark\r\n        )} 50%, ${this.cssRGB(colourSet.tonesRGB.normal)} 50%, ${this.cssRGB(colourSet.tonesRGB.normal)} 75%, ${this.cssRGB(colourSet.tonesRGB.light)} 75%)`;\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.FULL_DARK.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.dark);\r\n        break;\r\n      }\r\n      case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId:\r\n      case MapModes.MAPDAT.staircaseModes.FULL_LIGHT.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.light);\r\n        break;\r\n      }\r\n      case MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId: {\r\n        background = this.cssRGB(colourSet.tonesRGB.unobtainable);\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(\"Unknown staircasing value\");\r\n      }\r\n    }\r\n    return (\r\n      <div\r\n        className=\"colourSetBox\"\r\n        style={{\r\n          background: background,\r\n        }}\r\n      />\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      coloursJSON,\r\n      getLocaleString,\r\n      onChangeColourSetBlock,\r\n      optionValue_version,\r\n      selectedBlocks,\r\n      presets,\r\n      selectedPresetName,\r\n      onPresetChange,\r\n      onDeletePreset,\r\n      onSavePreset,\r\n      onSharePreset,\r\n      onGetPDNPaletteClicked,\r\n      handleAddCustomBlock,\r\n      handleDeleteCustomBlock,\r\n    } = this.props;\r\n    const { lastSelectedCustomBlock } = this.state;\r\n    const presetsManagement = (\r\n      <React.Fragment>\r\n        <h2 id=\"blockselectiontitle\">{getLocaleString(\"BLOCK-SELECTION/TITLE\")}</h2>\r\n        <b>\r\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/TITLE\")}\r\n          {\":\"}\r\n        </b>{\" \"}\r\n        <select id=\"presets\" value={selectedPresetName} onChange={onPresetChange}>\r\n          <option value=\"None\">{getLocaleString(\"BLOCK-SELECTION/PRESETS/NONE\")}</option>\r\n          {presets.map((preset) => (\r\n            <option value={preset.name} key={preset.name}>\r\n              {\"localeKey\" in preset ? getLocaleString(preset.localeKey) : preset.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <button type=\"button\" onClick={onDeletePreset}>\r\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/DELETE\")}\r\n        </button>\r\n        <button type=\"button\" onClick={onSavePreset}>\r\n          {getLocaleString(\"BLOCK-SELECTION/PRESETS/SAVE\")}\r\n        </button>\r\n        <Tooltip tooltipText={getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-TT\")}>\r\n          <button type=\"button\" onClick={onSharePreset}>\r\n            {getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE\")}\r\n          </button>\r\n        </Tooltip>\r\n        <Tooltip tooltipText={getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-TT\")}>\r\n          <button type=\"button\" onClick={onGetPDNPaletteClicked}>\r\n            {getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD\")}\r\n          </button>\r\n        </Tooltip>\r\n      </React.Fragment>\r\n    );\r\n    const blockSelection = (\r\n      <React.Fragment>\r\n        {Object.entries(coloursJSON)\r\n          .filter(([, colourSet]) => Object.values(colourSet.blocks).some((block) => Object.keys(block.validVersions).includes(optionValue_version.MCVersion)))\r\n          .map(([colourSetId, colourSet]) => (\r\n            <div key={colourSetId} className=\"colourSet\">\r\n              {this.getColourSetBox(colourSet)}\r\n              <label>\r\n                <Tooltip tooltipText={getLocaleString(\"NONE\")}>\r\n                  <BlockImage\r\n                    getLocaleString={getLocaleString}\r\n                    coloursJSON={coloursJSON}\r\n                    colourSetId={colourSetId}\r\n                    blockId={\"-1\"}\r\n                    onClick={() => onChangeColourSetBlock(colourSetId, \"-1\")}\r\n                    style={{\r\n                      cursor: \"pointer\",\r\n                      ...(selectedBlocks[colourSetId] === \"-1\" && {\r\n                        filter: \"drop-shadow(0 0 4px #658968)\",\r\n                        backgroundColor: \"#658968\",\r\n                      }),\r\n                    }}\r\n                  />\r\n                </Tooltip>\r\n              </label>\r\n              <div className={\"colourSetBlocks\"}>\r\n                {Object.entries(colourSet.blocks)\r\n                  .filter(([, block]) => Object.keys(block.validVersions).includes(optionValue_version.MCVersion))\r\n                  .map(([blockId, block]) => (\r\n                    <label key={blockId}>\r\n                      <Tooltip tooltipText={block.displayName}>\r\n                        {selectedBlocks[colourSetId] === blockId &&\r\n                          !(Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1].MCVersion in block.validVersions) && (\r\n                            // if doesn't support latest version\r\n                            <div\r\n                              style={{\r\n                                position: \"absolute\",\r\n                                paddingLeft: \"28px\",\r\n                                zIndex: 110,\r\n                              }}\r\n                            >\r\n                              <Tooltip\r\n                                tooltipText={`${getLocaleString(\"BLOCK-SELECTION/UNSUPPORTED-PAST\")} ${\r\n                                  Object.keys(block.validVersions)[Object.keys(block.validVersions).length - 1]\r\n                                }`}\r\n                                textStyleOverrides={{\r\n                                  whiteSpace: \"nowrap\",\r\n                                  backgroundColor: \"red\",\r\n                                }}\r\n                              >\r\n                                <h2 style={{ backgroundColor: \"red\", margin: \"0\" }}>{\"!\"}</h2>\r\n                              </Tooltip>\r\n                            </div>\r\n                          )}\r\n                        <BlockImage\r\n                          coloursJSON={coloursJSON}\r\n                          colourSetId={colourSetId}\r\n                          blockId={blockId}\r\n                          onClick={() => {\r\n                            onChangeColourSetBlock(colourSetId, blockId);\r\n                            if (block.presetIndex === \"CUSTOM\") {\r\n                              this.setState({ lastSelectedCustomBlock: { colourSetId, blockId } });\r\n                            }\r\n                          }}\r\n                          style={{\r\n                            cursor: \"pointer\",\r\n                            ...(selectedBlocks[colourSetId] === blockId && {\r\n                              filter: \"drop-shadow(0 0 4px #658968)\",\r\n                              ...(block.presetIndex !== \"CUSTOM\" && {\r\n                                backgroundColor: \"#658968\",\r\n                              }),\r\n                            }),\r\n                          }}\r\n                        />\r\n                      </Tooltip>\r\n                    </label>\r\n                  ))}\r\n              </div>\r\n            </div>\r\n          ))}\r\n      </React.Fragment>\r\n    );\r\n    return (\r\n      <div className=\"section blockSelectionDiv\">\r\n        {presetsManagement}\r\n        {blockSelection}\r\n        <BlockSelectionAddCustom\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          onAddCustomBlock={handleAddCustomBlock}\r\n          onDeleteCustomBlock={handleDeleteCustomBlock}\r\n          lastSelectedCustomBlock={lastSelectedCustomBlock}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BlockSelection;\r\n","export default __webpack_public_path__ + \"static/media/nbt.d393b228.jsworker\";","import React, { Component } from \"react\";\r\nimport { gzip } from \"pako\"; // blocks when zipping\r\nimport JSZip from \"jszip\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\n\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport WhereSupportBlocksModes from \"./json/whereSupportBlocksModes.json\";\r\n\r\nimport NBTWorker from \"./workers/nbt.jsworker\";\r\n\r\nimport \"./greenButtons.css\";\r\n\r\nclass GreenButtons extends Component {\r\n  // For download buttons and donate link etc\r\n  state = {\r\n    buttonWidth_viewOnline: 1,\r\n    buttonWidth_NBT_Joined: 1,\r\n    buttonWidth_NBT_Split: 1,\r\n    buttonWidth_Mapdat_Split: 1,\r\n    mapPreviewWorker_onFinishCallback: null,\r\n  };\r\n\r\n  nbtWorker = new Worker(NBTWorker);\r\n\r\n  resetButtonWidths() {\r\n    this.setState({\r\n      buttonWidth_viewOnline: 1,\r\n      buttonWidth_NBT_Joined: 1,\r\n      buttonWidth_NBT_Split: 1,\r\n      buttonWidth_Mapdat_Split: 1,\r\n    });\r\n  }\r\n\r\n  getNBT_base = (workerHeader) => {\r\n    const {\r\n      getLocaleString,\r\n      coloursJSON,\r\n      optionValue_version,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_staircasing,\r\n      optionValue_whereSupportBlocks,\r\n      optionValue_supportBlock,\r\n      optionValue_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      uploadedImage_baseFilename,\r\n      currentMaterialsData,\r\n      mapPreviewWorker_inProgress,\r\n      downloadBlobFile,\r\n      onGetViewOnlineNBT,\r\n    } = this.props;\r\n    if (mapPreviewWorker_inProgress) {\r\n      this.setState({ mapPreviewWorker_onFinishCallback: () => this.getNBT_base(workerHeader) });\r\n      return;\r\n    }\r\n    if (Object.entries(currentMaterialsData.currentSelectedBlocks).every((elt) => elt[1] === \"-1\")) {\r\n      alert(getLocaleString(\"DOWNLOAD/ERROR-NONE-SELECTED\"));\r\n      return;\r\n    }\r\n    this.nbtWorker.terminate();\r\n    this.resetButtonWidths();\r\n    let numberOfSplitsCalculated = 0;\r\n    let zipFile = new JSZip();\r\n    const t0 = performance.now();\r\n    this.nbtWorker = new Worker(NBTWorker);\r\n    this.nbtWorker.onmessage = (e) => {\r\n      switch (e.data.head) {\r\n        case \"PROGRESS_REPORT_CREATE_NBT_JOINED_FOR_VIEW_ONLINE\": {\r\n          this.setState({ buttonWidth_viewOnline: e.data.body });\r\n          break;\r\n        }\r\n        case \"PROGRESS_REPORT_CREATE_NBT_JOINED\": {\r\n          this.setState({ buttonWidth_NBT_Joined: e.data.body });\r\n          break;\r\n        }\r\n        case \"PROGRESS_REPORT_CREATE_NBT_SPLIT\": {\r\n          this.setState({ buttonWidth_NBT_Split: (numberOfSplitsCalculated + e.data.body) / (optionValue_mapSize_x * optionValue_mapSize_y) });\r\n          break;\r\n        }\r\n        case \"PROGRESS_REPORT_CREATE_MAPDAT_SPLIT\": {\r\n          this.setState({ buttonWidth_Mapdat_Split: (numberOfSplitsCalculated + e.data.body) / (optionValue_mapSize_x * optionValue_mapSize_y) });\r\n          break;\r\n        }\r\n        case \"NBT_FOR_VIEW_ONLINE\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created NBT for 'view online' by ${(t1 - t0).toString()}ms`);\r\n          const { NBT_Array } = e.data.body;\r\n          onGetViewOnlineNBT(NBT_Array);\r\n          break;\r\n        }\r\n        case \"NBT_ARRAY\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created NBT by ${(t1 - t0).toString()}ms`);\r\n          numberOfSplitsCalculated++;\r\n          const { NBT_Array, whichMap_x, whichMap_y } = e.data.body;\r\n          const NBT_Array_gzipped = gzip(NBT_Array);\r\n          if (workerHeader === \"CREATE_NBT_SPLIT\") {\r\n            zipFile.file(`${uploadedImage_baseFilename}_${whichMap_x}_${whichMap_y}.nbt`, NBT_Array_gzipped);\r\n            if (numberOfSplitsCalculated === optionValue_mapSize_x * optionValue_mapSize_y) {\r\n              zipFile.generateAsync({ type: \"blob\" }).then((content) => {\r\n                downloadBlobFile(content, `${uploadedImage_baseFilename}.zip`);\r\n              });\r\n            }\r\n          } else {\r\n            const downloadBlob = new Blob([NBT_Array_gzipped], { type: \"application/x-minecraft-level\" });\r\n            downloadBlobFile(downloadBlob, `${uploadedImage_baseFilename}.nbt`);\r\n          }\r\n          break;\r\n        }\r\n        case \"MAPDAT_BYTES\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created Mapdat by ${(t1 - t0).toString()}ms`);\r\n          numberOfSplitsCalculated++;\r\n          const { Mapdat_Bytes, whichMap_x, whichMap_y } = e.data.body;\r\n          const Mapdat_Bytes_gzipped = gzip(Mapdat_Bytes);\r\n          const downloadBlob = new Blob([Mapdat_Bytes_gzipped], { type: \"application/x-minecraft-level\" });\r\n          downloadBlobFile(downloadBlob, optionValue_mapdatFilenameUseId\r\n            ? `map_${(optionValue_mapdatFilenameIdStart + whichMap_y * optionValue_mapSize_x + whichMap_x).toString()}.dat`\r\n            : `${uploadedImage_baseFilename}_${whichMap_x.toString()}_${whichMap_y.toString()}.dat`);\r\n          break;\r\n        }\r\n        case \"MAPDAT_BYTES_ZIP\": {\r\n          const t1 = performance.now();\r\n          console.log(`Created Mapdat by ${(t1 - t0).toString()}ms`);\r\n          numberOfSplitsCalculated++;\r\n          const { Mapdat_Bytes, whichMap_x, whichMap_y } = e.data.body;\r\n          const Mapdat_Bytes_gzipped = gzip(Mapdat_Bytes);\r\n          zipFile.file(\r\n            optionValue_mapdatFilenameUseId\r\n              ? `map_${(optionValue_mapdatFilenameIdStart + whichMap_y * optionValue_mapSize_x + whichMap_x).toString()}.dat`\r\n              : `${uploadedImage_baseFilename}_${whichMap_x.toString()}_${whichMap_y.toString()}.dat`,\r\n            Mapdat_Bytes_gzipped\r\n          );\r\n          if (numberOfSplitsCalculated === optionValue_mapSize_x * optionValue_mapSize_y) {\r\n            zipFile.generateAsync({ type: \"blob\" }).then((content) => {\r\n              downloadBlobFile(content, `${uploadedImage_baseFilename}.zip`);\r\n            });\r\n          }\r\n          break;\r\n        }\r\n        default: {\r\n          throw new Error(\"Unknown worker response header\");\r\n        }\r\n      }\r\n    };\r\n    this.nbtWorker.postMessage({\r\n      head: workerHeader,\r\n      body: {\r\n        coloursJSON: coloursJSON,\r\n        MapModes: MapModes,\r\n        WhereSupportBlocksModes: WhereSupportBlocksModes,\r\n        optionValue_version: optionValue_version,\r\n        optionValue_staircasing: optionValue_staircasing,\r\n        optionValue_whereSupportBlocks: optionValue_whereSupportBlocks,\r\n        optionValue_supportBlock: optionValue_supportBlock,\r\n        pixelsData: currentMaterialsData.pixelsData,\r\n        maps: currentMaterialsData.maps,\r\n        currentSelectedBlocks: currentMaterialsData.currentSelectedBlocks,\r\n      },\r\n    });\r\n  };\r\n\r\n  onViewOnlineClicked = () => {\r\n    this.getNBT_base(\"CREATE_NBT_JOINED_FOR_VIEW_ONLINE\");\r\n  };\r\n\r\n  onGetNBTClicked = () => {\r\n    this.getNBT_base(\"CREATE_NBT_JOINED\");\r\n  };\r\n\r\n  onGetNBTSplitClicked = () => {\r\n    this.getNBT_base(\"CREATE_NBT_SPLIT\");\r\n  };\r\n\r\n  onGetMapdatSplitClicked = () => {\r\n    this.getNBT_base(\"CREATE_MAPDAT_SPLIT\");\r\n  };\r\n\r\n  onGetMapdatSplitZipClicked = () => {\r\n    this.getNBT_base(\"CREATE_MAPDAT_SPLIT_ZIP\");\r\n  };\r\n\r\n  componentDidUpdate_shouldNBTWorkerTerminate(prevProps) {\r\n    const {\r\n      selectedBlocks,\r\n      optionValue_version,\r\n      optionValue_modeNBTOrMapdat,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n      optionValue_staircasing,\r\n      optionValue_whereSupportBlocks,\r\n      optionValue_supportBlock,\r\n      optionValue_transparency,\r\n      optionValue_transparencyTolerance,\r\n      optionValue_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      optionValue_betterColour,\r\n      optionValue_dithering,\r\n      optionValue_preprocessingEnabled,\r\n      preProcessingValue_brightness,\r\n      preProcessingValue_contrast,\r\n      preProcessingValue_saturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      uploadedImage,\r\n    } = this.props;\r\n    return [\r\n      prevProps.selectedBlocks !== selectedBlocks,\r\n      prevProps.optionValue_version !== optionValue_version,\r\n      prevProps.optionValue_modeNBTOrMapdat !== optionValue_modeNBTOrMapdat,\r\n      prevProps.optionValue_mapSize_x !== optionValue_mapSize_x,\r\n      prevProps.optionValue_mapSize_y !== optionValue_mapSize_y,\r\n      prevProps.optionValue_cropImage !== optionValue_cropImage,\r\n      prevProps.optionValue_cropImage_zoom !== optionValue_cropImage_zoom,\r\n      prevProps.optionValue_cropImage_percent_x !== optionValue_cropImage_percent_x,\r\n      prevProps.optionValue_cropImage_percent_y !== optionValue_cropImage_percent_y,\r\n      prevProps.optionValue_staircasing !== optionValue_staircasing,\r\n      prevProps.optionValue_whereSupportBlocks !== optionValue_whereSupportBlocks,\r\n      prevProps.optionValue_supportBlock !== optionValue_supportBlock,\r\n      prevProps.optionValue_transparency !== optionValue_transparency,\r\n      prevProps.optionValue_transparencyTolerance !== optionValue_transparencyTolerance,\r\n      prevProps.optionValue_mapdatFilenameUseId !== optionValue_mapdatFilenameUseId,\r\n      prevProps.optionValue_mapdatFilenameIdStart !== optionValue_mapdatFilenameIdStart,\r\n      prevProps.optionValue_betterColour !== optionValue_betterColour,\r\n      prevProps.optionValue_dithering !== optionValue_dithering,\r\n      prevProps.optionValue_preprocessingEnabled !== optionValue_preprocessingEnabled,\r\n      prevProps.preProcessingValue_brightness !== preProcessingValue_brightness,\r\n      prevProps.preProcessingValue_contrast !== preProcessingValue_contrast,\r\n      prevProps.preProcessingValue_saturation !== preProcessingValue_saturation,\r\n      prevProps.preProcessingValue_backgroundColourSelect !== preProcessingValue_backgroundColourSelect,\r\n      prevProps.preProcessingValue_backgroundColour !== preProcessingValue_backgroundColour,\r\n      prevProps.uploadedImage !== uploadedImage,\r\n    ].some((elt) => elt);\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { mapPreviewWorker_inProgress } = this.props;\r\n    if (this.componentDidUpdate_shouldNBTWorkerTerminate(prevProps)) {\r\n      // reset callback if setting changed\r\n      this.nbtWorker.terminate();\r\n      this.resetButtonWidths();\r\n      this.setState({ mapPreviewWorker_onFinishCallback: null });\r\n    } else if (!mapPreviewWorker_inProgress && this.state.mapPreviewWorker_onFinishCallback !== null) {\r\n      this.state.mapPreviewWorker_onFinishCallback();\r\n      this.setState({ mapPreviewWorker_onFinishCallback: null });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.nbtWorker.terminate();\r\n  }\r\n\r\n  render() {\r\n    const { buttonWidth_viewOnline, buttonWidth_NBT_Joined, buttonWidth_NBT_Split, buttonWidth_Mapdat_Split } = this.state;\r\n    const { getLocaleString, optionValue_modeNBTOrMapdat } = this.props;\r\n    let buttons_mapModeConditional;\r\n    // dummy text used in divs with absolutely positioned children to create correct container height\r\n    if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n      buttons_mapModeConditional = (\r\n        <React.Fragment>\r\n          <Tooltip tooltipText={getLocaleString(\"VIEW-ONLINE/TITLE-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onViewOnlineClicked}>\r\n              <span className=\"greenButton_text_dummy\">{getLocaleString(\"VIEW-ONLINE/TITLE\")}</span>\r\n              <span className=\"greenButton_text\">{getLocaleString(\"VIEW-ONLINE/TITLE\")}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_viewOnline * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetNBTClicked}>\r\n              <span className=\"greenButton_large_text_dummy\">{getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD\")}</span>\r\n              <span className=\"greenButton_large_text\">{getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD\")}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_NBT_Joined * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetNBTSplitClicked}>\r\n              <span className=\"greenButton_text_dummy\">{`${getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT\")} .ZIP`}</span>\r\n              <span className=\"greenButton_text\">{`${getLocaleString(\"DOWNLOAD/NBT-SPECIFIC/DOWNLOAD-SPLIT\")} .ZIP`}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_NBT_Split * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n        </React.Fragment>\r\n      );\r\n    } else {\r\n      buttons_mapModeConditional = (\r\n        <React.Fragment>\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetMapdatSplitClicked}>\r\n              <span className=\"greenButton_large_text_dummy\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")}`}</span>\r\n              <span className=\"greenButton_large_text\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")}`}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_Mapdat_Split * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n          <Tooltip tooltipText={getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD-TT\")}>\r\n            <div className=\"greenButton\" onClick={this.onGetMapdatSplitZipClicked}>\r\n              <span className=\"greenButton_large_text_dummy\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")} .ZIP`}</span>\r\n              <span className=\"greenButton_large_text\">{`${getLocaleString(\"DOWNLOAD/MAPDAT-SPECIFIC/DOWNLOAD\")} .ZIP`}</span>\r\n              <div\r\n                className=\"greenButton_progressDiv\"\r\n                style={{\r\n                  width: `${Math.floor(buttonWidth_Mapdat_Split * 100)}%`,\r\n                }}\r\n              />\r\n            </div>\r\n          </Tooltip>\r\n          <br />\r\n        </React.Fragment>\r\n      );\r\n    }\r\n    const button_donate = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"DONATE/TITLE-TT\")}>\r\n          <div className=\"greenButton\">\r\n            <a style={{ textDecoration: \"none\" }} href=\"./supporters\">\r\n              <span className=\"greenButton_text_dummy\" style={{ backgroundColor: \"#688e6b\", color: \"#333333\" }}>\r\n                {getLocaleString(\"DONATE/TITLE\")}\r\n              </span>\r\n              <span className=\"greenButton_text\" style={{ backgroundColor: \"#688e6b\", color: \"#333333\" }}>\r\n                {getLocaleString(\"DONATE/TITLE\")}\r\n              </span>\r\n            </a>\r\n          </div>\r\n        </Tooltip>\r\n      </React.Fragment>\r\n    );\r\n    const buttonsDiv = (\r\n      <div>\r\n        {buttons_mapModeConditional}\r\n        {button_donate}\r\n      </div>\r\n    );\r\n    return buttonsDiv;\r\n  }\r\n}\r\n\r\nexport default GreenButtons;\r\n","export default __webpack_public_path__ + \"static/media/mapCanvas.e7fd7d3f.jsworker\";","import React, { Component, createRef } from \"react\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\nimport MapCanvasWorker from \"./workers/mapCanvas.jsworker\"; // FINALLY got this to work; .js gets imported as code, anything else as URL\r\n\r\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\r\nimport CropModes from \"./json/cropModes.json\";\r\nimport DitherMethods from \"./json/ditherMethods.json\";\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport WhereSupportBlocksModes from \"./json/whereSupportBlocksModes.json\";\r\n\r\nimport IMG_Null from \"../../images/null.png\";\r\nimport IMG_Textures from \"../../images/textures.png\";\r\nimport IMG_GridOverlay from \"../../images/gridOverlay.png\";\r\n\r\nimport \"./mapPreview.css\";\r\n\r\nclass MapPreview extends Component {\r\n  state = {\r\n    mapPreviewSizeScale: 2,\r\n    workerProgress: 0,\r\n  };\r\n\r\n  mapCanvasWorker = new Worker(MapCanvasWorker);\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef_source = createRef(); // hidden source canvas that at all times contains the uploaded image\r\n    this.canvasRef_display = createRef(); // display canvas that displays to the user, may be pixels, may be image\r\n    this.fileInputRef = createRef();\r\n  }\r\n\r\n  shouldCanvasUpdate_source(prevProps, newProps, prevState, newState) {\r\n    const propChanges = [\r\n      prevProps.coloursJSON === newProps.coloursJSON,\r\n      prevProps.selectedBlocks === newProps.selectedBlocks,\r\n      prevProps.optionValue_mapSize_x === newProps.optionValue_mapSize_x,\r\n      prevProps.optionValue_mapSize_y === newProps.optionValue_mapSize_y,\r\n      prevProps.optionValue_cropImage === newProps.optionValue_cropImage,\r\n      prevProps.optionValue_cropImage_zoom === newProps.optionValue_cropImage_zoom,\r\n      prevProps.optionValue_cropImage_percent_x === newProps.optionValue_cropImage_percent_x,\r\n      prevProps.optionValue_cropImage_percent_y === newProps.optionValue_cropImage_percent_y,\r\n      prevProps.optionValue_staircasing === newProps.optionValue_staircasing,\r\n      prevProps.optionValue_preprocessingEnabled === newProps.optionValue_preprocessingEnabled,\r\n      prevProps.preProcessingValue_brightness === newProps.preProcessingValue_brightness,\r\n      prevProps.preProcessingValue_contrast === newProps.preProcessingValue_contrast,\r\n      prevProps.preProcessingValue_saturation === newProps.preProcessingValue_saturation,\r\n      prevProps.preProcessingValue_backgroundColourSelect === newProps.preProcessingValue_backgroundColourSelect,\r\n      prevProps.preProcessingValue_backgroundColour === newProps.preProcessingValue_backgroundColour,\r\n      prevProps.uploadedImage === newProps.uploadedImage,\r\n    ];\r\n    return (\r\n      newProps.uploadedImage !== null &&\r\n      prevState.workerProgress === newState.workerProgress &&\r\n      !propChanges.every((elt) => {\r\n        return elt === true;\r\n      })\r\n    );\r\n  }\r\n\r\n  shouldCanvasUpdate_display(prevProps, newProps, prevState, newState) {\r\n    // ugly but useful method to determine whether map canvas contents should be redrawn on component update\r\n    const propChanges = [\r\n      prevProps.coloursJSON === newProps.coloursJSON,\r\n      prevProps.selectedBlocks === newProps.selectedBlocks,\r\n      prevProps.optionValue_modeNBTOrMapdat === newProps.optionValue_modeNBTOrMapdat,\r\n      prevProps.optionValue_mapSize_x === newProps.optionValue_mapSize_x,\r\n      prevProps.optionValue_mapSize_y === newProps.optionValue_mapSize_y,\r\n      prevProps.optionValue_cropImage === newProps.optionValue_cropImage,\r\n      prevProps.optionValue_cropImage_zoom === newProps.optionValue_cropImage_zoom,\r\n      prevProps.optionValue_cropImage_percent_x === newProps.optionValue_cropImage_percent_x,\r\n      prevProps.optionValue_cropImage_percent_y === newProps.optionValue_cropImage_percent_y,\r\n      prevProps.optionValue_staircasing === newProps.optionValue_staircasing,\r\n      prevProps.optionValue_whereSupportBlocks === newProps.optionValue_whereSupportBlocks,\r\n      prevProps.optionValue_transparency === newProps.optionValue_transparency,\r\n      prevProps.optionValue_transparencyTolerance === newProps.optionValue_transparencyTolerance,\r\n      prevProps.optionValue_betterColour === newProps.optionValue_betterColour,\r\n      prevProps.optionValue_dithering === newProps.optionValue_dithering,\r\n      prevProps.optionValue_preprocessingEnabled === newProps.optionValue_preprocessingEnabled,\r\n      prevProps.preProcessingValue_brightness === newProps.preProcessingValue_brightness,\r\n      prevProps.preProcessingValue_contrast === newProps.preProcessingValue_contrast,\r\n      prevProps.preProcessingValue_saturation === newProps.preProcessingValue_saturation,\r\n      prevProps.preProcessingValue_backgroundColourSelect === newProps.preProcessingValue_backgroundColourSelect,\r\n      prevProps.preProcessingValue_backgroundColour === newProps.preProcessingValue_backgroundColour,\r\n      prevProps.uploadedImage === newProps.uploadedImage,\r\n    ];\r\n    return (\r\n      newProps.uploadedImage !== null &&\r\n      prevState.workerProgress === newState.workerProgress &&\r\n      !propChanges.every((elt) => {\r\n        return elt === true;\r\n      })\r\n    );\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (this.shouldCanvasUpdate_source(prevProps, this.props, prevState, this.state)) {\r\n      this.updateCanvas_source(); // draw uploaded image on source canvas\r\n    }\r\n    if (this.shouldCanvasUpdate_display(prevProps, this.props, prevState, this.state)) {\r\n      this.updateCanvas_display(); // draw pixelart of image on display canvas\r\n    }\r\n  }\r\n\r\n  closestSmoothColourTo(colourHex) {\r\n    const { coloursJSON, selectedBlocks, optionValue_staircasing } = this.props;\r\n    const rgbGroups_input = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(colourHex);\r\n    const colourRGB_input = [parseInt(rgbGroups_input[1], 16), parseInt(rgbGroups_input[2], 16), parseInt(rgbGroups_input[3], 16)];\r\n    let smallestDistance = 9999999;\r\n    let colourRGB_return = null;\r\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n      if (selectedBlocks[colourSetId] === \"-1\") {\r\n        continue;\r\n      }\r\n      let coloursRGB_colourSet;\r\n      switch (optionValue_staircasing) {\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.OFF.uniqueId:\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId:\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId:\r\n        case MapModes.MAPDAT.staircaseModes.OFF.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.normal];\r\n          break;\r\n        }\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_DARK.uniqueId:\r\n        case MapModes.MAPDAT.staircaseModes.FULL_DARK.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.dark];\r\n          break;\r\n        }\r\n        case MapModes.SCHEMATIC_NBT.staircaseModes.FULL_LIGHT.uniqueId:\r\n        case MapModes.MAPDAT.staircaseModes.FULL_LIGHT.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.light];\r\n          break;\r\n        }\r\n        case MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.unobtainable];\r\n          break;\r\n        }\r\n        case MapModes.MAPDAT.staircaseModes.ON.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.dark, colourSet.tonesRGB.normal, colourSet.tonesRGB.light];\r\n          break;\r\n        }\r\n        case MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId: {\r\n          coloursRGB_colourSet = [colourSet.tonesRGB.dark, colourSet.tonesRGB.normal, colourSet.tonesRGB.light, colourSet.tonesRGB.unobtainable];\r\n          break;\r\n        }\r\n        default: {\r\n          throw new Error(\"Unknown staircasing mode\");\r\n        }\r\n      }\r\n      for (const colourRGB_colourSet of coloursRGB_colourSet) {\r\n        const colourDistance =\r\n          Math.pow(colourRGB_input[0] - colourRGB_colourSet[0], 2) +\r\n          Math.pow(colourRGB_input[1] - colourRGB_colourSet[1], 2) +\r\n          Math.pow(colourRGB_input[2] - colourRGB_colourSet[2], 2);\r\n        if (colourDistance < smallestDistance) {\r\n          smallestDistance = colourDistance;\r\n          colourRGB_return = colourRGB_colourSet;\r\n        }\r\n      }\r\n    }\r\n    const colourHex_return = `#${colourRGB_return[0].toString(16).padStart(2, \"0\")}${colourRGB_return[1].toString(16).padStart(2, \"0\")}${colourRGB_return[2]\r\n      .toString(16)\r\n      .padStart(2, \"0\")}`;\r\n    return colourHex_return;\r\n  }\r\n\r\n  updateCanvas_source() {\r\n    const {\r\n      selectedBlocks,\r\n      optionValue_preprocessingEnabled,\r\n      preProcessingValue_brightness,\r\n      preProcessingValue_contrast,\r\n      preProcessingValue_saturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      uploadedImage,\r\n    } = this.props;\r\n    const {\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n    } = this.props;\r\n    const { canvasRef_source } = this;\r\n    const ctx_source = canvasRef_source.current.getContext(\"2d\");\r\n    ctx_source.imageSmoothingEnabled = true;   // These two options keep the map preview consistent on Chrome(ium). Otherwise the first render after changing\r\n    ctx_source.imageSmoothingQuality = \"high\"; // map x or z size is pixelated to a noticeably lower quality. This is not a solution to the cause but a\r\n                                               // workaround the effect (I do not know exactly why this happens: maybe it is to do with\r\n                                               // anti-fingerprinting). Firefox is unaffected by any of this.\r\n    ctx_source.clearRect(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n\r\n    if (optionValue_preprocessingEnabled) {\r\n      if (preProcessingValue_backgroundColourSelect !== BackgroundColourModes.OFF.uniqueId && /^#?[a-f\\d]{6}$/i.test(preProcessingValue_backgroundColour)) {\r\n        let backgroundColour;\r\n        if (\r\n          preProcessingValue_backgroundColourSelect === BackgroundColourModes.SMOOTH.uniqueId &&\r\n          !Object.values(selectedBlocks).every((selectedBlockId) => selectedBlockId === \"-1\")\r\n        ) {\r\n          backgroundColour = this.closestSmoothColourTo(preProcessingValue_backgroundColour);\r\n        } else {\r\n          backgroundColour = preProcessingValue_backgroundColour;\r\n        }\r\n        ctx_source.filter = \"none\"; // this needs to be present to stop filters affecting background colour\r\n        ctx_source.rect(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n        ctx_source.fillStyle = backgroundColour;\r\n        ctx_source.fill();\r\n      }\r\n      ctx_source.filter = `brightness(${preProcessingValue_brightness}%) contrast(${preProcessingValue_contrast}%) saturate(${preProcessingValue_saturation}%)`;\r\n    } else {\r\n      ctx_source.filter = \"none\";\r\n    }\r\n\r\n    switch (optionValue_cropImage) {\r\n      case CropModes.OFF.uniqueId: {\r\n        ctx_source.drawImage(uploadedImage, 0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n        break;\r\n      }\r\n      case CropModes.CENTER.uniqueId:\r\n      case CropModes.MANUAL.uniqueId: {\r\n        const img_width = uploadedImage.width;\r\n        const img_height = uploadedImage.height;\r\n        let samplingWidth;\r\n        let samplingHeight;\r\n        let samplingOffset_x;\r\n        let samplingOffset_y;\r\n        if (img_width * optionValue_mapSize_y > img_height * optionValue_mapSize_x) {\r\n          // image w/h greater than canvas w/h\r\n          samplingWidth = Math.floor((10 * img_height * optionValue_mapSize_x) / (optionValue_mapSize_y * optionValue_cropImage_zoom));\r\n          // the 10 is because the input is from 10 to 50 in steps of 1; scale down by 10\r\n          samplingHeight = Math.floor((10 * img_height) / optionValue_cropImage_zoom);\r\n          samplingOffset_x = Math.floor((optionValue_cropImage_percent_x * (img_width - samplingWidth)) / 100);\r\n          samplingOffset_y = Math.floor((optionValue_cropImage_percent_y * (img_height - samplingHeight)) / 100);\r\n        } else {\r\n          // image w/h leq canvas w/h\r\n          samplingWidth = Math.floor((10 * img_width) / optionValue_cropImage_zoom);\r\n          samplingHeight = Math.floor((10 * img_width * optionValue_mapSize_y) / (optionValue_mapSize_x * optionValue_cropImage_zoom));\r\n          samplingOffset_x = Math.floor((optionValue_cropImage_percent_x * (img_width - samplingWidth)) / 100);\r\n          samplingOffset_y = Math.floor((optionValue_cropImage_percent_y * (img_height - samplingHeight)) / 100);\r\n        }\r\n        ctx_source.drawImage(\r\n          uploadedImage,\r\n          samplingOffset_x,\r\n          samplingOffset_y,\r\n          samplingWidth,\r\n          samplingHeight,\r\n          0,\r\n          0,\r\n          ctx_source.canvas.width,\r\n          ctx_source.canvas.height\r\n        );\r\n        break;\r\n      }\r\n      default: {\r\n        throw new Error(\"Unknown optionValue_cropImage\");\r\n      }\r\n    }\r\n  }\r\n\r\n  updateCanvas_display() {\r\n    this.mapCanvasWorker.terminate();\r\n    const { canvasRef_source, canvasRef_display } = this;\r\n    const {\r\n      coloursJSON,\r\n      selectedBlocks,\r\n      optionValue_modeNBTOrMapdat,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_staircasing,\r\n      optionValue_whereSupportBlocks,\r\n      optionValue_transparency,\r\n      optionValue_transparencyTolerance,\r\n      optionValue_betterColour,\r\n      optionValue_dithering,\r\n      onGetMapMaterials,\r\n      onMapPreviewWorker_begin,\r\n    } = this.props;\r\n    const ctx_source = canvasRef_source.current.getContext(\"2d\");\r\n    const canvasImageData = ctx_source.getImageData(0, 0, ctx_source.canvas.width, ctx_source.canvas.height);\r\n    const t0 = performance.now();\r\n    this.mapCanvasWorker = new Worker(MapCanvasWorker);\r\n    this.mapCanvasWorker.onmessage = (e) => {\r\n      if (e.data.head === \"PIXELS_MATERIALS_CURRENTSELECTEDBLOCKS\") {\r\n        const t1 = performance.now();\r\n        console.log(`Calculated map preview data in ${(t1 - t0).toString()}ms`);\r\n        const ctx_display = canvasRef_display.current.getContext(\"2d\");\r\n        ctx_display.putImageData(e.data.body.pixels, 0, 0);\r\n        this.setState({ workerProgress: 1 });\r\n        onGetMapMaterials({\r\n          pixelsData: e.data.body.pixels.data,\r\n          maps: e.data.body.maps,\r\n          chunks: e.data.body.chunks,\r\n          currentSelectedBlocks: e.data.body.currentSelectedBlocks,\r\n        });\r\n      } else if (e.data.head === \"PROGRESS_REPORT\") {\r\n        this.setState({ workerProgress: e.data.body });\r\n      }\r\n    };\r\n    onMapPreviewWorker_begin();\r\n    this.mapCanvasWorker.postMessage({\r\n      head: \"PIXELS\",\r\n      body: {\r\n        coloursJSON: coloursJSON,\r\n        MapModes: MapModes,\r\n        WhereSupportBlocksModes: WhereSupportBlocksModes,\r\n        DitherMethods: DitherMethods,\r\n        canvasImageData: canvasImageData,\r\n        selectedBlocks: selectedBlocks,\r\n        optionValue_modeNBTOrMapdat: optionValue_modeNBTOrMapdat,\r\n        optionValue_mapSize_x: optionValue_mapSize_x,\r\n        optionValue_mapSize_y: optionValue_mapSize_y,\r\n        optionValue_staircasing: optionValue_staircasing,\r\n        optionValue_whereSupportBlocks: optionValue_whereSupportBlocks,\r\n        optionValue_transparency: optionValue_transparency,\r\n        optionValue_transparencyTolerance: optionValue_transparencyTolerance,\r\n        optionValue_betterColour: optionValue_betterColour,\r\n        optionValue_dithering: optionValue_dithering,\r\n      },\r\n    });\r\n  }\r\n\r\n  increasePreviewScale = () => {\r\n    this.setState({\r\n      mapPreviewSizeScale: this.state.mapPreviewSizeScale * 1.2,\r\n    });\r\n  };\r\n\r\n  decreasePreviewScale = () => {\r\n    this.setState({\r\n      mapPreviewSizeScale: this.state.mapPreviewSizeScale / 1.2,\r\n    });\r\n  };\r\n\r\n  componentWillUnmount() {\r\n    this.mapCanvasWorker.terminate();\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      getLocaleString,\r\n      optionValue_mapSize_x, // map size in maps\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_showGridOverlay,\r\n      onFileDialogEvent,\r\n      uploadedImage,\r\n    } = this.props;\r\n    const { mapPreviewSizeScale, workerProgress } = this.state;\r\n    return (\r\n      <div className=\"section mapPreviewDiv\">\r\n        <h2>{getLocaleString(\"MAP-PREVIEW/TITLE\")}</h2>\r\n        <input type=\"file\" className=\"imgUpload\" ref={this.fileInputRef} onChange={onFileDialogEvent} />\r\n        <div>\r\n          <span\r\n            className=\"gridOverlay\"\r\n            style={{\r\n              backgroundImage: `url(${IMG_GridOverlay})`,\r\n              display: optionValue_showGridOverlay ? \"block\" : \"none\",\r\n              width: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_x).toString()}px`,\r\n              height: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_y).toString()}px`,\r\n              backgroundSize: `${(mapPreviewSizeScale * 128).toString()}px`,\r\n            }}\r\n          />\r\n          <canvas\r\n            className=\"mapCanvas\"\r\n            width={128 * optionValue_mapSize_x}\r\n            height={128 * optionValue_mapSize_y}\r\n            ref={this.canvasRef_display}\r\n            style={{\r\n              width: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_x).toString()}px`,\r\n              height: `${(mapPreviewSizeScale * 128 * optionValue_mapSize_y).toString()}px`,\r\n            }}\r\n            onClick={() => this.fileInputRef.current.click()}\r\n          />\r\n          <canvas className=\"displayNone\" width={128 * optionValue_mapSize_x} height={128 * optionValue_mapSize_y} ref={this.canvasRef_source}></canvas>\r\n        </div>\r\n        <div className=\"mapResolutionAndZoom\">\r\n          <div>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/BEST-RESOLUTION-TT\")}>\r\n              <small>{`${(128 * optionValue_mapSize_x).toString()}x${(128 * optionValue_mapSize_y).toString()}`}</small>\r\n            </Tooltip>{\" \"}\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/ASPECT-RATIO-MISMATCH-TT\")}>\r\n              <small\r\n                className=\"mapResWarning\"\r\n                style={{\r\n                  display:\r\n                    uploadedImage === null || uploadedImage.height * optionValue_mapSize_x === uploadedImage.width * optionValue_mapSize_y ? \"none\" : \"inline\",\r\n                  color: optionValue_cropImage === CropModes.OFF.uniqueId ? \"red\" : \"orange\",\r\n                }}\r\n              >\r\n                {uploadedImage === null ? null : `${uploadedImage.width.toString()}x${uploadedImage.height.toString()}`}\r\n              </small>\r\n            </Tooltip>\r\n          </div>\r\n          <div>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/SCALE-PLUS-TT\")}>\r\n              <img\r\n                alt=\"+\"\r\n                className=\"sizeButton\"\r\n                src={IMG_Null}\r\n                style={{\r\n                  backgroundImage: `url(${IMG_Textures})`,\r\n                  backgroundPositionX: \"-96px\",\r\n                  backgroundPositionY: \"-2048px\",\r\n                }}\r\n                onClick={this.increasePreviewScale}\r\n              />\r\n            </Tooltip>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-PREVIEW/SCALE-MINUS-TT\")}>\r\n              <img\r\n                alt=\"-\"\r\n                className=\"sizeButton\"\r\n                src={IMG_Null}\r\n                style={{\r\n                  backgroundImage: `url(${IMG_Textures})`,\r\n                  backgroundPositionX: \"-128px\",\r\n                  backgroundPositionY: \"-2048px\",\r\n                }}\r\n                onClick={this.decreasePreviewScale}\r\n              />\r\n            </Tooltip>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"progress\"\r\n          style={\r\n            [0, 1].includes(workerProgress)\r\n              ? {\r\n                  display: \"unset\",\r\n                  visibility: \"hidden\",\r\n                }\r\n              : { display: \"block\" }\r\n          }\r\n        >\r\n          <span className=\"progressText\">{`${Math.floor(workerProgress * 100)}%`}</span>\r\n          <div\r\n            className=\"progressDiv\"\r\n            style={{\r\n              width: `${Math.floor(workerProgress * 100)}%`,\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MapPreview;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAPiSURBVHhe7d0xjtwwEABB0h+Xf04fZYWMeUFXAbMglDBSYxXNWGv93ozx9/j81rjf/afnt+YX7x8/v3v+/JyAKAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAsLlXFH9nIGKO9byH0+7wa2M/vPtPz29N+P795u/xCQBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBhc68o/s5AxBzreQ+n3eHXxn5495+e35rw/fvN3+MTAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMLmXlH8nYGIOdbzHk67w6+N/fDuPz2/NeH795u/xycAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhAkAhM29ovg7AxFzrOc9nHaHXxv74d1/en5rwvfvN3+PTwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIm3tF8XcGIuZYz3s47Q6/NvbDu//0/NaE799v/h6fABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABA294ri7wxEzLGe93DaHX5t7Id3/+n5rQnfv9/8PT4BIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIGzuFcXfGYiYYz3v4bQ7/NrYD+/+0/NbE75/v/l7fAJAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABAmABA2Py/JRQo8g8Assb4BzyTnrLVu1KjAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\r\n\r\nimport BlockImage from \"../blockImage\";\r\n\r\nimport \"./autoCompleteInputBlockToAdd.css\";\r\n\r\nclass AutoCompleteInputBlockToAdd extends Component {\r\n  state = { suggestionSelected: true };\r\n\r\n  getRelevantSuggestions = () => {\r\n    const { coloursJSON, value, optionValue_version } = this.props;\r\n    let suggestions_prefix = [];\r\n    let suggestions_includes = [];\r\n\r\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n      for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n        if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n          continue;\r\n        }\r\n        let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n        if (typeof blockNBTData === \"string\") {\r\n          // this is of the form eg \"&1.12.2\"\r\n          blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n        }\r\n        if (!block.supportBlockMandatory) {\r\n          // no gravity affected blocks etc for support / noobline\r\n          if (blockNBTData.NBTName.startsWith(value)) {\r\n            suggestions_prefix.push({\r\n              blockName: blockNBTData.NBTName,\r\n              colourSetId,\r\n              blockId,\r\n            });\r\n          } else if (blockNBTData.NBTName.includes(value)) {\r\n            suggestions_includes.push({\r\n              blockName: blockNBTData.NBTName,\r\n              colourSetId,\r\n              blockId,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return suggestions_prefix.concat(suggestions_includes);\r\n  };\r\n\r\n  handleTextChange = (e) => {\r\n    const newValue = e.target.value.replace(\" \", \"_\").toLowerCase();\r\n    this.props.setValue(newValue);\r\n  };\r\n\r\n  onSuggestionClicked = (suggestion) => {\r\n    this.props.setValue(suggestion.blockName);\r\n    this.setState({ suggestionSelected: true });\r\n  };\r\n\r\n  onFocus = () => {\r\n    this.setState({ suggestionSelected: false });\r\n  };\r\n\r\n  render() {\r\n    const { coloursJSON, value } = this.props;\r\n    const { suggestionSelected } = this.state;\r\n\r\n    const relevantSuggestions = this.getRelevantSuggestions();\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <input type=\"text\" value={value} onChange={this.handleTextChange} onFocus={this.onFocus} onClick={this.onFocus} />\r\n        <table className={\"blockToAddSuggestions\"} style={{ display: suggestionSelected || relevantSuggestions.length === 0 ? \"none\" : \"table\" }}>\r\n          <tbody>\r\n            {relevantSuggestions.map((suggestion) => (\r\n              <tr\r\n                className={\"blockToAddSuggestion\"}\r\n                key={`${suggestion.colourSetId}$_${suggestion.blockId}_${suggestion.blockName}`}\r\n                onClick={() => this.onSuggestionClicked(suggestion)}\r\n              >\r\n                <th>\r\n                  <BlockImage coloursJSON={coloursJSON} colourSetId={suggestion.colourSetId} blockId={suggestion.blockId} />\r\n                </th>\r\n                <th>{suggestion.blockName}</th>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AutoCompleteInputBlockToAdd;\r\n","import { Component } from \"react\";\r\n\r\nimport \"./bufferedNumberInput.css\";\r\n\r\nclass BufferedNumberInput extends Component {\r\n  state = { buffer: null };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.buffer = props.value;\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { value } = this.props;\r\n    if (prevProps.value !== value) {\r\n      this.setState({ buffer: value });\r\n    }\r\n  }\r\n\r\n  onInputChange = (e) => {\r\n    const { validators, onValidInput } = this.props;\r\n    const newValue_buffer = e.target.value;\r\n    const newValue_int = parseInt(newValue_buffer);\r\n    this.setState({ buffer: newValue_buffer }, () => {\r\n      if (\r\n        validators.every((validator) => {\r\n          return validator(newValue_int);\r\n        })\r\n      ) {\r\n        onValidInput(newValue_int);\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { min, max, step, style, disabled } = this.props;\r\n    const { buffer } = this.state;\r\n    return <input type=\"number\" min={min} max={max} step={step} value={buffer} onChange={this.onInputChange} disabled={disabled} style={style} />;\r\n  }\r\n}\r\n\r\nexport default BufferedNumberInput;\r\n","import React, { Component } from \"react\";\r\n\r\nimport AutoCompleteInputBlockToAdd from \"./autoCompleteInputBlockToAdd/autoCompleteInputBlockToAdd\";\r\n\r\nimport BufferedNumberInput from \"./bufferedNumberInput/bufferedNumberInput\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\n\r\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\r\nimport CropModes from \"./json/cropModes.json\";\r\nimport DitherMethods from \"./json/ditherMethods.json\";\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport SupportedVersions from \"./json/supportedVersions.json\";\r\nimport WhereSupportBlocksModes from \"./json/whereSupportBlocksModes.json\";\r\n\r\nimport \"./mapSettings.css\";\r\n\r\nclass MapSettings extends Component {\r\n  render() {\r\n    const {\r\n      getLocaleString,\r\n      coloursJSON,\r\n      optionValue_version,\r\n      onOptionChange_version,\r\n      optionValue_mapSize_x,\r\n      onOptionChange_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      onOptionChange_mapSize_y,\r\n      optionValue_modeNBTOrMapdat,\r\n      onOptionChange_modeNBTOrMapdat,\r\n      optionValue_cropImage,\r\n      onOptionChange_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      onOptionChange_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      onOptionChange_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n      onOptionChange_cropImage_percent_y,\r\n      optionValue_showGridOverlay,\r\n      onOptionChange_showGridOverlay,\r\n      optionValue_staircasing,\r\n      onOptionChange_staircasing,\r\n      optionValue_whereSupportBlocks,\r\n      onOptionChange_WhereSupportBlocks,\r\n      optionValue_supportBlock,\r\n      setOption_SupportBlock,\r\n      optionValue_transparency,\r\n      onOptionChange_transparency,\r\n      optionValue_transparencyTolerance,\r\n      onOptionChange_transparencyTolerance,\r\n      optionValue_mapdatFilenameUseId,\r\n      onOptionChange_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      onOptionChange_mapdatFilenameIdStart,\r\n      optionValue_betterColour,\r\n      onOptionChange_BetterColour,\r\n      optionValue_dithering,\r\n      onOptionChange_dithering,\r\n      optionValue_preprocessingEnabled,\r\n      onOptionChange_PreProcessingEnabled,\r\n      preProcessingValue_brightness,\r\n      onOptionChange_PreProcessingBrightness,\r\n      preProcessingValue_contrast,\r\n      onOptionChange_PreProcessingContrast,\r\n      preProcessingValue_saturation,\r\n      onOptionChange_PreProcessingSaturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      onOptionChange_PreProcessingBackgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      onOptionChange_PreProcessingBackgroundColour,\r\n      optionValue_extras_moreStaircasingOptions,\r\n      onOptionChange_extras_moreStaircasingOptions,\r\n    } = this.props;\r\n    const setting_mode = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MODE-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/MODE\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select onChange={onOptionChange_modeNBTOrMapdat} value={optionValue_modeNBTOrMapdat}>\r\n          {Object.values(MapModes).map((mapMode) => (\r\n            <option key={mapMode.uniqueId} value={mapMode.uniqueId}>\r\n              {mapMode.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_version = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/VERSION-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/VERSION\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select value={optionValue_version.MCVersion} onChange={onOptionChange_version}>\r\n          {Object.values(SupportedVersions).map((supportedVersion) => (\r\n            <option key={supportedVersion.MCVersion} value={supportedVersion.MCVersion}>\r\n              {supportedVersion.MCVersion}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_mapSize = (\r\n      <React.Fragment>\r\n        <b>\r\n          {getLocaleString(\"MAP-SETTINGS/MAP-SIZE\")}\r\n          {\":\"}\r\n        </b>{\" \"}\r\n        <BufferedNumberInput\r\n          min=\"1\"\r\n          max={null}\r\n          step=\"1\"\r\n          value={optionValue_mapSize_x}\r\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\r\n          onValidInput={onOptionChange_mapSize_x}\r\n          style={{ width: \"2em\" }}\r\n        />\r\n        x\r\n        <BufferedNumberInput\r\n          min=\"1\"\r\n          max={null}\r\n          step=\"1\"\r\n          value={optionValue_mapSize_y}\r\n          validators={[(t) => !isNaN(t), (t) => t > 0]}\r\n          onValidInput={onOptionChange_mapSize_y}\r\n          style={{ width: \"2em\" }}\r\n        />\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    let setting_crop = (\r\n      <tr>\r\n        <th>\r\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/CROP/TITLE-TT\")}>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/CROP/TITLE\")}\r\n              {\":\"}\r\n            </b>\r\n          </Tooltip>{\" \"}\r\n        </th>\r\n        <td>\r\n          <select onChange={onOptionChange_cropImage} value={optionValue_cropImage}>\r\n            {Object.values(CropModes).map((cropMode) => (\r\n              <option key={cropMode.uniqueId} value={cropMode.uniqueId}>\r\n                {getLocaleString(cropMode.localeKey)}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </td>\r\n        <td />\r\n      </tr>\r\n    );\r\n    let setting_crop_zoom = null;\r\n    let setting_crop_percent_x = null;\r\n    let setting_crop_percent_y = null;\r\n    if (optionValue_cropImage === CropModes.MANUAL.uniqueId) {\r\n      setting_crop_zoom = (\r\n        <tr>\r\n          <th>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/CROP/ZOOM\")}\r\n              {\":\"}\r\n            </b>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input\r\n              type=\"range\"\r\n              min=\"10\"\r\n              max=\"50\"\r\n              value={optionValue_cropImage_zoom}\r\n              onChange={(e) => onOptionChange_cropImage_zoom(parseInt(e.target.value))}\r\n            />\r\n          </td>\r\n          <td />\r\n        </tr>\r\n      );\r\n      setting_crop_percent_x = (\r\n        <tr>\r\n          <th>\r\n            <b>{\"X:\"}</b>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"100\"\r\n              value={optionValue_cropImage_percent_x}\r\n              onChange={(e) => onOptionChange_cropImage_percent_x(parseInt(e.target.value))}\r\n            />\r\n          </td>\r\n          <td>\r\n            <BufferedNumberInput\r\n              min=\"0\"\r\n              max=\"100\"\r\n              step=\"1\"\r\n              value={optionValue_cropImage_percent_x}\r\n              validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 100]}\r\n              onValidInput={onOptionChange_cropImage_percent_x}\r\n              style={{ width: \"3em\" }}\r\n            />\r\n          </td>\r\n        </tr>\r\n      );\r\n      setting_crop_percent_y = (\r\n        <tr>\r\n          <th>\r\n            <b>{\"Y:\"}</b>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"100\"\r\n              value={optionValue_cropImage_percent_y}\r\n              onChange={(e) => onOptionChange_cropImage_percent_y(parseInt(e.target.value))}\r\n            />\r\n          </td>\r\n          <td>\r\n            <BufferedNumberInput\r\n              min=\"0\"\r\n              max=\"100\"\r\n              step=\"1\"\r\n              value={optionValue_cropImage_percent_y}\r\n              validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 100]}\r\n              onValidInput={onOptionChange_cropImage_percent_y}\r\n              style={{ width: \"3em\" }}\r\n            />\r\n          </td>\r\n        </tr>\r\n      );\r\n    }\r\n    let settingGroup_cropping = (\r\n      <div className={optionValue_cropImage === CropModes.MANUAL.uniqueId ? \"settingsGroup\" : null}>\r\n        <table>\r\n          <tbody>\r\n            {setting_crop}\r\n            {setting_crop_zoom}\r\n            {setting_crop_percent_x}\r\n            {setting_crop_percent_y}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n    const setting_grid = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/GRID-OVERLAY-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/GRID-OVERLAY\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <input type=\"checkbox\" checked={optionValue_showGridOverlay} onChange={onOptionChange_showGridOverlay} />\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_staircasing = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/3D/TITLE-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/3D/TITLE\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select onChange={onOptionChange_staircasing} value={optionValue_staircasing}>\r\n          {Object.values(\r\n            optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId ? MapModes.SCHEMATIC_NBT.staircaseModes : MapModes.MAPDAT.staircaseModes\r\n          )\r\n            .filter((staircaseMode) => optionValue_extras_moreStaircasingOptions || !staircaseMode.extra)\r\n            .map((staircaseMode) => (\r\n              <option key={staircaseMode.uniqueId} value={staircaseMode.uniqueId}>\r\n                {getLocaleString(staircaseMode.localeKey)}\r\n              </option>\r\n            ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    let settings_mapModeConditional;\r\n    if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n      settings_mapModeConditional = (\r\n        <React.Fragment>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/NBT-SPECIFIC/WHERE-SUPPORT-BLOCKS/TITLE\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n          <select value={optionValue_whereSupportBlocks} onChange={onOptionChange_WhereSupportBlocks}>\r\n            {Object.values(WhereSupportBlocksModes).map((whereSupportBlocksMode) => (\r\n              <option key={whereSupportBlocksMode.uniqueId} value={whereSupportBlocksMode.uniqueId}>\r\n                {getLocaleString(whereSupportBlocksMode.localeKey)}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <br />\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/NBT-SPECIFIC/SUPPORT-BLOCK-TO-ADD\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n          <AutoCompleteInputBlockToAdd\r\n            coloursJSON={coloursJSON}\r\n            value={optionValue_supportBlock}\r\n            setValue={setOption_SupportBlock}\r\n            optionValue_version={optionValue_version}\r\n          />\r\n          <br />\r\n        </React.Fragment>\r\n      );\r\n    } else {\r\n      let setting_transparency = (\r\n        <tr>\r\n          <th>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY-TT\")}>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY\")}\r\n                {\":\"}\r\n              </b>\r\n            </Tooltip>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input type=\"checkbox\" checked={optionValue_transparency} onChange={onOptionChange_transparency} />\r\n          </td>\r\n          <td />\r\n        </tr>\r\n      );\r\n      let setting_transparencyTolerance = null;\r\n      if (optionValue_transparency) {\r\n        setting_transparencyTolerance = (\r\n          <tr>\r\n            <th>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/TRANSPARENCY-TOLERANCE\")}\r\n                {\":\"}\r\n              </b>{\" \"}\r\n            </th>\r\n            <td>\r\n              <input\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"256\"\r\n                value={optionValue_transparencyTolerance}\r\n                onChange={(e) => onOptionChange_transparencyTolerance(parseInt(e.target.value))}\r\n              />\r\n            </td>\r\n            <td>\r\n              <BufferedNumberInput\r\n                min=\"0\"\r\n                max=\"256\"\r\n                step=\"1\"\r\n                value={optionValue_transparencyTolerance}\r\n                validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 256]}\r\n                onValidInput={onOptionChange_transparencyTolerance}\r\n                style={{ width: \"3em\" }}\r\n              />\r\n            </td>\r\n          </tr>\r\n        );\r\n      }\r\n      let settingGroup_transparency = (\r\n        <div className={optionValue_transparency ? \"settingsGroup\" : null}>\r\n          <table>\r\n            <tbody>\r\n              {setting_transparency}\r\n              {setting_transparencyTolerance}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      );\r\n      let setting_mapdatFilenameUseId = (\r\n        <tr>\r\n          <th>\r\n            <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-USE-ID-TT\")}>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-USE-ID\")}\r\n                {\":\"}\r\n              </b>\r\n            </Tooltip>{\" \"}\r\n          </th>\r\n          <td>\r\n            <input type=\"checkbox\" checked={optionValue_mapdatFilenameUseId} onChange={onOptionChange_mapdatFilenameUseId} />\r\n          </td>\r\n          <td />\r\n          <td />\r\n        </tr>\r\n      );\r\n      let setting_mapdatFilenameIdStart = null;\r\n      if (optionValue_mapdatFilenameUseId) {\r\n        setting_mapdatFilenameIdStart = (\r\n          <tr>\r\n            <th>\r\n              <b>\r\n                {getLocaleString(\"MAP-SETTINGS/MAPDAT-SPECIFIC/MAPDAT-FILENAME-ID-RANGE\")}\r\n                {\":\"}\r\n              </b>{\" \"}\r\n            </th>\r\n            <td>\r\n              <BufferedNumberInput\r\n                min=\"0\"\r\n                step=\"1\"\r\n                value={optionValue_mapdatFilenameIdStart}\r\n                validators={[(t) => !isNaN(t), (t) => t >= 0]}\r\n                onValidInput={onOptionChange_mapdatFilenameIdStart}\r\n                style={{ width: \"3em\" }}\r\n              />\r\n            </td>\r\n            <td>\r\n              <b>{\"-\"}</b>\r\n            </td>\r\n            <td>\r\n              <BufferedNumberInput\r\n                value={-1 + optionValue_mapdatFilenameIdStart + optionValue_mapSize_x * optionValue_mapSize_y}\r\n                disabled={true}\r\n                style={{ width: \"3em\" }}\r\n              />\r\n            </td>\r\n          </tr>\r\n        );\r\n      }\r\n      let settingGroup_mapdatFilename = (\r\n        <div className={optionValue_mapdatFilenameUseId ? \"settingsGroup\" : null}>\r\n          <table>\r\n            <tbody>\r\n              {setting_mapdatFilenameUseId}\r\n              {setting_mapdatFilenameIdStart}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      );\r\n      settings_mapModeConditional = (\r\n        <React.Fragment>\r\n          {settingGroup_transparency}\r\n          {settingGroup_mapdatFilename}\r\n        </React.Fragment>\r\n      );\r\n    }\r\n    const setting_betterColour = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/BETTER-COLOUR-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/BETTER-COLOUR\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <input type=\"checkbox\" checked={optionValue_betterColour} onChange={onOptionChange_BetterColour} />\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_dithering = (\r\n      <React.Fragment>\r\n        <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/DITHERING/TITLE-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/DITHERING/TITLE\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <select value={optionValue_dithering} onChange={onOptionChange_dithering}>\r\n          {Object.keys(DitherMethods).map((ditherMethodKey) => (\r\n            <option key={DitherMethods[ditherMethodKey][\"uniqueId\"]} value={DitherMethods[ditherMethodKey][\"uniqueId\"]}>\r\n              {\"localeKey\" in DitherMethods[ditherMethodKey]\r\n                ? getLocaleString(DitherMethods[ditherMethodKey][\"localeKey\"])\r\n                : DitherMethods[ditherMethodKey][\"name\"]}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <br />\r\n      </React.Fragment>\r\n    );\r\n    const setting_preprocessing = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/ENABLE\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n          <input type=\"checkbox\" checked={optionValue_preprocessingEnabled} onChange={onOptionChange_PreProcessingEnabled} />\r\n        </th>\r\n        <td />\r\n        <td />\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_brightness = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BRIGHTNESS\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={preProcessingValue_brightness}\r\n            onChange={(e) => onOptionChange_PreProcessingBrightness(parseInt(e.target.value))}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={preProcessingValue_brightness}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_PreProcessingBrightness}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_contrast = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/CONTRAST\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={preProcessingValue_contrast}\r\n            onChange={(e) => onOptionChange_PreProcessingContrast(parseInt(parseInt(e.target.value)))}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={preProcessingValue_contrast}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_PreProcessingContrast}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_saturation = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/SATURATION\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"200\"\r\n            value={preProcessingValue_saturation}\r\n            onChange={(e) => onOptionChange_PreProcessingSaturation(parseInt(e.target.value))}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          />\r\n        </td>\r\n        <td>\r\n          <BufferedNumberInput\r\n            min=\"0\"\r\n            max=\"200\"\r\n            step=\"1\"\r\n            value={preProcessingValue_saturation}\r\n            validators={[(t) => !isNaN(t), (t) => t >= 0, (t) => t <= 200]}\r\n            onValidInput={onOptionChange_PreProcessingSaturation}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n            style={{ width: \"3em\" }}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_background = (\r\n      <tr>\r\n        <th>\r\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND/TITLE-TT\")}>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND/TITLE\")}\r\n              {\":\"}\r\n            </b>\r\n          </Tooltip>{\" \"}\r\n        </th>\r\n        <td>\r\n          <select\r\n            onChange={onOptionChange_PreProcessingBackgroundColourSelect}\r\n            value={preProcessingValue_backgroundColourSelect}\r\n            disabled={!optionValue_preprocessingEnabled}\r\n          >\r\n            {Object.values(BackgroundColourModes).map((backgroundColourMode) => (\r\n              <option key={backgroundColourMode.uniqueId} value={backgroundColourMode.uniqueId}>\r\n                {getLocaleString(backgroundColourMode.localeKey)}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </td>\r\n      </tr>\r\n    );\r\n    const setting_preprocessing_backgroundColour = (\r\n      <tr>\r\n        <th>\r\n          <b>\r\n            {getLocaleString(\"MAP-SETTINGS/PREPROCESSING/BACKGROUND-COLOUR\")}\r\n            {\":\"}\r\n          </b>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input\r\n            type=\"color\"\r\n            value={preProcessingValue_backgroundColour}\r\n            onChange={onOptionChange_PreProcessingBackgroundColour}\r\n            disabled={!optionValue_preprocessingEnabled || preProcessingValue_backgroundColourSelect === BackgroundColourModes.OFF.uniqueId}\r\n          />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const settingGroup_preprocessing = (\r\n      <React.Fragment>\r\n        <details>\r\n          <summary>{getLocaleString(\"MAP-SETTINGS/PREPROCESSING/TITLE\")}</summary>\r\n          <div className={optionValue_preprocessingEnabled ? \"settingsGroup\" : null}>\r\n            <table>\r\n              <tbody>\r\n                {setting_preprocessing}\r\n                {setting_preprocessing_brightness}\r\n                {setting_preprocessing_contrast}\r\n                {setting_preprocessing_saturation}\r\n                {setting_preprocessing_background}\r\n                {setting_preprocessing_backgroundColour}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </details>\r\n      </React.Fragment>\r\n    );\r\n    const setting_extras_moreStaircasingOptions = (\r\n      <tr>\r\n        <th>\r\n          <Tooltip tooltipText={getLocaleString(\"MAP-SETTINGS/EXTRAS/MORE-STAIRCASING-OPTIONS-TT\")}>\r\n            <b>\r\n              {getLocaleString(\"MAP-SETTINGS/EXTRAS/MORE-STAIRCASING-OPTIONS\")}\r\n              {\":\"}\r\n            </b>\r\n          </Tooltip>{\" \"}\r\n        </th>\r\n        <td>\r\n          <input type=\"checkbox\" checked={optionValue_extras_moreStaircasingOptions} onChange={onOptionChange_extras_moreStaircasingOptions} />\r\n        </td>\r\n      </tr>\r\n    );\r\n    const settingGroup_extras = (\r\n      <React.Fragment>\r\n        <details>\r\n          <summary>{getLocaleString(\"MAP-SETTINGS/EXTRAS/TITLE\")}</summary>\r\n          <table>\r\n            <tbody>{setting_extras_moreStaircasingOptions}</tbody>\r\n          </table>\r\n        </details>\r\n      </React.Fragment>\r\n    );\r\n    const settingsDiv = (\r\n      <div className=\"section settingsDiv\">\r\n        <h2>{getLocaleString(\"MAP-SETTINGS/TITLE\")}</h2>\r\n        {setting_mode}\r\n        {setting_version}\r\n        {setting_mapSize}\r\n        {settingGroup_cropping}\r\n        {setting_grid}\r\n        {setting_staircasing}\r\n        {settings_mapModeConditional}\r\n        {setting_betterColour}\r\n        {setting_dithering}\r\n        {settingGroup_preprocessing}\r\n        {settingGroup_extras}\r\n      </div>\r\n    );\r\n    return settingsDiv;\r\n  }\r\n}\r\n\r\nexport default MapSettings;\r\n","import React, { Component } from \"react\";\r\n\r\nimport Tooltip from \"../tooltip\";\r\n\r\nimport BlockImage from \"./blockImage\";\r\n\r\nimport \"./materials.css\";\r\n\r\nclass Materials extends Component {\r\n  state = { onlyMaxPerSplit: false,\r\n            chunksToDisplay: [],\r\n            rowInput: 0,\r\n            columnInput: 0,\r\n            allMaterials: true,\r\n          };\r\n\r\n  onOnlyMaxPerSplitChange = () => {\r\n    this.setState((currentState) => ({\r\n      // nb this method of passing currentState instead of using this.state... is prefered; TODO neaten up controller uses\r\n      onlyMaxPerSplit: !currentState.onlyMaxPerSplit,\r\n    }));\r\n  };\r\n\r\n  onDisplayAllChange = () => {\r\n    this.setState((currentState) => ({\r\n      allMaterials: !currentState.allMaterials,\r\n    }));\r\n  };\r\n\r\n  onResetList = () => {\r\n    this.setState((currentState) => ({\r\n      chunksToDisplay: [],\r\n    }));\r\n  }\r\n\r\n  onAddChunkToList = () => {\r\n    const { rowInput, columnInput, chunksToDisplay } = this.state;\r\n    let chunkCoords = { row: rowInput, column: columnInput };\r\n    let updatedChunksToDisplay = chunksToDisplay;\r\n    if(!this.chunkExists(chunkCoords)) {\r\n      chunksToDisplay.push(chunkCoords);\r\n    }\r\n    this.setState((currentState) => ({\r\n      chunksToDisplay: updatedChunksToDisplay,\r\n    }));\r\n  }\r\n\r\n  onRowChanged = (e) => {\r\n    this.setState((currentState) => ({\r\n      rowInput: parseInt(e.target.value),\r\n    }));\r\n  }\r\n\r\n  onColumnChanged = (e) => {\r\n    this.setState((currentState) => ({\r\n      columnInput: parseInt(e.target.value),\r\n    }));\r\n  }\r\n\r\n  chunkExists(newChunkCoords) {\r\n  const { chunksToDisplay } = this.state;\r\n    for (const existingChunkCoords of chunksToDisplay) {\r\n      if((existingChunkCoords.row === newChunkCoords.row) && (existingChunkCoords.column === newChunkCoords.column)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  displayChunkMaterials = () => {   \r\n    const { chunksToDisplay } = this.state;\r\n    let materialsTotal = this.getNewMaterialsList();\r\n    for (const chunkCoords of chunksToDisplay) {\r\n      this.addChunk(materialsTotal, chunkCoords.row, chunkCoords.column);\r\n    }\r\n    return materialsTotal;\r\n  }\r\n\r\n  displayAllMaterials = () => {\r\n    const { currentMaterialsData } = this.props;\r\n    let materialsTotal = this.getNewMaterialsList();\r\n    let curRow = 0, curCol = 0;\r\n    for (const rowOfChunks of currentMaterialsData.chunks) {\r\n      curRow++;\r\n      for (const chunk of rowOfChunks) {\r\n        curCol++;\r\n        this.addChunk(materialsTotal, curRow, curCol);\r\n      }\r\n      curCol = 0;\r\n    }\r\n    return materialsTotal;\r\n  }\r\n\r\n  addChunk (destination, row, col) {\r\n    const { currentMaterialsData } = this.props;\r\n    let rowNum = 0, colNum = 0;\r\n    for (const rowOfChunks of currentMaterialsData.chunks) {\r\n      //rowNum++;\r\n      if(++rowNum !== row) continue;\r\n      for (const chunk of rowOfChunks) {\r\n        //colNum++;\r\n        if(++colNum !== col) continue;\r\n        this.addSupportBlockCount(destination, chunk);\r\n        this.addMaterialsCount(destination, chunk);\r\n      }\r\n      colNum = 0;\r\n    }\r\n  }\r\n\r\n  addSupportBlockCount(destination, chunk) {\r\n    const { onlyMaxPerSplit } = this.state;\r\n    if (onlyMaxPerSplit) {\r\n      destination.supportBlockCount = Math.max(destination.supportBlockCount, chunk.supportBlockCount);\r\n    } \r\n    else {\r\n      destination.supportBlockCount += chunk.supportBlockCount;\r\n    }\r\n  }\r\n\r\n  addMaterialsCount(destination, chunk) {\r\n    const { onlyMaxPerSplit } = this.state;\r\n    for (const [colourSetId, materialCount] of Object.entries(chunk.materials)) {\r\n      if (onlyMaxPerSplit) {\r\n        destination.materials[colourSetId] = Math.max(destination.materials[colourSetId], materialCount);\r\n      } \r\n      else {\r\n        destination.materials[colourSetId] += materialCount;\r\n      }\r\n    }\r\n  }\r\n\r\n  getSortedNonZeroMaterials(materialsList) {\r\n    return Object.entries(materialsList)\r\n      .filter(([_, value]) => value !== 0)\r\n      .sort((first, second) => {\r\n       return second[1] - first[1];\r\n    });\r\n  }\r\n\r\n  getNewMaterialsList() {\r\n    const { coloursJSON } = this.props;\r\n    let newMaterialsList = { materials: {}, supportBlockCount: 0 };\r\n    for (const colourSetId of Object.keys(coloursJSON)) {\r\n      newMaterialsList.materials[colourSetId] = 0;\r\n    }\r\n    return newMaterialsList;\r\n  }\r\n\r\n  formatMaterialCount = (count) => {\r\n    const numberOfStacks = Math.floor(count / 64);\r\n    const remainder = count % 64;\r\n    const numberOfShulkers = count / 1728;\r\n    return `${count.toString()}${\r\n      numberOfStacks !== 0\r\n        ? ` (${numberOfStacks.toString()}x64${remainder !== 0 ? ` + ${remainder.toString()}` : \"\"}${\r\n            numberOfShulkers >= 1 ? `, ${numberOfShulkers.toFixed(2)} SB` : \"\"\r\n          })`\r\n        : \"\"\r\n    }`;\r\n  };\r\n\r\n  colourSetIdAndBlockIdFromNBTName(blockName) {\r\n    const { coloursJSON, optionValue_version } = this.props;\r\n    for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n      for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n        if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n          continue;\r\n        }\r\n        let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n        if (typeof blockNBTData === \"string\") {\r\n          // this is of the form eg \"&1.12.2\"\r\n          blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n        }\r\n        if (\r\n          Object.keys(blockNBTData.NBTArgs).length === 0 && // no exotic blocks for noobline\r\n          blockName.toLowerCase() === blockNBTData.NBTName.toLowerCase()\r\n        ) {\r\n          return { colourSetId, blockId };\r\n        }\r\n      }\r\n    }\r\n    return null; // if block not found\r\n  }\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON, optionValue_supportBlock, currentMaterialsData } = this.props;\r\n    const { onlyMaxPerSplit, allMaterials} = this.state;\r\n    let materialsToDisplay = {};\r\n    if(allMaterials) {\r\n      materialsToDisplay = this.displayAllMaterials();\r\n    }\r\n    else {\r\n      materialsToDisplay = this.displayChunkMaterials();\r\n    }\r\n\r\n    const nonZeroMaterialsItems = this.getSortedNonZeroMaterials(materialsToDisplay.materials);\r\n    const supportBlockCount = materialsToDisplay.supportBlockCount;\r\n    const supportBlockIds = this.colourSetIdAndBlockIdFromNBTName(optionValue_supportBlock);\r\n    return (\r\n      <div className=\"section materialsDiv\">\r\n        <h2>{getLocaleString(\"MATERIALS/TITLE\")}</h2>\r\n        <Tooltip tooltipText={getLocaleString(\"MATERIALS/SHOW-PER-SPLIT-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MATERIALS/SHOW-PER-SPLIT\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <input type=\"checkbox\" checked={onlyMaxPerSplit} onChange={this.onOnlyMaxPerSplitChange} />\r\n        <br />\r\n        <b>\r\n        {getLocaleString(\"MATERIALS/CHUNKMATS-DISPLAYALL-CHECK\")} {\":\"}\r\n        </b>\r\n        <input type=\"checkbox\" checked={allMaterials} onChange={this.onDisplayAllChange} />\r\n        <br />\r\n        <Tooltip tooltipText={getLocaleString(\"MATERIALS/CHUNKMATS-TT\")}>\r\n          <b>\r\n            {getLocaleString(\"MATERIALS/CHUNKMATS\")}\r\n            {\":\"}\r\n          </b>\r\n        </Tooltip>{\" \"}\r\n        <br />\r\n        {getLocaleString(\"MATERIALS/CHUNKMATS-ROWS\")}{\" \"}\r\n        <input type=\"text\" class=\"chunkCoordsInput\" name=\"rowVal\" onChange={this.onRowChanged}/>\r\n        {getLocaleString(\"MATERIALS/CHUNKMATS-COLUMNS\")}{\" \"}\r\n        <input type=\"text\" class=\"chunkCoordsInput\" name=\"colVal\" onChange={this.onColumnChanged}/>\r\n        <br />\r\n        <button onClick={this.onResetList}>{getLocaleString(\"MATERIALS/CHUNKMATS-RESET\")}</button>\r\n        <button onClick={this.onAddChunkToList}>{getLocaleString(\"MATERIALS/CHUNKMATS-ADD\")}</button>\r\n        <br />\r\n        <table id=\"materialtable\">\r\n          <tbody>\r\n            <tr>\r\n              <th>{getLocaleString(\"MATERIALS/BLOCK\")}</th>\r\n              <th>{getLocaleString(\"MATERIALS/AMOUNT\")}</th>\r\n            </tr>\r\n            {supportBlockCount !== 0 && (\r\n              <tr>\r\n                <th>\r\n                  <Tooltip tooltipText={getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")}>\r\n                    <BlockImage\r\n                      getLocaleString={getLocaleString}\r\n                      coloursJSON={coloursJSON}\r\n                      colourSetId={supportBlockIds === null ? \"64\" : supportBlockIds.colourSetId}\r\n                      blockId={supportBlockIds === null ? \"2\" : supportBlockIds.blockId}\r\n                    />\r\n                  </Tooltip>\r\n                </th>\r\n                <th>{this.formatMaterialCount(supportBlockCount)}</th>\r\n              </tr>\r\n            )}\r\n            {nonZeroMaterialsItems.map(([colourSetId, materialCount]) => {\r\n              const blockId = currentMaterialsData.currentSelectedBlocks[colourSetId];\r\n              return (\r\n                <tr key={colourSetId}>\r\n                  <th>\r\n                    <Tooltip tooltipText={coloursJSON[colourSetId].blocks[blockId].displayName}>\r\n                      <BlockImage coloursJSON={coloursJSON} colourSetId={colourSetId} blockId={blockId} />\r\n                    </Tooltip>\r\n                  </th>\r\n                  <th>{this.formatMaterialCount(materialCount)}</th>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Materials;\r\n","/*\r\n  A mapping from type names to NBT type numbers.\r\n  This is NOT just an enum, these values have to stay as they are\r\n  https://minecraft.fandom.com/wiki/NBT_format#TAG_definition\r\n*/\r\nconst TagTypes = {\r\n  end: 0,\r\n  byte: 1,\r\n  short: 2,\r\n  int: 3,\r\n  long: 4,\r\n  float: 5,\r\n  double: 6,\r\n  byteArray: 7,\r\n  string: 8,\r\n  list: 9,\r\n  compound: 10,\r\n  intArray: 11,\r\n  longArray: 12,\r\n};\r\n\r\nclass NBTReader {\r\n  constructor() {\r\n    if (typeof ArrayBuffer === \"undefined\") {\r\n      throw new Error(\"Missing required type ArrayBuffer\");\r\n    }\r\n    if (typeof DataView === \"undefined\") {\r\n      throw new Error(\"Missing required type DataView\");\r\n    }\r\n    if (typeof Uint8Array === \"undefined\") {\r\n      throw new Error(\"Missing required type Uint8Array\");\r\n    }\r\n    this.buffer = null;\r\n    this.dataView = null;\r\n    this.arrayView = null;\r\n    this.offset = null;\r\n  }\r\n\r\n  loadBuffer(buffer) {\r\n    this.buffer = buffer;\r\n    this.dataView = new DataView(this.buffer);\r\n    this.arrayView = new Uint8Array(this.buffer);\r\n    this.offset = 0;\r\n  }\r\n\r\n  decodeUTF8(bytes) {\r\n    let codepoints = [];\r\n    for (let i = 0; i < bytes.length; i++) {\r\n      const byte = bytes[i];\r\n      if ((byte & 0x80) === 0) {\r\n        // single byte 0x0001 to 0x007F\r\n        codepoints.push(byte);\r\n      } else if ((byte & 0xe0) === 0xc0) {\r\n        // two bytes for 0x0000 and 0x0080 to 0x07FF\r\n        codepoints.push(((byte & 0x1f) << 6) | (bytes[i + 1] & 0x3f));\r\n        i += 1;\r\n      } else if ((byte & 0xf0) === 0xe0) {\r\n        // three bytes for 0x0800 to 0xFFFF\r\n        codepoints.push(((byte & 0x0f) << 12) | ((bytes[i + 1] & 0x3f) << 6) | (bytes[i + 2] & 0x3f));\r\n        i += 2;\r\n      }\r\n    }\r\n    return String.fromCharCode.apply(null, codepoints);\r\n  }\r\n\r\n  read(dataType, size) {\r\n    const value = this.dataView[`get${dataType}`](this.offset);\r\n    this.offset += size;\r\n    return value;\r\n  }\r\n\r\n  readByType(dataType) {\r\n    switch (dataType) {\r\n      case TagTypes.end: {\r\n        return this.readByType(TagTypes.byte);\r\n      }\r\n      case TagTypes.byte: {\r\n        return this.read(\"Int8\", 1);\r\n      }\r\n      case TagTypes.short: {\r\n        return this.read(\"Int16\", 2);\r\n      }\r\n      case TagTypes.int: {\r\n        return this.read(\"Int32\", 4);\r\n      }\r\n      case TagTypes.long: {\r\n        // NB: special: JS doesn't support native 64 bit ints; returns an array of two 32 bit ints\r\n        return [this.readByType(TagTypes.int), this.readByType(TagTypes.int)];\r\n      }\r\n      case TagTypes.float: {\r\n        return this.read(\"Float32\", 4);\r\n      }\r\n      case TagTypes.double: {\r\n        return this.read(\"Float64\", 8);\r\n      }\r\n      case TagTypes.byteArray: {\r\n        const arrayLength = this.readByType(TagTypes.int);\r\n        const returnArray = this.arrayView.slice(this.offset, this.offset + arrayLength);\r\n        this.offset += arrayLength;\r\n        return returnArray;\r\n      }\r\n      case TagTypes.string: {\r\n        const string_bytes_length = this.readByType(TagTypes.short);\r\n        const string_bytes = this.arrayView.slice(this.offset, this.offset + string_bytes_length);\r\n        this.offset += string_bytes_length;\r\n        return this.decodeUTF8(string_bytes);\r\n      }\r\n      case TagTypes.list: {\r\n        const list_objectType = this.readByType(TagTypes.byte);\r\n        const list_length = this.readByType(TagTypes.int);\r\n        let returnObject = { type: list_objectType, value: [] };\r\n        for (let i = 0; i < list_length; i++) {\r\n          returnObject.value.push(this.readByType(list_objectType));\r\n        }\r\n        return returnObject;\r\n      }\r\n      case TagTypes.compound: {\r\n        let returnObject = {};\r\n        while (true) {\r\n          let tagType = this.readByType(TagTypes.byte);\r\n          if (tagType === TagTypes.end) {\r\n            break;\r\n          } else {\r\n            let key = this.readByType(TagTypes.string);\r\n            let value = this.readByType(tagType);\r\n            returnObject[key] = { type: tagType, value: value };\r\n          }\r\n        }\r\n        return returnObject;\r\n      }\r\n      case TagTypes.intArray: {\r\n        const returnArray = [];\r\n        const array_length = this.readByType(TagTypes.int);\r\n        for (let i = 0; i < array_length; i++) {\r\n          returnArray.push(this.readByType(TagTypes.int));\r\n        }\r\n        return returnArray;\r\n      }\r\n      case TagTypes.longArray: {\r\n        const returnArray = [];\r\n        const array_length = this.readByType(TagTypes.int);\r\n        for (let i = 0; i < array_length; i++) {\r\n          returnArray.push(this.readByType(TagTypes.long));\r\n          // NB this is an array of length 2 arrays of ints as specified in case:long\r\n        }\r\n        return returnArray;\r\n      }\r\n      default: {\r\n        throw new Error(`Unknown data type ${dataType}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.readByType(TagTypes.byte);\r\n    return {\r\n      name: this.readByType(TagTypes.string),\r\n      value: this.readByType(TagTypes.compound),\r\n    }; // NB this reads the top-level compound which does not have a terminating null byte\r\n  }\r\n}\r\n\r\nexport default NBTReader;\r\n","import React, { Component } from \"react\";\r\n\r\nimport BlockImage from \"../blockImage\";\r\n\r\nimport \"./waila.css\";\r\n\r\n// What Am I Looking At\r\n\r\nclass Waila extends Component {\r\n  render() {\r\n    const { getLocaleString, coloursJSON, selectedBlock, ...props_others } = this.props;\r\n    return (\r\n      <div className={\"viewOnline_waila\"} {...props_others}>\r\n        <h3>{`x: ${selectedBlock.x.toString()} y: ${selectedBlock.y.toString()} z: ${selectedBlock.z.toString()} Row: ${selectedBlock.row.toString()} Column: ${selectedBlock.column.toString()}`}</h3>\r\n        <BlockImage\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          colourSetId={selectedBlock.colourSetId.toString()}\r\n          blockId={selectedBlock.blockId.toString()}\r\n          style={{ verticalAlign: \"middle\" }}\r\n        />{\" \"}\r\n        {selectedBlock.colourSetId === 64 && selectedBlock.blockId === 2\r\n          ? getLocaleString(\"MATERIALS/PLACEHOLDER-BLOCK-TT\")\r\n          : coloursJSON[selectedBlock.colourSetId.toString()].blocks[selectedBlock.blockId.toString()].displayName}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Waila;\r\n","import React, { Component, createRef } from \"react\";\r\n\r\nimport Tooltip from \"../../tooltip\";\r\n\r\nimport MapModes from \"../json/mapModes.json\";\r\n\r\nimport IMG_Textures from \"../../../images/textures.png\";\r\n\r\nimport NBTReader from \"../nbtReader\";\r\nimport Waila from \"../viewOnlineCommon/waila\";\r\n\r\nimport \"./viewOnline2D.css\";\r\n\r\nclass ViewOnline2D extends Component {\r\n  state = {\r\n    viewOnline_NBT_decompressed: null,\r\n    selectedBlock: null,\r\n    zoomFactor: 1,\r\n    canvasOffset_x: 0,\r\n    canvasOffset_y: 0,\r\n    focusChunk: false,\r\n  };\r\n\r\n  paletteIdToColourSetIdAndBlockId = [];\r\n  mouse = { x: 0, y: 0, down: false, movedSinceDown: null };\r\n\r\n  getNBTDecompressed() {\r\n    const { viewOnline_NBT } = this.props;\r\n    let nbtReader = new NBTReader();\r\n    nbtReader.loadBuffer(viewOnline_NBT);\r\n    const viewOnline_NBT_decompressed = nbtReader.getData();\r\n    return viewOnline_NBT_decompressed;\r\n  }\r\n\r\n  drawNBT() {\r\n    const { coloursJSON, optionValue_version, optionValue_mapSize_x, optionValue_mapSize_y, optionValue_staircasing } = this.props;\r\n    const { viewOnline_NBT_decompressed } = this.state;\r\n    const { canvasRef_viewOnline } = this;\r\n\r\n    this.paletteIdToColourSetIdAndBlockId = [];\r\n    const NBT_palette = viewOnline_NBT_decompressed.value.palette.value.value;\r\n    for (let paletteItem_index = 0; paletteItem_index < NBT_palette.length; paletteItem_index++) {\r\n      const paletteItem = NBT_palette[paletteItem_index];\r\n      let paletteItemFound = false;\r\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n        if (paletteItemFound) {\r\n          break;\r\n        }\r\n        for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n          if (paletteItemFound) {\r\n            break;\r\n          }\r\n          if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n            continue;\r\n          }\r\n          let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n          if (typeof blockNBTData === \"string\") {\r\n            // this is of the form eg \"&1.12.2\"\r\n            blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n          }\r\n          if (\r\n            paletteItem.Name.value === `minecraft:${blockNBTData.NBTName}` &&\r\n            ((!(\"Properties\" in paletteItem) && Object.keys(blockNBTData.NBTArgs).length === 0) ||\r\n              (\"Properties\" in paletteItem &&\r\n                Object.keys(paletteItem.Properties.value).length === Object.keys(blockNBTData.NBTArgs).length &&\r\n                Object.entries(blockNBTData.NBTArgs).every(([argKey, argValue]) => {\r\n                  return argKey in paletteItem.Properties.value && argValue === paletteItem.Properties.value[argKey].value;\r\n                })))\r\n          ) {\r\n            this.paletteIdToColourSetIdAndBlockId.push([parseInt(colourSetId), parseInt(blockId)]);\r\n            paletteItemFound = true;\r\n          }\r\n        }\r\n      }\r\n      if (!paletteItemFound) {\r\n        console.log(`Didn't find ${paletteItem.Name.value} in coloursJSON; using placeholder texture`);\r\n        this.paletteIdToColourSetIdAndBlockId.push([64, 2]);\r\n      }\r\n    }\r\n\r\n    const img_textures = new Image();\r\n    img_textures.onload = () => {\r\n      const canvasRef_viewOnline_ctx = canvasRef_viewOnline.current.getContext(\"2d\");\r\n      canvasRef_viewOnline_ctx.textAlign = \"right\";\r\n      canvasRef_viewOnline_ctx.textBaseline = \"alphabetic\";\r\n      canvasRef_viewOnline_ctx.font = \"16px kenpixel_mini_square\";\r\n      canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 0, 1)\";\r\n      canvasRef_viewOnline_ctx.fillRect(0, 0, 33 * 128 * optionValue_mapSize_x, 33 * (128 * optionValue_mapSize_y + 1));\r\n      let currentY = null;\r\n      let processedNoobline = false;\r\n      for (const block of viewOnline_NBT_decompressed.value.blocks.value.value) {\r\n        const block_paletteId = block.state.value;\r\n        const block_coords = block.pos.value.value;\r\n        if (block_coords[2] === 0) {\r\n          if (processedNoobline) {\r\n            continue;\r\n          } else {\r\n            processedNoobline = true;\r\n            // since we ordered blocks by Z and Y in nbt.jsworker, the first block in the column is the highest block of the\r\n            // noobline pillar (the correct height for the map preview)\r\n          }\r\n        } else {\r\n          processedNoobline = false; // ready for next column\r\n          if (block_paletteId === NBT_palette.length - 1) {\r\n            // last palette entry is support / noobline. don't draw this except on the noobline\r\n            continue;\r\n          }\r\n        }\r\n        const [int_colourSetId, int_blockId] = this.paletteIdToColourSetIdAndBlockId[block_paletteId];\r\n        let int_colourSetId_toDraw, int_blockId_toDraw;\r\n        if (!(int_colourSetId === 64 && int_blockId === 2) && coloursJSON[int_colourSetId.toString()].blocks[int_blockId.toString()].presetIndex === \"CUSTOM\") {\r\n          // if not placeholder, and is a custom block, then draw colour on canvas\r\n          int_colourSetId_toDraw = 64;\r\n          int_blockId_toDraw = 5;\r\n          canvasRef_viewOnline_ctx.fillStyle = `rgb(${coloursJSON[int_colourSetId.toString()].tonesRGB.normal.join(\", \")})`;\r\n          canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 32, 32);\r\n        } else {\r\n          int_colourSetId_toDraw = int_colourSetId;\r\n          int_blockId_toDraw = int_blockId;\r\n        }\r\n        canvasRef_viewOnline_ctx.drawImage(\r\n          img_textures,\r\n          32 * int_blockId_toDraw,\r\n          32 * int_colourSetId_toDraw,\r\n          32,\r\n          32,\r\n          33 * block_coords[0],\r\n          33 * block_coords[2],\r\n          32,\r\n          32\r\n        );\r\n       /* if (block_coords[2] !== 0) {\r\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.4)\";\r\n          const focusRow = 2;\r\n          const focusColumn = 2;\r\n          const chunkRow = Math.ceil(block_coords[2]/16);\r\n          const chunkColumn = Math.ceil((block_coords[0]+1)/16);\r\n          if(focusRow !== chunkRow || focusColumn !== chunkColumn) {\r\n            canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, 33);\r\n          }\r\n        } */\r\n/*        if (block_coords[2] !== 0) {\r\n          if (block_coords[1] > currentY) {\r\n            canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.2)\";\r\n            for (let i = 0; i < 4; i++) {\r\n              canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, -2 * (i + 1));\r\n            }\r\n          } else if (block_coords[1] < currentY) {\r\n            canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 32, 0.2)\";\r\n            for (let i = 0; i < 4; i++) {\r\n              canvasRef_viewOnline_ctx.fillRect(33 * block_coords[0], 33 * block_coords[2], 33, 2 * (i + 1));\r\n            }\r\n          }\r\n        }*/\r\n        currentY = block_coords[1];\r\n        canvasRef_viewOnline_ctx.strokeStyle = \"rgba(0, 0, 0, 1)\";\r\n        canvasRef_viewOnline_ctx.fillStyle = \"rgba(255, 255, 255, 1)\";\r\n        if (\r\n          [\r\n            MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\r\n            MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\r\n            MapModes.MAPDAT.staircaseModes.ON.uniqueId,\r\n            MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId,\r\n          ].includes(optionValue_staircasing)\r\n        ) {\r\n          canvasRef_viewOnline_ctx.strokeText(block_coords[1], 33 * block_coords[0] + 31, 33 * (block_coords[2] + 1) - 2, 31);\r\n          canvasRef_viewOnline_ctx.fillText(block_coords[1], 33 * block_coords[0] + 31, 33 * (block_coords[2] + 1) - 2, 31);\r\n        }\r\n      }\r\n      for (let whichChunk_x = 0; whichChunk_x < 8 * optionValue_mapSize_x; whichChunk_x++) {\r\n        for (let whichChunk_y = -1; whichChunk_y < 8 * optionValue_mapSize_y; whichChunk_y++) {\r\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(255, 0, 0, 1)\";\r\n          for (let x = 0; x < 16; x++) {\r\n            for (let y = 0; y < 16; y++) {\r\n              canvasRef_viewOnline_ctx.fillRect(33 * (16 * whichChunk_x + x) + 32, 33 * (16 * whichChunk_y + y + 1), 1, 33);\r\n              canvasRef_viewOnline_ctx.fillRect(33 * (16 * whichChunk_x + x), 33 * (16 * whichChunk_y + y + 1) + 32, 33, 1);\r\n            }\r\n          }\r\n          canvasRef_viewOnline_ctx.fillStyle = \"rgba(0, 0, 255, 1)\";\r\n          canvasRef_viewOnline_ctx.fillRect(33 * 16 * (whichChunk_x + 1) - 1, 33 * (16 * whichChunk_y + 1), 3, 33 * 16);\r\n          canvasRef_viewOnline_ctx.fillRect(33 * 16 * whichChunk_x, 33 * (16 * (whichChunk_y + 1) + 1) - 1, 33 * 16, 3);\r\n//          canvasRef_viewOnline_ctx.fillRect(33 * 16 * (whichChunk_x + 1) - 1, 33 * (16 * whichChunk_y + 1), 1, 33 * 16);\r\n//          canvasRef_viewOnline_ctx.fillRect(33 * 16 * whichChunk_x, 33 * (16 * (whichChunk_y + 1) + 1) - 1, 33 * 16, 1);\r\n        }\r\n      }\r\n    };\r\n    img_textures.src = IMG_Textures;\r\n  }\r\n\r\n  handleScroll_document = function (e) {\r\n    e.preventDefault();\r\n  };\r\n\r\n  handleScroll_canvas = function (e) {\r\n    e.preventDefault();\r\n    const zoomMultiplier = 1.1;\r\n    const { offsetX, offsetY } = e;\r\n    const delta = e.wheelDelta ? e.wheelDelta : e.detail ? -e.detail : 0;\r\n    if (delta) {\r\n      this.setState((state) => {\r\n        return {\r\n          zoomFactor: delta > 0 ? state.zoomFactor * zoomMultiplier : state.zoomFactor / zoomMultiplier,\r\n          canvasOffset_x:\r\n            delta > 0 ? state.canvasOffset_x - (zoomMultiplier - 1) * offsetX : state.canvasOffset_x - ((1 - zoomMultiplier) * offsetX) / zoomMultiplier,\r\n          canvasOffset_y:\r\n            delta > 0 ? state.canvasOffset_y - (zoomMultiplier - 1) * offsetY : state.canvasOffset_y - ((1 - zoomMultiplier) * offsetY) / zoomMultiplier,\r\n        };\r\n      });\r\n    }\r\n  }.bind(this);\r\n\r\n  handleMouseDown = function (e) {\r\n    e.preventDefault();\r\n    this.mouse.x = parseInt(e.clientX);\r\n    this.mouse.y = parseInt(e.clientY);\r\n    this.mouse.down = true;\r\n    this.mouse.movedSinceDown = false;\r\n    document.addEventListener(\"mousemove\", this.handleMouseMove, { passive: false });\r\n  }.bind(this);\r\n\r\n  handleMouseUp = function (e) {\r\n    e.preventDefault();\r\n    this.mouse.down = false;\r\n    if (!this.mouse.movedSinceDown) {\r\n      if (e.target === this.canvasRef_viewOnline.current) {\r\n        const { optionValue_mapSize_x, optionValue_mapSize_y } = this.props;\r\n        const { viewOnline_NBT_decompressed } = this.state;\r\n        const { offsetX, offsetY } = e;\r\n        const canvas_width = e.target.clientWidth;\r\n        const canvas_height = e.target.clientHeight;\r\n        const block_x = Math.floor((offsetX * 128 * optionValue_mapSize_x) / canvas_width);\r\n        const block_z = Math.floor((offsetY * (128 * optionValue_mapSize_y + 1)) / canvas_height);\r\n        for (const block of viewOnline_NBT_decompressed.value.blocks.value.value) {\r\n          const block_coords = block.pos.value.value;\r\n          if (block_coords[0] === block_x && block_coords[2] === block_z) {\r\n            const block_paletteId = block.state.value;\r\n            const [selectedBlock_colourSetId, selectedBlock_blockId] = this.paletteIdToColourSetIdAndBlockId[block_paletteId];\r\n            const chunkRow = Math.ceil(block_coords[2]/16);\r\n            const chunkCol = Math.ceil((block_coords[0]+1)/16);\r\n            this.setState({\r\n              selectedBlock: {\r\n                x: block_coords[0],\r\n                y: block_coords[1],\r\n                z: block_coords[2],\r\n                row: chunkRow,\r\n                column: chunkCol,\r\n                colourSetId: selectedBlock_colourSetId,\r\n                blockId: selectedBlock_blockId,\r\n              },\r\n            });\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    document.removeEventListener(\"mousemove\", this.handleMouseMove, { passive: false });\r\n  }.bind(this);\r\n\r\n  handleMouseMove = function (e) {\r\n    e.preventDefault();\r\n    if (!this.mouse.down) {\r\n      return;\r\n    }\r\n    const mouseMoved_x = parseInt(e.clientX - this.mouse.x);\r\n    const mouseMoved_y = parseInt(e.clientY - this.mouse.y);\r\n\r\n    if (Math.abs(mouseMoved_x) > 1 || Math.abs(mouseMoved_y) > 1) {\r\n      this.mouse.x = e.clientX;\r\n      this.mouse.y = e.clientY;\r\n      this.mouse.movedSinceDown = true;\r\n    }\r\n\r\n    this.setState((state) => {\r\n      return { canvasOffset_x: state.canvasOffset_x + mouseMoved_x, canvasOffset_y: state.canvasOffset_y + mouseMoved_y };\r\n    });\r\n  }.bind(this);\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef_viewOnline = createRef();\r\n  }\r\n\r\n  onFocusChunkChange = () => {\r\n    this.setState((currentState) => ({\r\n      focusChunk: !currentState.focusChunk,\r\n    }));\r\n  };\r\n\r\n  componentDidMount() {\r\n    const viewOnline_NBT_decompressed = this.getNBTDecompressed();\r\n\r\n    this.setState({ viewOnline_NBT_decompressed }, () => {\r\n      this.drawNBT();\r\n      document.addEventListener(\"DOMMouseScroll\", this.handleScroll_canvas, { passive: false });\r\n      this.canvasRef_viewOnline.current.addEventListener(\"mousewheel\", this.handleScroll_canvas, { passive: false });\r\n      document.addEventListener(\"mousewheel\", this.handleScroll_document, { passive: false });\r\n      document.addEventListener(\"mousedown\", this.handleMouseDown, { passive: false });\r\n      document.addEventListener(\"mouseup\", this.handleMouseUp, { passive: false });\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"DOMMouseScroll\", this.handleScroll_canvas, { passive: false });\r\n    this.canvasRef_viewOnline.current.removeEventListener(\"mousewheel\", this.handleScroll_canvas, { passive: false });\r\n    document.removeEventListener(\"mousewheel\", this.handleScroll_document, { passive: false });\r\n    document.removeEventListener(\"mousedown\", this.handleMouseDown, { passive: false });\r\n    document.removeEventListener(\"mouseup\", this.handleMouseUp, { passive: false });\r\n  }\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON, optionValue_mapSize_x, optionValue_mapSize_y, onGetViewOnlineNBT, onChooseViewOnline3D } = this.props;\r\n    const { viewOnline_NBT_decompressed, selectedBlock, zoomFactor, focusChunk } = this.state;\r\n    const { canvasOffset_x, canvasOffset_y } = this.state;\r\n\r\n    const component_controls = (\r\n      <div style={{ display: \"flex\", flexDirection: \"row\" }}>\r\n        <h1 style={{ cursor: \"pointer\" }} onClick={() => onGetViewOnlineNBT(null)}>\r\n          ❌\r\n        </h1>\r\n        <h1 style={{ cursor: \"pointer\" }} onClick={onChooseViewOnline3D}>\r\n          3D\r\n        </h1>\r\n      </div>\r\n    );\r\n\r\n    let component_waila = null;\r\n    if (selectedBlock !== null) {\r\n      component_waila = <Waila coloursJSON={coloursJSON} getLocaleString={getLocaleString} selectedBlock={selectedBlock} />;\r\n    }\r\n\r\n    let component_size = null;\r\n    if (viewOnline_NBT_decompressed !== null) {\r\n      const [size_x, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n      component_size = (\r\n        <h2 style={{ marginRight: \"0.1em\" }}>\r\n          {getLocaleString(\"VIEW-ONLINE/SIZE\")}\r\n          {\": \"}\r\n          {size_x.toString()}\r\n          {\"x\"}\r\n          {size_y > 256 ? (\r\n            <Tooltip\r\n              tooltipText={getLocaleString(\"VIEW-ONLINE/TOO-BIG-FOR-SINGLE\")}\r\n              textStyleOverrides={{\r\n                right: 0,\r\n                backgroundColor: \"orange\",\r\n              }}\r\n            >\r\n              <b style={{ color: \"orange\" }}>{size_y.toString()}</b>\r\n            </Tooltip>\r\n          ) : (\r\n            size_y.toString()\r\n          )}\r\n          {\"x\"}\r\n          {size_z.toString()}\r\n        </h2>\r\n      );\r\n    }\r\n\r\n    const component_topBar = (\r\n      <div className=\"topBar\">\r\n        {component_controls}\r\n        {component_waila}\r\n        {component_size}\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className={\"viewOnline2DContainer\"}>\r\n        {component_topBar}\r\n        <canvas\r\n          width={33 * 128 * optionValue_mapSize_x}\r\n          height={33 * (128 * optionValue_mapSize_y + 1)}\r\n          ref={this.canvasRef_viewOnline}\r\n          style={{\r\n            width: `${33 * 128 * optionValue_mapSize_x * zoomFactor}px`,\r\n            height: `${33 * (128 * optionValue_mapSize_y + 1) * zoomFactor}px`,\r\n            position: \"relative\",\r\n            left: canvasOffset_x,\r\n            top: canvasOffset_y,\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewOnline2D;\r\n","import { Euler, EventDispatcher, Vector3 } from \"three\";\r\n\r\nconst _euler = new Euler(0, 0, 0, \"YXZ\");\r\nconst _vector = new Vector3();\r\nconst _vector_up = new Vector3(0, 1, 0);\r\n\r\nconst _changeEvent = { type: \"change\" };\r\nconst _lockEvent = { type: \"lock\" };\r\nconst _unlockEvent = { type: \"unlock\" };\r\n\r\nconst _PI_2 = Math.PI / 2;\r\n\r\nclass PointerLockControls extends EventDispatcher {\r\n  constructor(camera, domElement) {\r\n    super();\r\n\r\n    if (domElement === undefined) {\r\n      console.warn('THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.');\r\n      domElement = document.body;\r\n    }\r\n\r\n    this.domElement = domElement;\r\n    this.isLocked = false;\r\n\r\n    // Set to constrain the pitch of the camera\r\n    // Range is 0 to Math.PI radians\r\n    this.minPolarAngle = 0; // radians\r\n    this.maxPolarAngle = Math.PI; // radians\r\n\r\n    const scope = this;\r\n\r\n    function onMouseMove(event) {\r\n      if (scope.isLocked === false) return;\r\n\r\n      const movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\r\n      const movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\r\n\r\n      _euler.setFromQuaternion(camera.quaternion);\r\n\r\n      _euler.y -= movementX * 0.002;\r\n      _euler.x -= movementY * 0.002;\r\n\r\n      _euler.x = Math.max(_PI_2 - scope.maxPolarAngle, Math.min(_PI_2 - scope.minPolarAngle, _euler.x));\r\n\r\n      camera.quaternion.setFromEuler(_euler);\r\n\r\n      scope.dispatchEvent(_changeEvent);\r\n    }\r\n\r\n    function onPointerlockChange() {\r\n      if (scope.domElement.ownerDocument.pointerLockElement === scope.domElement) {\r\n        scope.dispatchEvent(_lockEvent);\r\n\r\n        scope.isLocked = true;\r\n      } else {\r\n        scope.dispatchEvent(_unlockEvent);\r\n\r\n        scope.isLocked = false;\r\n      }\r\n    }\r\n\r\n    function onPointerlockError() {\r\n      console.error(\"THREE.PointerLockControls: Unable to use Pointer Lock API\");\r\n    }\r\n\r\n    this.connect = function () {\r\n      scope.domElement.ownerDocument.addEventListener(\"mousemove\", onMouseMove);\r\n      scope.domElement.ownerDocument.addEventListener(\"pointerlockchange\", onPointerlockChange);\r\n      scope.domElement.ownerDocument.addEventListener(\"pointerlockerror\", onPointerlockError);\r\n    };\r\n\r\n    this.disconnect = function () {\r\n      scope.domElement.ownerDocument.removeEventListener(\"mousemove\", onMouseMove);\r\n      scope.domElement.ownerDocument.removeEventListener(\"pointerlockchange\", onPointerlockChange);\r\n      scope.domElement.ownerDocument.removeEventListener(\"pointerlockerror\", onPointerlockError);\r\n    };\r\n\r\n    this.dispose = function () {\r\n      this.disconnect();\r\n    };\r\n\r\n    this.getObject = function () {\r\n      // retaining this method for backward compatibility\r\n\r\n      return camera;\r\n    };\r\n\r\n    this.getDirection = (function () {\r\n      const direction = new Vector3(0, 0, -1);\r\n\r\n      return function (v) {\r\n        return v.copy(direction).applyQuaternion(camera.quaternion);\r\n      };\r\n    })();\r\n\r\n    this.moveForward = function (distance) {\r\n      // move forward parallel to the xz-plane\r\n      // assumes camera.up is y-up\r\n\r\n      _vector.setFromMatrixColumn(camera.matrix, 0);\r\n\r\n      _vector.crossVectors(camera.up, _vector);\r\n\r\n      camera.position.addScaledVector(_vector, distance);\r\n    };\r\n\r\n    this.moveRight = function (distance) {\r\n      _vector.setFromMatrixColumn(camera.matrix, 0);\r\n\r\n      camera.position.addScaledVector(_vector, distance);\r\n    };\r\n\r\n    this.moveUp = function (distance) {\r\n      camera.position.addScaledVector(_vector_up, distance);\r\n    };\r\n\r\n    this.lock = function () {\r\n      this.domElement.requestPointerLock();\r\n    };\r\n\r\n    this.unlock = function () {\r\n      scope.domElement.ownerDocument.exitPointerLock();\r\n    };\r\n\r\n    this.connect();\r\n  }\r\n}\r\n\r\nexport { PointerLockControls };\r\n","import React, { Component, createRef } from \"react\";\r\n\r\nimport Tooltip from \"../../tooltip\";\r\n\r\nimport IMG_Textures from \"../../../images/textures.png\";\r\n\r\nimport NBTReader from \"../nbtReader\";\r\nimport Waila from \"../viewOnlineCommon/waila\";\r\n\r\nimport * as THREE from \"three\";\r\nimport { PointerLockControls } from \"./pointerLockControls\";\r\n\r\nimport \"./viewOnline3D.css\";\r\n\r\nclass BlockWorld {\r\n  faces = [\r\n    {\r\n      // left\r\n      uvRow: 0,\r\n      dir: [-1, 0, 0],\r\n      vertices: [\r\n        { pos: [0, 1, 0], uv: [0, 1] },\r\n        { pos: [0, 0, 0], uv: [0, 0] },\r\n        { pos: [0, 1, 1], uv: [1, 1] },\r\n        { pos: [0, 0, 1], uv: [1, 0] },\r\n      ],\r\n    },\r\n    {\r\n      // right\r\n      uvRow: 0,\r\n      dir: [1, 0, 0],\r\n      vertices: [\r\n        { pos: [1, 1, 1], uv: [0, 1] },\r\n        { pos: [1, 0, 1], uv: [0, 0] },\r\n        { pos: [1, 1, 0], uv: [1, 1] },\r\n        { pos: [1, 0, 0], uv: [1, 0] },\r\n      ],\r\n    },\r\n    {\r\n      // bottom\r\n      uvRow: 0,\r\n      dir: [0, -1, 0],\r\n      vertices: [\r\n        { pos: [1, 0, 1], uv: [1, 0] },\r\n        { pos: [0, 0, 1], uv: [0, 0] },\r\n        { pos: [1, 0, 0], uv: [1, 1] },\r\n        { pos: [0, 0, 0], uv: [0, 1] },\r\n      ],\r\n    },\r\n    {\r\n      // top\r\n      uvRow: 0,\r\n      dir: [0, 1, 0],\r\n      vertices: [\r\n        { pos: [0, 1, 1], uv: [1, 1] },\r\n        { pos: [1, 1, 1], uv: [0, 1] },\r\n        { pos: [0, 1, 0], uv: [1, 0] },\r\n        { pos: [1, 1, 0], uv: [0, 0] },\r\n      ],\r\n    },\r\n    {\r\n      // north\r\n      uvRow: 0,\r\n      dir: [0, 0, -1],\r\n      vertices: [\r\n        { pos: [1, 0, 0], uv: [0, 0] },\r\n        { pos: [0, 0, 0], uv: [1, 0] },\r\n        { pos: [1, 1, 0], uv: [0, 1] },\r\n        { pos: [0, 1, 0], uv: [1, 1] },\r\n      ],\r\n    },\r\n    {\r\n      // south\r\n      uvRow: 0,\r\n      dir: [0, 0, 1],\r\n      vertices: [\r\n        { pos: [0, 0, 1], uv: [0, 0] },\r\n        { pos: [1, 0, 1], uv: [1, 0] },\r\n        { pos: [0, 1, 1], uv: [0, 1] },\r\n        { pos: [1, 1, 1], uv: [1, 1] },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  chunkSize = 16;\r\n  chunks = {};\r\n  chunks_mesh = {};\r\n  renderRequested = false;\r\n  animationFrameRequestID = null;\r\n\r\n  // for click mouse events\r\n  mouse = {\r\n    x: 0,\r\n    y: 0,\r\n    moveX: 0,\r\n    moveY: 0,\r\n  };\r\n\r\n  constructor(options) {\r\n    this.canvasRef = options.canvasRef;\r\n    this.coloursJSON = options.coloursJSON;\r\n    this.tileSize = options.tileSize;\r\n    this.tileTextureWidth = options.tileTextureWidth;\r\n    this.tileTextureHeight = options.tileTextureHeight;\r\n    const { camera_x, camera_y, camera_z } = options;\r\n    this.onSelectBlockCallback = options.onSelectBlockCallback;\r\n    // each chunk is a Uint8Array; each block is stored as colourSetId, blockId\r\n    // chunks represent a chunkSize^3 volume\r\n\r\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvasRef.current });\r\n    this.renderer.setSize(this.canvasRef.current.clientWidth, this.canvasRef.current.clientHeight, false);\r\n\r\n    this.scene = new THREE.Scene();\r\n    this.scene.background = new THREE.Color(\"lightblue\");\r\n    this.scene.add(new THREE.AmbientLight(0xdddddd));\r\n\r\n    const fov = 75;\r\n    const aspect = 2;\r\n    const near = 0.1;\r\n    const far = 250;\r\n    this.camera = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n    this.camera.position.set(camera_x, camera_y, camera_z);\r\n\r\n    this.controls = new PointerLockControls(this.camera, this.canvasRef.current);\r\n\r\n    const texture = new THREE.TextureLoader().load(IMG_Textures, this.render);\r\n    texture.magFilter = THREE.NearestFilter;\r\n    texture.minFilter = THREE.NearestFilter;\r\n\r\n    this.material = new THREE.MeshLambertMaterial({\r\n      map: texture,\r\n      side: THREE.FrontSide,\r\n      alphaTest: 0,\r\n      transparent: false,\r\n    });\r\n  }\r\n\r\n  startAnimationLoop = () => {\r\n    this.renderer.render(this.scene, this.camera);\r\n    this.animationFrameRequestID = window.requestAnimationFrame(this.startAnimationLoop);\r\n  };\r\n\r\n  stopAnimationLoop = () => {\r\n    window.cancelAnimationFrame(this.animationFrameRequestID);\r\n  };\r\n\r\n  addEventListeners() {\r\n    window.addEventListener(\"resize\", this.handleWindowResize);\r\n    this.canvasRef.current.addEventListener(\"pointerdown\", this.handlePointerDown, { passive: false });\r\n    this.canvasRef.current.addEventListener(\"touchstart\", this.handleTouchStart, { passive: false });\r\n    document.addEventListener(\"keydown\", this.handleKeyDown, { passive: false });\r\n    document.addEventListener(\"keyup\", this.handleKeyUp, { passive: false });\r\n    this.controls.connect();\r\n  }\r\n\r\n  handleKeyDown = function (e) {\r\n    e.preventDefault();\r\n    switch (e.key) {\r\n      case \"w\":\r\n        this.controls.moveForward(1);\r\n        break;\r\n      case \"a\":\r\n        this.controls.moveRight(-1);\r\n        break;\r\n      case \"s\":\r\n        this.controls.moveForward(-1);\r\n        break;\r\n      case \"d\":\r\n        this.controls.moveRight(1);\r\n        break;\r\n      case \"e\":\r\n        this.controls.moveUp(-1);\r\n        break;\r\n      case \" \":\r\n        this.controls.moveUp(1);\r\n        break;\r\n      case \"c\":\r\n        this.camera.fov = 25;\r\n        this.camera.updateProjectionMatrix();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }.bind(this);\r\n\r\n  handleKeyUp = function (e) {\r\n    e.preventDefault();\r\n    switch (e.key) {\r\n      case \"c\":\r\n        this.camera.fov = 75;\r\n        this.camera.updateProjectionMatrix();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }.bind(this);\r\n\r\n  handlePointerDown = function (e) {\r\n    e.preventDefault();\r\n    this.mouse.x = e.clientX;\r\n    this.mouse.y = e.clientY;\r\n    this.mouse.moveX = 0;\r\n    this.mouse.moveY = 0;\r\n    this.canvasRef.current.addEventListener(\"pointermove\", this.recordMovement);\r\n    this.canvasRef.current.addEventListener(\"pointerup\", this.selectBlockIfNoMovement);\r\n    this.controls.lock();\r\n  }.bind(this);\r\n\r\n  recordMovement = function (e) {\r\n    this.mouse.moveX += Math.abs(this.mouse.x - e.clientX);\r\n    this.mouse.moveY += Math.abs(this.mouse.y - e.clientY);\r\n  }.bind(this);\r\n\r\n  selectBlockIfNoMovement = function (e) {\r\n    if (this.mouse.moveX < 5 && this.mouse.moveY < 5) {\r\n      this.selectBlock(e);\r\n    }\r\n    this.canvasRef.current.removeEventListener(\"pointermove\", this.recordMovement);\r\n    this.canvasRef.current.removeEventListener(\"pointerup\", this.selectBlockIfNoMovement);\r\n  }.bind(this);\r\n\r\n  handleTouchStart = function (e) {\r\n    // TODO test this on mobile\r\n    e.preventDefault(); // prevent scrolling\r\n  };\r\n\r\n  handleWindowResize = function () {\r\n    const width = this.canvasRef.current.clientWidth;\r\n    const height = this.canvasRef.current.clientHeight;\r\n\r\n    this.renderer.setSize(width, height, false);\r\n    this.camera.aspect = width / height;\r\n    this.camera.updateProjectionMatrix();\r\n  }.bind(this);\r\n\r\n  removeEventListeners() {\r\n    window.removeEventListener(\"resize\", this.handleWindowResize);\r\n    this.canvasRef.current.removeEventListener(\"pointerdown\", this.handlePointerDown, { passive: false });\r\n    this.canvasRef.current.removeEventListener(\"touchstart\", this.handleTouchStart, { passive: false });\r\n    document.removeEventListener(\"keydown\", this.handleKeyDown, { passive: false });\r\n    document.removeEventListener(\"keyup\", this.handleKeyUp, { passive: false });\r\n    this.controls.unlock();\r\n    this.controls.disconnect();\r\n  }\r\n\r\n  computeBlockOffset(x, y, z) {\r\n    const { chunkSize } = this;\r\n    const blockX = THREE.MathUtils.euclideanModulo(x, chunkSize) | 0;\r\n    const blockY = THREE.MathUtils.euclideanModulo(y, chunkSize) | 0;\r\n    const blockZ = THREE.MathUtils.euclideanModulo(z, chunkSize) | 0;\r\n    return 2 * (blockY * chunkSize * chunkSize + blockZ * chunkSize + blockX);\r\n  }\r\n\r\n  getChunkKey(x, y, z) {\r\n    const { chunkSize } = this;\r\n    const chunkX = Math.floor(x / chunkSize);\r\n    const chunkY = Math.floor(y / chunkSize);\r\n    const chunkZ = Math.floor(z / chunkSize);\r\n    return `${chunkX},${chunkY},${chunkZ}`;\r\n  }\r\n\r\n  getChunkForBlock(x, y, z) {\r\n    return this.chunks[this.getChunkKey(x, y, z)];\r\n  }\r\n\r\n  addChunkForBlock(x, y, z) {\r\n    const chunkKey = this.getChunkKey(x, y, z);\r\n    let chunk = this.chunks[chunkKey];\r\n    if (!chunk) {\r\n      const { chunkSize } = this;\r\n      chunk = new Uint8Array(2 * chunkSize * chunkSize * chunkSize);\r\n      for (let i = 0; i < chunk.length; i++) {\r\n        chunk[i] = 255;\r\n      }\r\n      this.chunks[chunkKey] = chunk;\r\n    }\r\n    return chunk;\r\n  }\r\n\r\n  getBlock(x, y, z) {\r\n    const chunk = this.getChunkForBlock(x, y, z);\r\n    if (!chunk) {\r\n      return null;\r\n    }\r\n    const blockOffset = this.computeBlockOffset(x, y, z);\r\n    return chunk.slice(blockOffset, blockOffset + 2);\r\n  }\r\n\r\n  setBlock(x, y, z, colourSetId, blockId) {\r\n    let chunk = this.getChunkForBlock(x, y, z);\r\n    if (!chunk) {\r\n      chunk = this.addChunkForBlock(x, y, z);\r\n    }\r\n    const blockOffset = this.computeBlockOffset(x, y, z);\r\n    chunk[blockOffset] = colourSetId;\r\n    chunk[blockOffset + 1] = blockId;\r\n  }\r\n\r\n  selectBlock() {\r\n    const canvas = this.canvasRef.current;\r\n    // const rect = canvas.getBoundingClientRect();\r\n    const pos = {\r\n      // x: ((e.clientX - rect.left) * canvas.width) / rect.width,\r\n      // y: ((e.clientY - rect.top) * canvas.height) / rect.height,\r\n      // x: ((rect.right + rect.left) * canvas.width) / (2 * rect.width),\r\n      // y: ((rect.bottom + rect.top) * canvas.height) / (2 * rect.height),\r\n      x: canvas.width / 2,\r\n      y: canvas.height / 2,\r\n    };\r\n    const x = (pos.x / canvas.width) * 2 - 1;\r\n    const y = (pos.y / canvas.height) * -2 + 1; // note we flip Y\r\n\r\n    const start = new THREE.Vector3();\r\n    const end = new THREE.Vector3();\r\n    start.setFromMatrixPosition(this.camera.matrixWorld);\r\n    end.set(x, y, 1).unproject(this.camera);\r\n\r\n    const intersection = this.intersectRay(start, end);\r\n    if (intersection) {\r\n      // the intersection point is on the face. That means\r\n      // the math imprecision could put us on either side of the face.\r\n      // so go half a normal into the block if removing (currentBlock = 0)\r\n      // our out of the block if adding (currentBlock  > 0)\r\n      // const pos = intersection.position.map((v, numberOfVertices) => {\r\n      //   return v + intersection.normal[numberOfVertices] * -0.5;\r\n      // });\r\n      this.onSelectBlockCallback({\r\n        x: intersection.block_coords.x,\r\n        y: intersection.block_coords.y,\r\n        z: intersection.block_coords.z,\r\n        colourSetId: intersection.block[0],\r\n        blockId: intersection.block[1],\r\n      });\r\n    }\r\n  }\r\n\r\n  intersectRay(start, end) {\r\n    // from\r\n    // http://www.cse.chalmers.se/edu/year/2010/course/TDA361/grid.pdf\r\n    let dx = end.x - start.x;\r\n    let dy = end.y - start.y;\r\n    let dz = end.z - start.z;\r\n    const lenSq = dx * dx + dy * dy + dz * dz;\r\n    const len = Math.sqrt(lenSq);\r\n\r\n    dx /= len;\r\n    dy /= len;\r\n    dz /= len;\r\n\r\n    let t = 0.0;\r\n    let ix = Math.floor(start.x);\r\n    let iy = Math.floor(start.y);\r\n    let iz = Math.floor(start.z);\r\n\r\n    const stepX = dx > 0 ? 1 : -1;\r\n    const stepY = dy > 0 ? 1 : -1;\r\n    const stepZ = dz > 0 ? 1 : -1;\r\n\r\n    const txDelta = Math.abs(1 / dx);\r\n    const tyDelta = Math.abs(1 / dy);\r\n    const tzDelta = Math.abs(1 / dz);\r\n\r\n    const xDist = stepX > 0 ? ix + 1 - start.x : start.x - ix;\r\n    const yDist = stepY > 0 ? iy + 1 - start.y : start.y - iy;\r\n    const zDist = stepZ > 0 ? iz + 1 - start.z : start.z - iz;\r\n\r\n    // location of nearest block boundary, in units of t\r\n    let txMax = txDelta < Infinity ? txDelta * xDist : Infinity;\r\n    let tyMax = tyDelta < Infinity ? tyDelta * yDist : Infinity;\r\n    let tzMax = tzDelta < Infinity ? tzDelta * zDist : Infinity;\r\n\r\n    let steppedIndex = -1;\r\n\r\n    // main loop along raycast vector\r\n    while (t <= len) {\r\n      const block = this.getBlock(ix, iy, iz);\r\n      if (block !== null && !(block[0] === 255 && block[1] === 255)) {\r\n        return {\r\n          position: [start.x + t * dx, start.y + t * dy, start.z + t * dz],\r\n          normal: [steppedIndex === 0 ? -stepX : 0, steppedIndex === 1 ? -stepY : 0, steppedIndex === 2 ? -stepZ : 0],\r\n          block: block,\r\n          block_coords: { x: ix, y: iy, z: iz },\r\n        };\r\n      }\r\n\r\n      // advance t to next nearest block boundary\r\n      if (txMax < tyMax) {\r\n        if (txMax < tzMax) {\r\n          ix += stepX;\r\n          t = txMax;\r\n          txMax += txDelta;\r\n          steppedIndex = 0;\r\n        } else {\r\n          iz += stepZ;\r\n          t = tzMax;\r\n          tzMax += tzDelta;\r\n          steppedIndex = 2;\r\n        }\r\n      } else {\r\n        if (tyMax < tzMax) {\r\n          iy += stepY;\r\n          t = tyMax;\r\n          tyMax += tyDelta;\r\n          steppedIndex = 1;\r\n        } else {\r\n          iz += stepZ;\r\n          t = tzMax;\r\n          tzMax += tzDelta;\r\n          steppedIndex = 2;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  generateGeometryDataForChunk(chunkX, chunkY, chunkZ) {\r\n    const { coloursJSON, chunkSize, tileSize, tileTextureWidth, tileTextureHeight } = this;\r\n    const verticesComponents = [];\r\n    const normalsComponents = [];\r\n    const uvs = [];\r\n    const indices = [];\r\n    const startX = chunkX * chunkSize;\r\n    const startY = chunkY * chunkSize;\r\n    const startZ = chunkZ * chunkSize;\r\n\r\n    const chunk = this.getChunkForBlock(startX, startY, startZ);\r\n    if (chunk) {\r\n      for (let y = 0; y < chunkSize; y++) {\r\n        const blockY = startY + y;\r\n        for (let z = 0; z < chunkSize; z++) {\r\n          const blockZ = startZ + z;\r\n          for (let x = 0; x < chunkSize; x++) {\r\n            const blockX = startX + x;\r\n            const blockOffset = this.computeBlockOffset(x, y, z);\r\n            const block = chunk.slice(blockOffset, blockOffset + 2);\r\n            let [colourSetId, blockId] = block;\r\n            if (!(colourSetId === 255 && blockId === 255)) {\r\n              if (!(colourSetId === 64 && blockId === 2)) {\r\n                // if not placeholder texture then check if custom texture needed\r\n                if (coloursJSON[colourSetId.toString()].blocks[blockId.toString()].presetIndex === \"CUSTOM\") {\r\n                  colourSetId = 64;\r\n                  blockId = 5;\r\n                }\r\n              }\r\n              // There is a block here but do we need faces for it?\r\n              for (const { dir, vertices, uvRow } of this.faces) {\r\n                const neighbor = this.getBlock(blockX + dir[0], blockY + dir[1], blockZ + dir[2]);\r\n                if (neighbor === null || (neighbor[0] === 255 && neighbor[1] === 255)) {\r\n                  // this block has no neighbor in this direction so we need a face\r\n                  const numberOfVertices = verticesComponents.length / 3;\r\n                  for (const { pos, uv } of vertices) {\r\n                    verticesComponents.push(pos[0] + x, pos[1] + y, pos[2] + z);\r\n                    normalsComponents.push(...dir);\r\n                    uvs.push(((blockId + uv[0]) * tileSize) / tileTextureWidth, 1 - ((uvRow + (1 + colourSetId) - uv[1]) * tileSize) / tileTextureHeight);\r\n                  }\r\n                  indices.push(numberOfVertices, numberOfVertices + 1, numberOfVertices + 2, numberOfVertices + 2, numberOfVertices + 1, numberOfVertices + 3);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      verticesComponents,\r\n      normalsComponents,\r\n      uvs,\r\n      indices,\r\n    };\r\n  }\r\n\r\n  updateChunkGeometry(x, y, z) {\r\n    const { chunkSize } = this;\r\n    const chunkX = Math.floor(x / chunkSize);\r\n    const chunkY = Math.floor(y / chunkSize);\r\n    const chunkZ = Math.floor(z / chunkSize);\r\n    const chunkKey = this.getChunkKey(x, y, z);\r\n    let mesh = this.chunks_mesh[chunkKey];\r\n    const geometry = mesh ? mesh.geometry : new THREE.BufferGeometry();\r\n\r\n    const { verticesComponents, normalsComponents, uvs, indices } = this.generateGeometryDataForChunk(chunkX, chunkY, chunkZ);\r\n    const positionNumComponents = 3;\r\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(verticesComponents), positionNumComponents));\r\n    const normalNumComponents = 3;\r\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(new Float32Array(normalsComponents), normalNumComponents));\r\n    const uvNumComponents = 2;\r\n    geometry.setAttribute(\"uv\", new THREE.BufferAttribute(new Float32Array(uvs), uvNumComponents));\r\n    geometry.setIndex(indices);\r\n    geometry.computeBoundingSphere();\r\n\r\n    if (!mesh) {\r\n      mesh = new THREE.Mesh(geometry, this.material);\r\n      mesh.name = chunkKey;\r\n      this.chunks_mesh[chunkKey] = mesh;\r\n      this.scene.add(mesh);\r\n      mesh.position.set(chunkX * chunkSize, chunkY * chunkSize, chunkZ * chunkSize);\r\n    }\r\n  }\r\n\r\n  updateBlockGeometry(x, y, z) {\r\n    const updatedChunkKeys = {};\r\n    for (const offset of [\r\n      [0, 0, 0], // self\r\n      [-1, 0, 0], // left\r\n      [1, 0, 0], // right\r\n      [0, -1, 0], // down\r\n      [0, 1, 0], // up\r\n      [0, 0, -1], // back\r\n      [0, 0, 1], // front\r\n    ]) {\r\n      const ox = x + offset[0];\r\n      const oy = y + offset[1];\r\n      const oz = z + offset[2];\r\n      const chunkKey = this.getChunkKey(ox, oy, oz);\r\n      if (!updatedChunkKeys[chunkKey]) {\r\n        updatedChunkKeys[chunkKey] = true;\r\n        this.updateChunkGeometry(ox, oy, oz);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nclass ViewOnline3D extends Component {\r\n  state = {\r\n    viewOnline_NBT_decompressed: null,\r\n    selectedBlock: null,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef_viewOnline = createRef();\r\n  }\r\n\r\n  getNBTDecompressed() {\r\n    const { viewOnline_NBT } = this.props;\r\n    let nbtReader = new NBTReader();\r\n    nbtReader.loadBuffer(viewOnline_NBT);\r\n    const viewOnline_NBT_decompressed = nbtReader.getData();\r\n    return viewOnline_NBT_decompressed;\r\n  }\r\n\r\n  drawNBT() {\r\n    const { coloursJSON, optionValue_version } = this.props;\r\n    const { viewOnline_NBT_decompressed } = this.state;\r\n    const [schematic_size_x, schematic_size_y, schematic_size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n\r\n    this.world.chunks = {};\r\n    this.world.chunks_mesh = {};\r\n\r\n    let paletteIdToColourSetIdAndBlockId = [];\r\n    const NBT_palette = viewOnline_NBT_decompressed.value.palette.value.value;\r\n    for (let paletteItem_index = 0; paletteItem_index < NBT_palette.length; paletteItem_index++) {\r\n      const paletteItem = NBT_palette[paletteItem_index];\r\n      let paletteItemFound = false;\r\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n        if (paletteItemFound) {\r\n          break;\r\n        }\r\n        for (const [blockId, block] of Object.entries(colourSet.blocks)) {\r\n          if (paletteItemFound) {\r\n            break;\r\n          }\r\n          if (!(optionValue_version.MCVersion in block.validVersions)) {\r\n            continue;\r\n          }\r\n          let blockNBTData = block.validVersions[optionValue_version.MCVersion];\r\n          if (typeof blockNBTData === \"string\") {\r\n            // this is of the form eg \"&1.12.2\"\r\n            blockNBTData = block.validVersions[blockNBTData.slice(1)];\r\n          }\r\n          if (\r\n            paletteItem.Name.value === `minecraft:${blockNBTData.NBTName}` &&\r\n            ((!(\"Properties\" in paletteItem) && Object.keys(blockNBTData.NBTArgs).length === 0) ||\r\n              (\"Properties\" in paletteItem &&\r\n                Object.keys(paletteItem.Properties.value).length === Object.keys(blockNBTData.NBTArgs).length &&\r\n                Object.entries(blockNBTData.NBTArgs).every(([argKey, argValue]) => {\r\n                  return argKey in paletteItem.Properties.value && argValue === paletteItem.Properties.value[argKey].value;\r\n                })))\r\n          ) {\r\n            paletteIdToColourSetIdAndBlockId.push([parseInt(colourSetId), parseInt(blockId)]);\r\n            paletteItemFound = true;\r\n          }\r\n        }\r\n      }\r\n      if (!paletteItemFound) {\r\n        console.log(`Didn't find ${paletteItem.Name.value} in coloursJSON; using placeholder texture`);\r\n        paletteIdToColourSetIdAndBlockId.push([64, 2]);\r\n      }\r\n    }\r\n\r\n    viewOnline_NBT_decompressed.value.blocks.value.value.forEach((block) => {\r\n      const block_coords = block.pos.value.value;\r\n      const block_paletteId = block.state.value;\r\n      this.world.setBlock(...block_coords, ...paletteIdToColourSetIdAndBlockId[block_paletteId]);\r\n    });\r\n    for (let x = 0; x < schematic_size_x; x += this.world.chunkSize) {\r\n      for (let y = 0; y < schematic_size_y; y += this.world.chunkSize) {\r\n        for (let z = 0; z < schematic_size_z; z += this.world.chunkSize) {\r\n          this.world.updateChunkGeometry(x, y, z);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  handleEscapeKeyDown = function (e) {\r\n    const { handleViewOnline3DEscape } = this.props;\r\n    e.preventDefault();\r\n    if (e.key === \"Escape\") {\r\n      handleViewOnline3DEscape();\r\n    }\r\n  }.bind(this);\r\n\r\n  componentDidMount() {\r\n    const { coloursJSON } = this.props;\r\n    const canvasRef = this.canvasRef_viewOnline;\r\n    const viewOnline_NBT_decompressed = this.getNBTDecompressed();\r\n    const [, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n\r\n    this.world = new BlockWorld({\r\n      canvasRef: canvasRef,\r\n      coloursJSON: coloursJSON,\r\n      tileSize: 32,\r\n      tileTextureWidth: 608,\r\n      tileTextureHeight: 2080,\r\n      camera_x: 0,\r\n      camera_y: size_y + 1,\r\n      camera_z: size_z,\r\n      onSelectBlockCallback: (selectedBlock) => {\r\n        this.setState({ selectedBlock });\r\n      },\r\n    });\r\n\r\n    this.world.startAnimationLoop();\r\n\r\n    this.setState({ viewOnline_NBT_decompressed }, () => {\r\n      this.drawNBT();\r\n      document.addEventListener(\"keydown\", this.handleEscapeKeyDown);\r\n      this.world.addEventListeners();\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.world.stopAnimationLoop();\r\n    this.world.removeEventListeners();\r\n    document.removeEventListener(\"keydown\", this.handleEscapeKeyDown);\r\n  }\r\n\r\n  render() {\r\n    const { getLocaleString, coloursJSON } = this.props;\r\n    const { viewOnline_NBT_decompressed, selectedBlock } = this.state;\r\n    let component_size = null;\r\n    if (viewOnline_NBT_decompressed !== null) {\r\n      const [size_x, size_y, size_z] = viewOnline_NBT_decompressed.value.size.value.value;\r\n      component_size = (\r\n        <h2\r\n          style={{\r\n            position: \"fixed\",\r\n            zIndex: 121,\r\n            left: 0,\r\n            top: 0,\r\n          }}\r\n        >\r\n          {getLocaleString(\"VIEW-ONLINE/SIZE\")}\r\n          {\": \"}\r\n          {size_x.toString()}\r\n          {\"x\"}\r\n          {size_y > 256 ? (\r\n            <Tooltip\r\n              tooltipText={getLocaleString(\"VIEW-ONLINE/TOO-BIG-FOR-SINGLE\")}\r\n              textStyleOverrides={{\r\n                whiteSpace: \"nowrap\",\r\n                backgroundColor: \"orange\",\r\n              }}\r\n            >\r\n              <b style={{ color: \"orange\" }}>{size_y.toString()}</b>\r\n            </Tooltip>\r\n          ) : (\r\n            size_y.toString()\r\n          )}\r\n          {\"x\"}\r\n          {size_z.toString()}\r\n        </h2>\r\n      );\r\n    }\r\n    const component_controls = (\r\n      <div\r\n        style={{\r\n          position: \"fixed\",\r\n          zIndex: 121,\r\n          left: 0,\r\n          bottom: 0,\r\n        }}\r\n      >\r\n        <h3 style={{ margin: 0 }}>{`${getLocaleString(\"VIEW-ONLINE/CONTROLS\")}: W A S D E SPACE C`}</h3>\r\n        <h3 style={{ margin: 0 }}>{`ESC ESC ${getLocaleString(\"VIEW-ONLINE/TO-EXIT\")}`}</h3>\r\n      </div>\r\n    );\r\n    let component_waila = null;\r\n    if (selectedBlock !== null) {\r\n      component_waila = (\r\n        <Waila\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          selectedBlock={selectedBlock}\r\n          style={{\r\n            position: \"fixed\",\r\n            zIndex: 121,\r\n            right: 0,\r\n            top: 0,\r\n          }}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <React.Fragment>\r\n        {component_size}\r\n        {component_controls}\r\n        {component_waila}\r\n        <b style={{ position: \"fixed\", zIndex: 121, top: \"50%\", left: \"50%\" }}>{\"\\\\\"}</b>\r\n        <canvas\r\n          ref={this.canvasRef_viewOnline}\r\n          style={{\r\n            position: \"fixed\",\r\n            zIndex: 120,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            top: 0,\r\n            bottom: 0,\r\n            left: 0,\r\n            right: 0,\r\n          }}\r\n        />\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewOnline3D;\r\n","import React, { Component } from \"react\";\r\n\r\nimport CookieManager from \"../../cookieManager\";\r\nimport BlockSelection from \"./blockSelection\";\r\nimport GreenButtons from \"./greenButtons\";\r\nimport MapPreview from \"./mapPreview\";\r\nimport MapSettings from \"./mapSettings\";\r\nimport Materials from \"./materials\";\r\nimport coloursJSON from \"./json/coloursJSON.json\";\r\nimport ViewOnline2D from \"./viewOnline2D/viewOnline2D\";\r\nimport ViewOnline3D from \"./viewOnline3D/viewOnline3D\";\r\n\r\nimport BackgroundColourModes from \"./json/backgroundColourModes.json\";\r\nimport CropModes from \"./json/cropModes.json\";\r\nimport DefaultPresets from \"./json/defaultPresets.json\";\r\nimport DitherMethods from \"./json/ditherMethods.json\";\r\nimport MapModes from \"./json/mapModes.json\";\r\nimport SupportedVersions from \"./json/supportedVersions.json\";\r\nimport WhereSupportBlocksModes from \"./json/whereSupportBlocksModes.json\";\r\n\r\nimport IMG_Upload from \"../../images/upload.png\";\r\n\r\nimport \"./mapartController.css\";\r\n\r\nclass MapartController extends Component {\r\n  state = {\r\n    coloursJSON: null,\r\n    selectedBlocks: {},\r\n    optionValue_version: Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1], // default to the latest version supported\r\n    optionValue_modeNBTOrMapdat: MapModes.SCHEMATIC_NBT.uniqueId,\r\n    optionValue_mapSize_x: 1,\r\n    optionValue_mapSize_y: 1,\r\n    optionValue_cropImage: CropModes.CENTER.uniqueId,\r\n    optionValue_cropImage_zoom: 10, // this gets scaled down by a factor of 10\r\n    optionValue_cropImage_percent_x: 50,\r\n    optionValue_cropImage_percent_y: 50,\r\n    optionValue_showGridOverlay: false,\r\n    optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\r\n    optionValue_whereSupportBlocks: WhereSupportBlocksModes.ALL_OPTIMIZED.uniqueId,\r\n    optionValue_supportBlock: \"cobblestone\",\r\n    optionValue_transparency: false,\r\n    optionValue_transparencyTolerance: 128,\r\n    optionValue_mapdatFilenameUseId: true,\r\n    optionValue_mapdatFilenameIdStart: 0,\r\n    optionValue_betterColour: true,\r\n    optionValue_dithering: DitherMethods.FloydSteinberg.uniqueId,\r\n    optionValue_preprocessingEnabled: false,\r\n    preProcessingValue_brightness: 100,\r\n    preProcessingValue_contrast: 100,\r\n    preProcessingValue_saturation: 100,\r\n    preProcessingValue_backgroundColourSelect: BackgroundColourModes.OFF.uniqueId,\r\n    preProcessingValue_backgroundColour: \"#151515\",\r\n    optionValue_extras_moreStaircasingOptions: false,\r\n    uploadedImage: null,\r\n    uploadedImage_baseFilename: null,\r\n    presets: [],\r\n    selectedPresetName: \"None\",\r\n    currentMaterialsData: {\r\n      pixelsData: null,\r\n      maps: [[]], // entries are dictionaries with keys \"materials\", \"supportBlockCount\"\r\n      chunks: [[]],\r\n      currentSelectedBlocks: {}, // we keep this soley for materials.js\r\n    },\r\n    mapPreviewWorker_inProgress: false,\r\n    viewOnline_NBT: null,\r\n    viewOnline_3D: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    // update default presets to latest version; done via checking for localeString\r\n    CookieManager.init();\r\n    let cookiesPresets_loaded = JSON.parse(CookieManager.touchCookie(\"mapartcraft_presets\", JSON.stringify(DefaultPresets)));\r\n    let cookiesPresets_updated = [];\r\n    for (const cookiesPreset_loaded of cookiesPresets_loaded) {\r\n      let cookiesPreset_updated = undefined;\r\n      if (\"localeKey\" in cookiesPreset_loaded) {\r\n        cookiesPreset_updated = DefaultPresets.find((defaultPreset) => defaultPreset.localeKey === cookiesPreset_loaded.localeKey);\r\n      }\r\n      if (cookiesPreset_updated === undefined) {\r\n        cookiesPreset_updated = cookiesPreset_loaded;\r\n      }\r\n      cookiesPresets_updated.push(cookiesPreset_updated);\r\n    }\r\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(cookiesPresets_updated));\r\n    this.state.presets = cookiesPresets_updated;\r\n\r\n    let cookie_customBlocks = JSON.parse(CookieManager.touchCookie(\"mapartcraft_customBlocks\", JSON.stringify([])));\r\n    this.state.coloursJSON = this.getMergedColoursJSON(cookie_customBlocks);\r\n\r\n    for (const colourSetId of Object.keys(this.state.coloursJSON)) {\r\n      this.state.selectedBlocks[colourSetId] = \"-1\";\r\n    }\r\n\r\n    const cookieMCVersion = CookieManager.touchCookie(\"mapartcraft_mcversion\", Object.values(SupportedVersions)[Object.keys(SupportedVersions).length - 1].MCVersion);\r\n    const supportedVersionFound = Object.values(SupportedVersions).find((supportedVersion) => supportedVersion.MCVersion === cookieMCVersion);\r\n    if (supportedVersionFound !== undefined) {\r\n      this.state.optionValue_version = supportedVersionFound;\r\n    }\r\n\r\n    const URLParams = new URL(window.location).searchParams;\r\n    if (URLParams.has(\"preset\")) {\r\n      const decodedPresetBlocks = this.URLToPreset(URLParams.get(\"preset\"));\r\n      if (decodedPresetBlocks !== null) {\r\n        this.state.selectedBlocks = decodedPresetBlocks;\r\n      }\r\n    }\r\n  }\r\n\r\n  getMergedColoursJSON(customBlocks) {\r\n    // this is how we currently merge custom blocks into coloursJSON at runtime / when custom blocks update. this may change if presets support for custom blocks is added\r\n    let coloursJSON_custom = JSON.parse(JSON.stringify(coloursJSON)); // hmmm\r\n    for (const [colourSetId, customBlock] of customBlocks) {\r\n      coloursJSON_custom[colourSetId].blocks[Object.keys(coloursJSON_custom[colourSetId].blocks).length.toString()] = customBlock;\r\n    }\r\n    return coloursJSON_custom;\r\n  }\r\n\r\n  eventListener_dragover = function (e) {\r\n    // this has to be here for drop event to work\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  eventListener_drop = function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const files = e.dataTransfer.files;\r\n    if (files.length) {\r\n      const file = files[0];\r\n      const imgUrl = URL.createObjectURL(file);\r\n      this.loadUploadedImageFromURL(imgUrl, \"mapart\");\r\n    }\r\n  }.bind(this);\r\n\r\n  eventListener_paste = function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const files = e.clipboardData.files;\r\n    if (files.length) {\r\n      const file = files[0];\r\n      const imgUrl = URL.createObjectURL(file);\r\n      this.loadUploadedImageFromURL(imgUrl, \"mapart\");\r\n    }\r\n  }.bind(this);\r\n\r\n  componentDidMount() {\r\n    this.loadUploadedImageFromURL(IMG_Upload, \"mapart\");\r\n\r\n    document.addEventListener(\"dragover\", this.eventListener_dragover);\r\n    document.addEventListener(\"drop\", this.eventListener_drop);\r\n\r\n    document.addEventListener(\"paste\", this.eventListener_paste);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"dragover\", this.eventListener_dragover);\r\n    document.removeEventListener(\"drop\", this.eventListener_drop);\r\n    document.removeEventListener(\"paste\", this.eventListener_paste);\r\n  }\r\n\r\n  onFileDialogEvent = (e) => {\r\n    const files = e.target.files;\r\n    if (!files.length) {\r\n      return;\r\n    } else {\r\n      const file = files[0];\r\n      const imgUrl = URL.createObjectURL(file);\r\n      this.loadUploadedImageFromURL(imgUrl, file.name.replace(/\\.[^/.]+$/, \"\"));\r\n    }\r\n  };\r\n\r\n  loadUploadedImageFromURL(imageURL, baseFilename) {\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      this.setState({\r\n        uploadedImage: img,\r\n        uploadedImage_baseFilename: baseFilename,\r\n      });\r\n    };\r\n    img.src = imageURL;\r\n  }\r\n\r\n  handleChangeColourSetBlock = (colourSetId, blockId) => {\r\n    let selectedBlocks = { ...this.state.selectedBlocks };\r\n    selectedBlocks[colourSetId] = blockId;\r\n    this.setState({\r\n      selectedBlocks,\r\n    });\r\n  };\r\n\r\n  handleChangeColourSetBlocks = (setsAndBlocks) => {\r\n    const { coloursJSON, optionValue_version } = this.state;\r\n    let selectedBlocks = {};\r\n    for (const colourSetId of Object.keys(coloursJSON)) {\r\n      selectedBlocks[colourSetId] = \"-1\";\r\n    }\r\n    for (const [int_colourSetId, presetIndex] of setsAndBlocks) {\r\n      // we store presetIndex in the cookie, not blockId\r\n      const colourSetId = int_colourSetId.toString();\r\n      if (!(colourSetId in coloursJSON)) {\r\n        continue;\r\n      }\r\n      const blockIdAndBlock = Object.entries(coloursJSON[colourSetId].blocks).find(([, block]) => block.presetIndex === presetIndex);\r\n      if (blockIdAndBlock === undefined) {\r\n        continue;\r\n      }\r\n      const blockId = blockIdAndBlock[0];\r\n      if (Object.keys(coloursJSON[colourSetId].blocks[blockId].validVersions).includes(optionValue_version.MCVersion)) {\r\n        selectedBlocks[colourSetId] = blockId;\r\n      }\r\n    }\r\n    this.setState({\r\n      selectedBlocks,\r\n    });\r\n  };\r\n\r\n  onOptionChange_modeNBTOrMapdat = (e) => {\r\n    const mode = parseInt(e.target.value);\r\n    this.setState({ optionValue_modeNBTOrMapdat: mode });\r\n    if (mode === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n      this.setState({ optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId });\r\n    } else {\r\n      this.setState({ optionValue_staircasing: MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId });\r\n    }\r\n  };\r\n\r\n  onOptionChange_version = (e) => {\r\n    const { coloursJSON } = this.state;\r\n    const mcVersion = e.target.value;\r\n    CookieManager.setCookie(\"mapartcraft_mcversion\", mcVersion);\r\n    const supportedVersionFound = Object.values(SupportedVersions).find((supportedVersion) => supportedVersion.MCVersion === mcVersion);\r\n    this.setState((currentState) => {\r\n      let selectedBlocks = { ...currentState.selectedBlocks };\r\n      for (const [colourSetId, colourSet] of Object.entries(coloursJSON)) {\r\n        if (selectedBlocks[colourSetId] !== \"-1\" && !Object.keys(colourSet.blocks[selectedBlocks[colourSetId]].validVersions).includes(mcVersion)) {\r\n          selectedBlocks[colourSetId] = \"-1\";\r\n        }\r\n      }\r\n      return { optionValue_version: supportedVersionFound, selectedBlocks };\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapSize_x = (value) => {\r\n    this.setState({\r\n      optionValue_mapSize_x: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapSize_y = (value) => {\r\n    this.setState({\r\n      optionValue_mapSize_y: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage = (e) => {\r\n    const cropValue = parseInt(e.target.value);\r\n    // CENTER is a special case of MANUAL\r\n    // reset cropImage variables any time we change\r\n    this.setState({\r\n      optionValue_cropImage: cropValue,\r\n      optionValue_cropImage_zoom: 10,\r\n      optionValue_cropImage_percent_x: 50,\r\n      optionValue_cropImage_percent_y: 50,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage_zoom = (value) => {\r\n    this.setState({\r\n      optionValue_cropImage_zoom: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage_percent_x = (value) => {\r\n    this.setState({\r\n      optionValue_cropImage_percent_x: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_cropImage_percent_y = (value) => {\r\n    this.setState({\r\n      optionValue_cropImage_percent_y: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_showGridOverlay = () => {\r\n    this.setState({\r\n      optionValue_showGridOverlay: !this.state.optionValue_showGridOverlay,\r\n    });\r\n    // \"updatePreviewScale(0)\"\r\n  };\r\n\r\n  onOptionChange_staircasing = (e) => {\r\n    const staircasingValue = parseInt(e.target.value);\r\n    this.setState({ optionValue_staircasing: staircasingValue });\r\n  };\r\n\r\n  onOptionChange_transparency = () => {\r\n    this.setState({\r\n      optionValue_transparency: !this.state.optionValue_transparency,\r\n    });\r\n  };\r\n\r\n  onOptionChange_transparencyTolerance = (value) => {\r\n    this.setState({\r\n      optionValue_transparencyTolerance: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapdatFilenameUseId = () => {\r\n    this.setState((currentState) => {\r\n      return {\r\n        optionValue_mapdatFilenameUseId: !currentState.optionValue_mapdatFilenameUseId,\r\n      };\r\n    });\r\n  };\r\n\r\n  onOptionChange_mapdatFilenameIdStart = (value) => {\r\n    this.setState({\r\n      optionValue_mapdatFilenameIdStart: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_BetterColour = () => {\r\n    this.setState({\r\n      optionValue_betterColour: !this.state.optionValue_betterColour,\r\n    });\r\n  };\r\n\r\n  onOptionChange_dithering = (e) => {\r\n    const ditheringValue = parseInt(e.target.value);\r\n    this.setState({ optionValue_dithering: ditheringValue });\r\n  };\r\n\r\n  onOptionChange_WhereSupportBlocks = (e) => {\r\n    const newValue = parseInt(e.target.value);\r\n    this.setState({ optionValue_whereSupportBlocks: newValue });\r\n  };\r\n\r\n  setOption_SupportBlock = (text) => {\r\n    this.setState({ optionValue_supportBlock: text });\r\n  };\r\n\r\n  onOptionChange_PreProcessingEnabled = () => {\r\n    this.setState({\r\n      optionValue_preprocessingEnabled: !this.state.optionValue_preprocessingEnabled,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingBrightness = (value) => {\r\n    this.setState({\r\n      preProcessingValue_brightness: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingContrast = (value) => {\r\n    this.setState({\r\n      preProcessingValue_contrast: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingSaturation = (value) => {\r\n    this.setState({\r\n      preProcessingValue_saturation: value,\r\n    });\r\n  };\r\n\r\n  onOptionChange_PreProcessingBackgroundColourSelect = (e) => {\r\n    const newValue = parseInt(e.target.value);\r\n    this.setState({ preProcessingValue_backgroundColourSelect: newValue });\r\n  };\r\n\r\n  onOptionChange_PreProcessingBackgroundColour = (e) => {\r\n    const newValue = e.target.value;\r\n    this.setState({ preProcessingValue_backgroundColour: newValue });\r\n  };\r\n\r\n  onOptionChange_extras_moreStaircasingOptions = () => {\r\n    const { optionValue_modeNBTOrMapdat, optionValue_extras_moreStaircasingOptions } = this.state;\r\n    this.setState({ optionValue_extras_moreStaircasingOptions: !optionValue_extras_moreStaircasingOptions });\r\n    if (optionValue_extras_moreStaircasingOptions) {\r\n      if (optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId) {\r\n        this.setState({ optionValue_staircasing: MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId });\r\n      } else {\r\n        this.setState({ optionValue_staircasing: MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId });\r\n      }\r\n    }\r\n  };\r\n\r\n  onGetViewOnlineNBT = (viewOnline_NBT) => {\r\n    this.setState({ viewOnline_NBT });\r\n  };\r\n\r\n  downloadBlobFile(downloadBlob, filename) {\r\n    const downloadURL = window.URL.createObjectURL(downloadBlob);\r\n    const downloadElt = document.createElement(\"a\");\r\n    downloadElt.style = \"display: none\";\r\n    downloadElt.href = downloadURL;\r\n    downloadElt.download = filename;\r\n    document.body.appendChild(downloadElt);\r\n    downloadElt.click();\r\n    window.URL.revokeObjectURL(downloadURL);\r\n    document.body.removeChild(downloadElt);\r\n  }\r\n\r\n  handleGetPDNPaletteClicked = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { coloursJSON, selectedBlocks, optionValue_modeNBTOrMapdat, optionValue_staircasing } = this.state;\r\n    let paletteText =\r\n      \"; paint.net Palette File\\n; Generated by MapartCraft\\n; Link to preset: \" +\r\n      this.selectedBlocksToURL() +\r\n      (Object.entries(selectedBlocks).some(([colourSetId, blockId]) => blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\")\r\n        ? \"\\n; Custom blocks not listed!\"\r\n        : \"\") +\r\n      \"\\n; staircasing: \" +\r\n      ([\r\n        MapModes.SCHEMATIC_NBT.staircaseModes.CLASSIC.uniqueId,\r\n        MapModes.SCHEMATIC_NBT.staircaseModes.VALLEY.uniqueId,\r\n        MapModes.MAPDAT.staircaseModes.ON.uniqueId,\r\n        MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId,\r\n      ].includes(optionValue_staircasing)\r\n        ? \"enabled\"\r\n        : \"disabled\") +\r\n      \"\\n; unobtainable colours: \" +\r\n      ([MapModes.MAPDAT.staircaseModes.ON_UNOBTAINABLE.uniqueId, MapModes.MAPDAT.staircaseModes.FULL_UNOBTAINABLE.uniqueId].includes(optionValue_staircasing)\r\n        ? \"enabled\"\r\n        : \"disabled\") +\r\n      \"\\n\";\r\n    let numberOfColoursExported = 0;\r\n    const toneKeysToExport = Object.values(Object.values(MapModes).find((mapMode) => mapMode.uniqueId === optionValue_modeNBTOrMapdat).staircaseModes).find(\r\n      (staircaseMode) => staircaseMode.uniqueId === optionValue_staircasing\r\n    ).toneKeys; // this .find stuff is annoying.\r\n    // TODO change from uniqueId to key\r\n    for (const [selectedBlock_colourSetId, selectedBlock_blockId] of Object.entries(selectedBlocks)) {\r\n      if (selectedBlock_blockId !== \"-1\") {\r\n        let colours = coloursJSON[selectedBlock_colourSetId].tonesRGB;\r\n        for (const toneKeyToExport of toneKeysToExport) {\r\n          numberOfColoursExported += 1;\r\n          paletteText += \"FF\";\r\n          for (let i = 0; i < 3; i++) {\r\n            paletteText += Number(colours[toneKeyToExport][i]).toString(16).padStart(2, \"0\").toUpperCase();\r\n          }\r\n          paletteText += \"\\n\";\r\n        }\r\n      }\r\n    }\r\n    if (numberOfColoursExported === 0) {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-NONE-SELECTED\"));\r\n      return;\r\n    } else if (numberOfColoursExported > 96) {\r\n      alert(\r\n        `${getLocaleString(\"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-MAX-COLOURS-1\")}${numberOfColoursExported.toString()}${getLocaleString(\r\n          \"BLOCK-SELECTION/PRESETS/DOWNLOAD-WARNING-MAX-COLOURS-2\"\r\n        )}`\r\n      );\r\n    }\r\n    const downloadBlob = new Blob([paletteText], { type: \"text/plain\" });\r\n    this.downloadBlobFile(downloadBlob, \"MapartcraftPalette.txt\");\r\n  };\r\n\r\n  handlePresetChange = (e) => {\r\n    const presetName = e.target.value;\r\n    const { presets } = this.state;\r\n\r\n    this.setState({ selectedPresetName: presetName });\r\n\r\n    if (presetName === \"None\") {\r\n      this.handleChangeColourSetBlocks([]);\r\n    } else {\r\n      const selectedPreset = presets.find((preset) => preset.name === presetName);\r\n      if (selectedPreset !== undefined) {\r\n        this.handleChangeColourSetBlocks(selectedPreset.blocks);\r\n      }\r\n    }\r\n  };\r\n\r\n  handleDeletePreset = () => {\r\n    const { presets, selectedPresetName } = this.state;\r\n    const presets_new = presets.filter((preset) => preset.name !== selectedPresetName);\r\n    this.setState({\r\n      presets: presets_new,\r\n      selectedPresetName: \"None\",\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(presets_new));\r\n  };\r\n\r\n  handleSavePreset = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { coloursJSON, presets, selectedBlocks } = this.state;\r\n\r\n    let presetToSave_name = prompt(getLocaleString(\"BLOCK-SELECTION/PRESETS/SAVE-PROMPT-ENTER-NAME\"), \"\");\r\n    if (presetToSave_name === null) {\r\n      return;\r\n    }\r\n\r\n    const otherPresets = presets.filter((preset) => preset.name !== presetToSave_name);\r\n    let newPreset = { name: presetToSave_name, blocks: [] };\r\n    Object.keys(selectedBlocks).forEach((key) => {\r\n      if (selectedBlocks[key] !== \"-1\" && coloursJSON[key].blocks[selectedBlocks[key]].presetIndex !== \"CUSTOM\") {\r\n        newPreset.blocks.push([parseInt(key), parseInt(coloursJSON[key].blocks[selectedBlocks[key]].presetIndex)]);\r\n      }\r\n    });\r\n    const presets_new = [...otherPresets, newPreset];\r\n    this.setState({\r\n      presets: presets_new,\r\n      selectedPresetName: presetToSave_name,\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_presets\", JSON.stringify(presets_new));\r\n  };\r\n\r\n  selectedBlocksToURL = () => {\r\n    // colourSetId encoded in base 36 as [0-9a-z]\r\n    // blockId encoded in modified base 26 as [Q-ZA-P]\r\n    const { coloursJSON, selectedBlocks } = this.state;\r\n    let presetQueryString = \"\";\r\n    for (const [colourSetId, blockId] of Object.entries(selectedBlocks)) {\r\n      if (blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex !== \"CUSTOM\") {\r\n        presetQueryString += parseInt(colourSetId).toString(36);\r\n        presetQueryString += coloursJSON[colourSetId].blocks[blockId].presetIndex\r\n          .toString(26)\r\n          .toUpperCase()\r\n          .replace(/[0-9]/g, (match) => {\r\n            return {\r\n              0: \"Q\",\r\n              1: \"R\",\r\n              2: \"S\",\r\n              3: \"T\",\r\n              4: \"U\",\r\n              5: \"V\",\r\n              6: \"W\",\r\n              7: \"X\",\r\n              8: \"Y\",\r\n              9: \"Z\",\r\n            }[match];\r\n          });\r\n      }\r\n    }\r\n    return \"https://rebane2001.com/mapartcraft/?preset=\" + presetQueryString;\r\n  };\r\n\r\n  handleSharePreset = () => {\r\n    const { getLocaleString } = this.props;\r\n    const { coloursJSON, selectedBlocks } = this.state;\r\n    if (Object.keys(selectedBlocks).every((colourSetId) => selectedBlocks[colourSetId] === \"-1\")) {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-WARNING-NONE-SELECTED\"));\r\n    } else {\r\n      if (\r\n        Object.entries(selectedBlocks).some(([colourSetId, blockId]) => blockId !== \"-1\" && coloursJSON[colourSetId].blocks[blockId].presetIndex === \"CUSTOM\")\r\n      ) {\r\n        alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/NO-EXPORT\"));\r\n      }\r\n      prompt(getLocaleString(\"BLOCK-SELECTION/PRESETS/SHARE-LINK\"), this.selectedBlocksToURL());\r\n    }\r\n  };\r\n\r\n  URLToPreset = (encodedPreset) => {\r\n    const { onCorruptedPreset } = this.props;\r\n    const { coloursJSON, optionValue_version } = this.state;\r\n    switch (encodedPreset) {\r\n      case \"dQw4w9WgXcQ\":\r\n        window.location.replace(\"https://www.youtube.com/watch?v=cZ5wOPinZd4\");\r\n        return null;\r\n      case \"mares\":\r\n        document.body.style.backgroundSize=\"100%\";\r\n        fetch(\"https://derpibooru.org/api/v1/json/search/images?q=scenery,score.gte:1000,safe&sf=random&per_page=1\").then(req=>req.json()).then(derp=>document.body.style.backgroundImage=`url(${derp.images[0].representations.full})`);\r\n        return null;\r\n    }\r\n    if (!/^[0-9a-zQ-ZA-P]*$/g.test(encodedPreset)) {\r\n      onCorruptedPreset();\r\n      return null;\r\n    }\r\n    let selectedBlocks = { ...this.state.selectedBlocks };\r\n    let presetRegex = /([0-9a-z]+)(?=([Q-ZA-P]+))/g;\r\n    let match;\r\n    while ((match = presetRegex.exec(encodedPreset)) !== null) {\r\n      const encodedColourSetId = match[1];\r\n      const encodedBlockId = match[2];\r\n      const decodedColourSetId = parseInt(encodedColourSetId, 36).toString();\r\n      const decodedPresetIndex = parseInt(\r\n        encodedBlockId\r\n          .replace(/[Q-Z]/g, (match) => {\r\n            return {\r\n              Q: \"0\",\r\n              R: \"1\",\r\n              S: \"2\",\r\n              T: \"3\",\r\n              U: \"4\",\r\n              V: \"5\",\r\n              W: \"6\",\r\n              X: \"7\",\r\n              Y: \"8\",\r\n              Z: \"9\",\r\n            }[match];\r\n          })\r\n          .toLowerCase(),\r\n        26\r\n      );\r\n      if (!(decodedColourSetId in coloursJSON)) {\r\n        continue;\r\n      }\r\n      const decodedBlock = Object.entries(coloursJSON[decodedColourSetId].blocks).find((elt) => elt[1].presetIndex === decodedPresetIndex);\r\n      if (decodedBlock === undefined) {\r\n        continue;\r\n      }\r\n      const decodedBlockId = decodedBlock[0].toString();\r\n      if (Object.keys(coloursJSON[decodedColourSetId].blocks[decodedBlockId].validVersions).includes(optionValue_version.MCVersion)) {\r\n        selectedBlocks[decodedColourSetId] = decodedBlockId;\r\n      }\r\n    }\r\n    return selectedBlocks;\r\n  };\r\n\r\n  onMapPreviewWorker_begin = () => {\r\n    this.setState({ mapPreviewWorker_inProgress: true });\r\n  };\r\n\r\n  handleSetMapMaterials = (currentMaterialsData) => {\r\n    this.setState({ currentMaterialsData: currentMaterialsData, mapPreviewWorker_inProgress: false });\r\n  };\r\n\r\n  onChooseViewOnline3D = () => {\r\n    this.setState({ viewOnline_3D: true });\r\n  };\r\n\r\n  handleViewOnline3DEscape = () => {\r\n    this.setState({\r\n      viewOnline_NBT: null,\r\n      viewOnline_3D: false,\r\n    });\r\n  };\r\n\r\n  handleAddCustomBlock = (block_colourSetId, block_name, block_nbtTags, block_versions, block_needsSupport, block_flammable) => {\r\n    const { getLocaleString } = this.props;\r\n    // const {coloursJSON} = this.state;\r\n    const block_name_trimmed = block_name.trim();\r\n    if (block_name_trimmed === \"\") {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ERROR-NO-NAME\"));\r\n      return;\r\n    }\r\n    if (Object.values(block_versions).every((t) => !t)) {\r\n      alert(getLocaleString(\"BLOCK-SELECTION/ADD-CUSTOM/ERROR-NONE-SELECTED\"));\r\n      return;\r\n    }\r\n    let blockToAdd = {\r\n      displayName: block_name_trimmed,\r\n      validVersions: {},\r\n      supportBlockMandatory: block_needsSupport,\r\n      flammable: block_flammable,\r\n      presetIndex: \"CUSTOM\",\r\n    };\r\n    let addedFirstVersion = false;\r\n    for (const [block_version, block_version_isSelected] of Object.entries(block_versions)) {\r\n      if (!block_version_isSelected) {\r\n        continue;\r\n      }\r\n      if (addedFirstVersion) {\r\n        blockToAdd.validVersions[SupportedVersions[block_version].MCVersion] = `&${Object.keys(blockToAdd.validVersions)[0]}`;\r\n      } else {\r\n        blockToAdd.validVersions[SupportedVersions[block_version].MCVersion] = {\r\n          NBTName: block_name_trimmed,\r\n          NBTArgs: {},\r\n        };\r\n        for (const [nbtTag_key, nbtTag_value] of block_nbtTags) {\r\n          const nbtTag_key_trimmed = nbtTag_key.trim();\r\n          const nbtTag_value_trimmed = nbtTag_value.trim();\r\n          if (!(nbtTag_key_trimmed === \"\" && nbtTag_value_trimmed === \"\")) {\r\n            blockToAdd.validVersions[SupportedVersions[block_version].MCVersion].NBTArgs[nbtTag_key_trimmed] = nbtTag_value_trimmed;\r\n          }\r\n        }\r\n        addedFirstVersion = true;\r\n      }\r\n    }\r\n\r\n    const customBlocks = JSON.parse(CookieManager.getCookie(\"mapartcraft_customBlocks\"));\r\n    let customBlocks_new = customBlocks.filter(\r\n      (customBlock) =>\r\n        customBlock[0] !== block_colourSetId ||\r\n        customBlock[1].displayName !== block_name_trimmed ||\r\n        !Object.values(SupportedVersions).some(\r\n          (supportedVersion_value) =>\r\n            supportedVersion_value.MCVersion in customBlock[1].validVersions && supportedVersion_value.MCVersion in blockToAdd.validVersions\r\n        )\r\n    ); // filter removes customBlocks that have the same colourSet, name, and some versions in common as the one we are adding. For example this allows us to add different 1.12.2 and 1.13+ versions of a block\r\n    customBlocks_new.push([block_colourSetId, blockToAdd]);\r\n\r\n    this.setState((currentState) => {\r\n      return { coloursJSON: this.getMergedColoursJSON(customBlocks_new), selectedBlocks: { ...currentState.selectedBlocks, [block_colourSetId]: \"-1\" } };\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_customBlocks\", JSON.stringify(customBlocks_new));\r\n  };\r\n\r\n  handleDeleteCustomBlock = (block_colourSetId, block_name, block_versions) => {\r\n    const block_name_trimmed = block_name.trim();\r\n    if (block_name_trimmed === \"\" || Object.values(block_versions).every((t) => !t)) {\r\n      return;\r\n    }\r\n\r\n    let validVersions = [];\r\n    for (const [block_version, block_version_isSelected] of Object.entries(block_versions)) {\r\n      if (block_version_isSelected) {\r\n        validVersions.push(SupportedVersions[block_version].MCVersion);\r\n      }\r\n    }\r\n\r\n    const customBlocks = JSON.parse(CookieManager.getCookie(\"mapartcraft_customBlocks\"));\r\n    let customBlocks_new = customBlocks.filter(\r\n      (customBlock) =>\r\n        customBlock[0] !== block_colourSetId ||\r\n        customBlock[1].displayName !== block_name_trimmed ||\r\n        !Object.values(SupportedVersions).some(\r\n          (supportedVersion_value) =>\r\n            supportedVersion_value.MCVersion in customBlock[1].validVersions && validVersions.includes(supportedVersion_value.MCVersion)\r\n        )\r\n    );\r\n\r\n    this.setState((currentState) => {\r\n      return {\r\n        coloursJSON: this.getMergedColoursJSON(customBlocks_new),\r\n        selectedBlocks: { ...currentState.selectedBlocks, [block_colourSetId]: \"-1\" },\r\n        currentMaterialsData: {\r\n          // reset currentMaterialsData as materials.js uses a cached version of materials which could contain blocks which no longer exist\r\n          pixelsData: null,\r\n          maps: [[]],\r\n          chunks:[[]],\r\n          currentSelectedBlocks: {},\r\n        },\r\n      };\r\n    });\r\n    CookieManager.setCookie(\"mapartcraft_customBlocks\", JSON.stringify(customBlocks_new));\r\n  };\r\n\r\n  render() {\r\n    const { getLocaleString } = this.props;\r\n    const {\r\n      coloursJSON,\r\n      selectedBlocks,\r\n      optionValue_version,\r\n      optionValue_modeNBTOrMapdat,\r\n      optionValue_mapSize_x,\r\n      optionValue_mapSize_y,\r\n      optionValue_cropImage,\r\n      optionValue_cropImage_zoom,\r\n      optionValue_cropImage_percent_x,\r\n      optionValue_cropImage_percent_y,\r\n      optionValue_showGridOverlay,\r\n      optionValue_staircasing,\r\n      optionValue_whereSupportBlocks,\r\n      optionValue_supportBlock,\r\n      optionValue_transparency,\r\n      optionValue_transparencyTolerance,\r\n      optionValue_mapdatFilenameUseId,\r\n      optionValue_mapdatFilenameIdStart,\r\n      optionValue_betterColour,\r\n      optionValue_dithering,\r\n      optionValue_preprocessingEnabled,\r\n      preProcessingValue_brightness,\r\n      preProcessingValue_contrast,\r\n      preProcessingValue_saturation,\r\n      preProcessingValue_backgroundColourSelect,\r\n      preProcessingValue_backgroundColour,\r\n      optionValue_extras_moreStaircasingOptions,\r\n      uploadedImage,\r\n      uploadedImage_baseFilename,\r\n      presets,\r\n      selectedPresetName,\r\n      currentMaterialsData,\r\n      mapPreviewWorker_inProgress,\r\n      viewOnline_NBT,\r\n      viewOnline_3D,\r\n    } = this.state;\r\n    return (\r\n      <div className=\"mapartController\">\r\n        <BlockSelection\r\n          getLocaleString={getLocaleString}\r\n          coloursJSON={coloursJSON}\r\n          onChangeColourSetBlock={this.handleChangeColourSetBlock}\r\n          optionValue_version={optionValue_version}\r\n          optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n          optionValue_staircasing={optionValue_staircasing}\r\n          selectedBlocks={selectedBlocks}\r\n          presets={presets}\r\n          selectedPresetName={selectedPresetName}\r\n          onPresetChange={this.handlePresetChange}\r\n          onDeletePreset={this.handleDeletePreset}\r\n          onSavePreset={this.handleSavePreset}\r\n          onSharePreset={this.handleSharePreset}\r\n          onGetPDNPaletteClicked={this.handleGetPDNPaletteClicked}\r\n          handleAddCustomBlock={this.handleAddCustomBlock}\r\n          handleDeleteCustomBlock={this.handleDeleteCustomBlock}\r\n        />\r\n        <div className=\"sectionsPreviewSettingsMaterials\">\r\n          <MapPreview\r\n            getLocaleString={getLocaleString}\r\n            coloursJSON={coloursJSON}\r\n            selectedBlocks={selectedBlocks}\r\n            optionValue_version={optionValue_version}\r\n            optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n            optionValue_mapSize_x={optionValue_mapSize_x}\r\n            optionValue_mapSize_y={optionValue_mapSize_y}\r\n            optionValue_cropImage={optionValue_cropImage}\r\n            optionValue_cropImage_zoom={optionValue_cropImage_zoom}\r\n            optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\r\n            optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\r\n            optionValue_showGridOverlay={optionValue_showGridOverlay}\r\n            optionValue_staircasing={optionValue_staircasing}\r\n            optionValue_whereSupportBlocks={optionValue_whereSupportBlocks}\r\n            optionValue_transparency={optionValue_transparency}\r\n            optionValue_transparencyTolerance={optionValue_transparencyTolerance}\r\n            optionValue_betterColour={optionValue_betterColour}\r\n            optionValue_dithering={optionValue_dithering}\r\n            optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\r\n            preProcessingValue_brightness={preProcessingValue_brightness}\r\n            preProcessingValue_contrast={preProcessingValue_contrast}\r\n            preProcessingValue_saturation={preProcessingValue_saturation}\r\n            preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\r\n            preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\r\n            uploadedImage={uploadedImage}\r\n            onFileDialogEvent={this.onFileDialogEvent}\r\n            onGetMapMaterials={this.handleSetMapMaterials}\r\n            onMapPreviewWorker_begin={this.onMapPreviewWorker_begin}\r\n          />\r\n          <div style={{ display: \"block\" }}>\r\n            <MapSettings\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              onOptionChange_version={this.onOptionChange_version}\r\n              optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n              onOptionChange_modeNBTOrMapdat={this.onOptionChange_modeNBTOrMapdat}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              onOptionChange_mapSize_x={this.onOptionChange_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              onOptionChange_mapSize_y={this.onOptionChange_mapSize_y}\r\n              optionValue_cropImage={optionValue_cropImage}\r\n              onOptionChange_cropImage={this.onOptionChange_cropImage}\r\n              optionValue_cropImage_zoom={optionValue_cropImage_zoom}\r\n              onOptionChange_cropImage_zoom={this.onOptionChange_cropImage_zoom}\r\n              optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\r\n              onOptionChange_cropImage_percent_x={this.onOptionChange_cropImage_percent_x}\r\n              optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\r\n              onOptionChange_cropImage_percent_y={this.onOptionChange_cropImage_percent_y}\r\n              optionValue_showGridOverlay={optionValue_showGridOverlay}\r\n              onOptionChange_showGridOverlay={this.onOptionChange_showGridOverlay}\r\n              optionValue_staircasing={optionValue_staircasing}\r\n              onOptionChange_staircasing={this.onOptionChange_staircasing}\r\n              optionValue_whereSupportBlocks={optionValue_whereSupportBlocks}\r\n              onOptionChange_WhereSupportBlocks={this.onOptionChange_WhereSupportBlocks}\r\n              optionValue_supportBlock={optionValue_supportBlock}\r\n              setOption_SupportBlock={this.setOption_SupportBlock}\r\n              optionValue_transparency={optionValue_transparency}\r\n              onOptionChange_transparency={this.onOptionChange_transparency}\r\n              optionValue_transparencyTolerance={optionValue_transparencyTolerance}\r\n              onOptionChange_transparencyTolerance={this.onOptionChange_transparencyTolerance}\r\n              optionValue_mapdatFilenameUseId={optionValue_mapdatFilenameUseId}\r\n              onOptionChange_mapdatFilenameUseId={this.onOptionChange_mapdatFilenameUseId}\r\n              optionValue_mapdatFilenameIdStart={optionValue_mapdatFilenameIdStart}\r\n              onOptionChange_mapdatFilenameIdStart={this.onOptionChange_mapdatFilenameIdStart}\r\n              optionValue_betterColour={optionValue_betterColour}\r\n              onOptionChange_BetterColour={this.onOptionChange_BetterColour}\r\n              optionValue_dithering={optionValue_dithering}\r\n              onOptionChange_dithering={this.onOptionChange_dithering}\r\n              optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\r\n              onOptionChange_PreProcessingEnabled={this.onOptionChange_PreProcessingEnabled}\r\n              preProcessingValue_brightness={preProcessingValue_brightness}\r\n              onOptionChange_PreProcessingBrightness={this.onOptionChange_PreProcessingBrightness}\r\n              preProcessingValue_contrast={preProcessingValue_contrast}\r\n              onOptionChange_PreProcessingContrast={this.onOptionChange_PreProcessingContrast}\r\n              preProcessingValue_saturation={preProcessingValue_saturation}\r\n              onOptionChange_PreProcessingSaturation={this.onOptionChange_PreProcessingSaturation}\r\n              preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\r\n              onOptionChange_PreProcessingBackgroundColourSelect={this.onOptionChange_PreProcessingBackgroundColourSelect}\r\n              preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\r\n              onOptionChange_PreProcessingBackgroundColour={this.onOptionChange_PreProcessingBackgroundColour}\r\n              optionValue_extras_moreStaircasingOptions={optionValue_extras_moreStaircasingOptions}\r\n              onOptionChange_extras_moreStaircasingOptions={this.onOptionChange_extras_moreStaircasingOptions}\r\n            />\r\n            <GreenButtons\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              selectedBlocks={selectedBlocks}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_modeNBTOrMapdat={optionValue_modeNBTOrMapdat}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              optionValue_cropImage={optionValue_cropImage}\r\n              optionValue_cropImage_zoom={optionValue_cropImage_zoom}\r\n              optionValue_cropImage_percent_x={optionValue_cropImage_percent_x}\r\n              optionValue_cropImage_percent_y={optionValue_cropImage_percent_y}\r\n              optionValue_staircasing={optionValue_staircasing}\r\n              optionValue_whereSupportBlocks={optionValue_whereSupportBlocks}\r\n              optionValue_supportBlock={optionValue_supportBlock}\r\n              optionValue_transparency={optionValue_transparency}\r\n              optionValue_transparencyTolerance={optionValue_transparencyTolerance}\r\n              optionValue_mapdatFilenameUseId={optionValue_mapdatFilenameUseId}\r\n              optionValue_mapdatFilenameIdStart={optionValue_mapdatFilenameIdStart}\r\n              optionValue_betterColour={optionValue_betterColour}\r\n              optionValue_dithering={optionValue_dithering}\r\n              optionValue_preprocessingEnabled={optionValue_preprocessingEnabled}\r\n              preProcessingValue_brightness={preProcessingValue_brightness}\r\n              preProcessingValue_contrast={preProcessingValue_contrast}\r\n              preProcessingValue_saturation={preProcessingValue_saturation}\r\n              preProcessingValue_backgroundColourSelect={preProcessingValue_backgroundColourSelect}\r\n              preProcessingValue_backgroundColour={preProcessingValue_backgroundColour}\r\n              uploadedImage={uploadedImage}\r\n              uploadedImage_baseFilename={uploadedImage_baseFilename}\r\n              currentMaterialsData={currentMaterialsData}\r\n              mapPreviewWorker_inProgress={mapPreviewWorker_inProgress}\r\n              downloadBlobFile={this.downloadBlobFile}\r\n              onGetViewOnlineNBT={this.onGetViewOnlineNBT}\r\n            />\r\n          </div>\r\n          {optionValue_modeNBTOrMapdat === MapModes.SCHEMATIC_NBT.uniqueId ? (\r\n            <Materials\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_supportBlock={optionValue_supportBlock}\r\n              currentMaterialsData={currentMaterialsData}\r\n            />\r\n          ) : null}\r\n        </div>\r\n        {viewOnline_NBT !== null &&\r\n          (viewOnline_3D ? (\r\n            <ViewOnline3D\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              viewOnline_NBT={viewOnline_NBT}\r\n              handleViewOnline3DEscape={this.handleViewOnline3DEscape}\r\n            />\r\n          ) : (\r\n            <ViewOnline2D\r\n              getLocaleString={getLocaleString}\r\n              coloursJSON={coloursJSON}\r\n              optionValue_version={optionValue_version}\r\n              optionValue_mapSize_x={optionValue_mapSize_x}\r\n              optionValue_mapSize_y={optionValue_mapSize_y}\r\n              optionValue_staircasing={optionValue_staircasing}\r\n              viewOnline_NBT={viewOnline_NBT}\r\n              onGetViewOnlineNBT={this.onGetViewOnlineNBT}\r\n              onChooseViewOnline3D={this.onChooseViewOnline3D}\r\n            />\r\n          ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MapartController;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAANMSURBVHhe7d3PahNRGIbxowv/IHZjcS2uxL3gDXgV3oDgvXgXXoVegOC+iAv3lm6sSGIjKBPmg+Mwk2SSMzPfd573gaEmTJuU99dpRUlvvXn39m9S2G63bxU0AYAnAPAEAJ4AwBMAeAIADwtg9WOVvny4SJvVTXsPMySA7fgfL9LPy+vtWzICHAAb/896s729vl6jEaAAdMe3yAgwAIbGt6gIEAD2jW8REVQP4NDxLRqCqgGMHd8iIagWwLHjWxQEVQI4dXyLgKA6AKXGt2pHUBWA0uNbNSOoBsBU41u1IqgCwNTjWzUiCA9grvGt2hCEBjD3+FZNCMICWGp8qxYEIQEsPb5VA4JwALyMb0VHEAqAt/GtyAjCAPA6vhUVQQgA3se3IiJwDyDK+FY0BK4BRBvfioTALYCo41tRELgEEH18KwICdwBqGd/yjsAVgNrGtzwjcAOg1vEtrwhcAKh9fMsjgsUBUMa3vCFYFABtfMsTgsUAUMe3vCBYBAB9fMsDgtkBaPz/WxrBrAA0fn9LIpgNgMbf3VIIZgGg8Q9rCQSTA9D445obwaQANP5xzYlg0t8XcPn1e9qsy30SV9+u0s2v3+0tf915cDedPz1vb53evbP76dGTch+vr1C/MKJ5Ycfmtf289vDxWXr26nl7K0az/jVQ+UsA4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4AkAPAGAJwDwBACeAMAL9TqBqny6AsATAHgCAE8A4AkAPAGAJwDwBACeAMATAHgCAE8A4BX9x6DP7z+1fxruxeuX27f5uX33DbXr/ZuG7u927ONbpz7noY4595R0BYA3GYBGpx3HlL9/fsxV97EOeewxzzM/Nz/66juvOUqkKwC8yQA038PsmLruY5X8ChlT93nsKz9/1/v1ndccJdIVAN4sPwPkxxR1P37Jr5AxdZ/Hvg49N/+4+VEiXQHguQWQf6/Lj1oa8znl5+ZHiXQFgKf/Fg5PVwB4AgBPAOAJADwBgCcA8AQAngDAEwB4AgBPAOAJADwBgCcA8AQAXUr/ADWYPUK6/RieAAAAAElFTkSuQmCC\"","import React, { Component } from \"react\";\r\n\r\nimport Header from \"./header\";\r\nimport Languages from \"./languages\";\r\nimport MapartController from \"./mapart/mapartController\";\r\n\r\nimport Locale from \"../locale/locale\";\r\n\r\nimport \"./root.css\";\r\n\r\nclass Root extends Component {\r\n  state = {\r\n    displayingCorruptedPresetWarning: false,\r\n    displayingEdgeWarning: false,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    //show warning when using Edge\r\n    if (!(/*@cc_on!@*/ (false || !!document[\"documentMode\"])) && !!window[\"StyleMedia\"]) {\r\n      this.state.displayingEdgeWarning = true;\r\n    }\r\n  }\r\n\r\n  getLocaleString = (stringName, languageCodeOverride) => {\r\n    // languageCodeOverride only used inside this method for falling back to en\r\n    const countryCode = languageCodeOverride !== undefined ? languageCodeOverride : this.props.match.params.countryCode;\r\n    if (countryCode in Locale) {\r\n      let stringSegments = stringName.split(\"/\");\r\n      const stringLast = stringSegments.pop();\r\n      let folder = Locale[countryCode].strings;\r\n      for (const stringSegment of stringSegments) {\r\n        folder = folder[stringSegment];\r\n      }\r\n      if (folder[stringLast] === null) {\r\n        // this could get stuck in an endless loop if the string does not exist in en;\r\n        // en must always exist\r\n        return this.getLocaleString(stringName, \"en\");\r\n      } else {\r\n        return folder[stringLast];\r\n      }\r\n    } else {\r\n      return this.getLocaleString(stringName, \"en\");\r\n    }\r\n  };\r\n\r\n  onEdgeWarningButtonClick = () => {\r\n    this.setState({ displayingEdgeWarning: false });\r\n  };\r\n\r\n  onCorruptedPresetWarningButtonClick = () => {\r\n    this.setState({ displayingCorruptedPresetWarning: false });\r\n  };\r\n\r\n  showCorruptedPresetWarning = () => {\r\n    this.setState({ displayingCorruptedPresetWarning: true });\r\n  };\r\n\r\n  render() {\r\n    const { displayingCorruptedPresetWarning, displayingEdgeWarning } = this.state;\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"titleAndLanguages\">\r\n          <span><h1>MapartCraft</h1>{this.props.match.params.countryCode && this.props.match.params.countryCode !== \"en\" && <small>{this.getLocaleString(\"TRANSLATION/CREDITS\")}</small>}</span>\r\n          <Languages />\r\n        </div>\r\n        <Header getLocaleString={this.getLocaleString} countryCode={this.props.match.params.countryCode} />\r\n        <MapartController getLocaleString={this.getLocaleString} onCorruptedPreset={this.showCorruptedPresetWarning} />\r\n        <div className=\"fixedMessages\">\r\n          {displayingEdgeWarning ? (\r\n            <div className=\"fixedMessage\">\r\n              <p>{this.getLocaleString(\"EDGE-WARNING\").replace(\"\\\\n\", \"\\n\")}</p>\r\n              <button type=\"button\" onClick={this.onEdgeWarningButtonClick}>\r\n                ✔️\r\n              </button>\r\n            </div>\r\n          ) : null}\r\n          {displayingCorruptedPresetWarning ? (\r\n            <div className=\"fixedMessage\">\r\n              <p>{this.getLocaleString(\"BLOCK-SELECTION/PRESETS/IMPORT-ERROR-CORRUPTED\")}</p>\r\n              <button type=\"button\" onClick={this.onCorruptedPresetWarningButtonClick}>\r\n                ❗\r\n              </button>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Root;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\n\r\nimport FAQ from \"./components/faq\";\r\nimport Root from \"./components/root\";\r\n\r\nimport \"./index.css\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Router basename=\"/mapartcraft\">\r\n      <Switch>\r\n        <Route path=\"/:countryCode?/faq\" component={FAQ} />\r\n        <Route path=\"/:countryCode?\" component={Root} />\r\n      </Switch>\r\n    </Router>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}